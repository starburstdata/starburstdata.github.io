

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', 'G-CY10FQPGJS', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Hive connector with Amazon S3 &#8212; Starburst Enterprise</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/algolia.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <link rel="stylesheet" type="text/css" href="../_static/search.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sidebar.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/main.js"></script>
    <script src="../_static/heap_analytics.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="File system cache" href="file-system-cache.html" />
    <link rel="prev" title="Legacy Google Cloud Storage support" href="legacy-gcs.html" />

  
   

<link href="https://fonts.googleapis.com/css2?family=Barlow&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" >


<!-- Always link to the latest version, as canonical -->
<link rel="canonical" href="https://docs.starburst.io/latest/object-storage/legacy-s3.html">

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#object-storage/legacy-s3" tabindex="1" class="md-skip"> Skip to content </a>
  
<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://www.starburst.io" title="Starburst Enterprise"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_White+Blue.svg"
                   alt="Starburst Enterprise 453-e.10 LTS logo">
          
        </a>
      </div>
      <span class="header-divider"></span>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <a href="/starburst-enterprise/index.html"
          class="md-header-nav__topic">
          Documentation: Starburst Enterprise 453-e.10 LTS</a>
          <span class="md-header-nav__topic"> Hive connector with Amazon S3 </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        <div id="algolia-search">
  <div id="searchbox"></div>
  <div id="product-list">
    <h6 class="filter-label">Product:</h6>
  </div>
  <div id="versionsRefinementList" id="version-list" style="display:none"></div>
  <div id="hits"></div>
  <div id="stats"></div>
</div>
      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (462-e)" href="/462-e/">Latest LTS (462-e)</a>
      
          <a title="453-e LTS" href="/453-e/">453-e LTS</a>
      
          <a title="443-e LTS" href="/443-e/">443-e LTS</a>
      
          <a title="435-e LTS" href="/435-e/">435-e LTS</a>
      
          <a title="Latest STS (468-e)" href="/468-e/">Latest STS (468-e)</a>
      
          <a title="467-e STS" href="/467-e/">467-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="/introduction/index.html" class="md-tabs__link">Introduction</a></li>
            
            <li class="md-tabs__item"><a href="/clients/index.html" class="md-tabs__link">Clients</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-galaxy/index.html" class="md-tabs__link">Starburst Galaxy</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-enterprise/index.html" class="md-tabs__link">Starburst Enterprise</a></li>
            
            <li class="md-tabs__item"><a href="/resources.html" class="md-tabs__link">Resources</a></li>
          <li class="md-tabs__item"><a href="../object-storage.html" class="md-tabs__link">Object storage</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_White+Blue.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise">Starburst Enterprise 453-e.10 LTS</a>
  </label>
  
  
  <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get-started/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/starburst-enterprise.html">What is Starburst Enterprise?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/try/try-sep.html">Try Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learn/index.html">Learn Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Product versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.starburst.io/support.html">Get support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For all users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/sep-ui.html">Starburst Enterprise web UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-products.html">Data products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../insights.html">Insights</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use SQL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language.html">SQL language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">SQL statement syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">Functions and operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routines.html">SQL routines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For data engineers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../catalogs.html">Define catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object-storage.html">Object storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-engineering/materialized-views.html">Materialized views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">Query optimizer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Connect to data sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">Connector overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object-storage-connectors.html">Object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-object-storage-connectors.html">Non-object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community-connectors.html">Community-supported connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector/starburst-connectors.html">Starburst connectors feature matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-engineering/cost-and-performance/index.html">Monitor and manage cost and performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For platform administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-topics.html">Administration topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">Performance, logging, and governance features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starburst-rest-api.html">Starburst Enterprise REST API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deploy in cloud ecosystems</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/aws/index.html">AWS ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/google/index.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/microsoft/index.html">Microsoft Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/redhat/index.html">Red Hat OpenShift</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SEP deployment mechanisms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license-requirements.html">Starburst Enterprise license</a></li>
<li class="toctree-l1"><a class="reference internal" href="../k8s.html">Deploy with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starburst-admin.html">Deploy with Starburst Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">Deploy with CFT on AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Local installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">Trino developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Version-specific notices and information</a></li>
</ul>
  
  
</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#object-storage-legacy-s3--page-root" class="md-nav__link">Hive connector with Amazon S3</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#s3-configuration-properties" class="md-nav__link">S3 configuration properties</a>
        </li>
        <li class="md-nav__item"><a href="#s3-credentials" class="md-nav__link">S3 credentials</a>
        </li>
        <li class="md-nav__item"><a href="#custom-s3-credentials-provider" class="md-nav__link">Custom S3 credentials provider</a>
        </li>
        <li class="md-nav__item"><a href="#s3-security-mapping" class="md-nav__link">S3 security mapping</a>
        </li>
        <li class="md-nav__item"><a href="#tuning-properties" class="md-nav__link">Tuning properties</a>
        </li>
        <li class="md-nav__item"><a href="#s3-data-encryption" class="md-nav__link">S3 data encryption</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#server-side-encryption-with-s3-managed-keys" class="md-nav__link">Server-side encryption with S3 managed keys</a>
        </li>
        <li class="md-nav__item"><a href="#server-side-encryption-with-customer-provided-keys" class="md-nav__link">Server-side encryption with customer-provided keys</a>
        </li>
        <li class="md-nav__item"><a href="#client-side-encryption" class="md-nav__link">Client-side encryption</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#migration-to-native-s3-implementation" class="md-nav__link">Migration to native S3 implementation</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="hive-connector-with-amazon-s3">
<h1 id="object-storage-legacy-s3--page-root">Hive connector with Amazon S3<a class="headerlink" href="#object-storage-legacy-s3--page-root" title="Permalink to this heading">#</a></h1>
<p>The <a class="reference internal" href="../connector/hive.html"><span class="doc">Hive connector</span></a> can read and write tables that are stored in
<a class="reference external" href="https://aws.amazon.com/s3/">Amazon S3</a> or S3-compatible systems.
This is accomplished by having a table or database location that
uses an S3 prefix, rather than an HDFS prefix.</p>
<p>Trino uses its own S3 filesystem for the URI prefixes
<code class="docutils literal notranslate"><span class="pre">s3://</span></code>, <code class="docutils literal notranslate"><span class="pre">s3n://</span></code> and  <code class="docutils literal notranslate"><span class="pre">s3a://</span></code>.</p>
<section id="s3-configuration-properties">
<span id="hive-s3-configuration"></span><h2 id="s3-configuration-properties">S3 configuration properties<a class="headerlink" href="#s3-configuration-properties" title="Permalink to this heading">#</a></h2>
<table>
<colgroup>
<col style="width: 35%"/>
<col style="width: 65%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.aws-access-key</span></code></p></td>
<td><p>Default AWS access key to use.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.aws-secret-key</span></code></p></td>
<td><p>Default AWS secret key to use.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.iam-role</span></code></p></td>
<td><p>IAM role to assume.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.external-id</span></code></p></td>
<td><p>External ID for the IAM role trust policy.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.endpoint</span></code></p></td>
<td><p>The S3 storage endpoint server. This can be used to connect to an
S3-compatible storage system instead of AWS. When using v4 signatures, it is
recommended to set this to the AWS region-specific endpoint (e.g.,
<code class="docutils literal notranslate"><span class="pre">http[s]://s3.&lt;AWS-region&gt;.amazonaws.com</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.region</span></code></p></td>
<td><p>Optional property to force the S3 client to connect to the specified region
only.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.storage-class</span></code></p></td>
<td><p>The S3 storage class to use when writing the data. Currently only <code class="docutils literal notranslate"><span class="pre">STANDARD</span></code>
and <code class="docutils literal notranslate"><span class="pre">INTELLIGENT_TIERING</span></code> storage classes are supported. Default storage
class is <code class="docutils literal notranslate"><span class="pre">STANDARD</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.signer-type</span></code></p></td>
<td><p>Specify a different signer type for S3-compatible storage. Example:
<code class="docutils literal notranslate"><span class="pre">S3SignerType</span></code> for v2 signer type</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.signer-class</span></code></p></td>
<td><p>Specify a different signer class for S3-compatible storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.path-style-access</span></code></p></td>
<td><p>Use path-style access for all requests to the S3-compatible storage. This is
for S3-compatible storage that doesn’t support virtual-hosted-style access,
defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.staging-directory</span></code></p></td>
<td><p>Local staging directory for data written to S3. This defaults to the Java
temporary directory specified by the JVM system property <code class="docutils literal notranslate"><span class="pre">java.io.tmpdir</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.pin-client-to-current-region</span></code></p></td>
<td><p>Pin S3 requests to the same region as the EC2 instance where Trino is
running, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.ssl.enabled</span></code></p></td>
<td><p>Use HTTPS to communicate with the S3 API, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.enabled</span></code></p></td>
<td><p>Use S3 server-side encryption, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.type</span></code></p></td>
<td><p>The type of key management for S3 server-side encryption. Use <code class="docutils literal notranslate"><span class="pre">S3</span></code> for S3
managed keys, <code class="docutils literal notranslate"><span class="pre">CUSTOMER</span></code> for customer-provided keys, or <code class="docutils literal notranslate"><span class="pre">KMS</span></code> for
KMS-managed keys. Defaults to <code class="docutils literal notranslate"><span class="pre">S3</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.customer-key</span></code></p></td>
<td><p>The key when using a customer-provided key for S3 server-side encryption.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.kms-key-id</span></code></p></td>
<td><p>The KMS Key ID to use for S3 server-side encryption with KMS-managed keys.
If not set, the default key is used.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.kms-key-id</span></code></p></td>
<td><p>If set, use S3 client-side encryption and use the AWS KMS to store
encryption keys and use the value of this property as the KMS Key ID for
newly created objects.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.encryption-materials-provider</span></code></p></td>
<td><p>If set, use S3 client-side encryption and use the value of this property as
the fully qualified name of a Java class which implements the AWS SDK’s
<code class="docutils literal notranslate"><span class="pre">EncryptionMaterialsProvider</span></code> interface. If the class also implements
<code class="docutils literal notranslate"><span class="pre">Configurable</span></code> from the Hadoop API, the Hadoop configuration will be passed
in after the object has been created.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.upload-acl-type</span></code></p></td>
<td><p>Canned ACL to use while uploading files to S3, defaults to <code class="docutils literal notranslate"><span class="pre">PRIVATE</span></code>. If the
files are to be uploaded to an S3 bucket owned by a different AWS user, the
canned ACL has to be set to one of the following: <code class="docutils literal notranslate"><span class="pre">AUTHENTICATED_READ</span></code>,
<code class="docutils literal notranslate"><span class="pre">AWS_EXEC_READ</span></code>, <code class="docutils literal notranslate"><span class="pre">BUCKET_OWNER_FULL_CONTROL</span></code>, <code class="docutils literal notranslate"><span class="pre">BUCKET_OWNER_READ</span></code>,
<code class="docutils literal notranslate"><span class="pre">LOG_DELIVERY_WRITE</span></code>, <code class="docutils literal notranslate"><span class="pre">PUBLIC_READ</span></code>, <code class="docutils literal notranslate"><span class="pre">PUBLIC_READ_WRITE</span></code>. Refer to the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">canned</span> <span class="pre">ACL</span> <span class="pre">&lt;https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-s3-acls.html&gt;</span></code>_
guide to understand each option’s definition.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.skip-glacier-objects</span></code></p></td>
<td><p>Ignore Glacier objects rather than failing the query. This skips data that
may be expected to be part of the table or partition. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.streaming.enabled</span></code></p></td>
<td><p>Use S3 multipart upload API to upload file in streaming way, without staging
file to be created in the local file system.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.streaming.part-size</span></code></p></td>
<td><p>The part size for S3 streaming upload. Defaults to <code class="docutils literal notranslate"><span class="pre">16MB</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.host</span></code></p></td>
<td><p>Proxy host to use if connecting through a proxy.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.port</span></code></p></td>
<td><p>Proxy port to use if connecting through a proxy.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.protocol</span></code></p></td>
<td><p>Proxy protocol. HTTP or HTTPS , defaults to <code class="docutils literal notranslate"><span class="pre">HTTPS</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.non-proxy-hosts</span></code></p></td>
<td><p>Hosts list to access without going through the proxy.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.username</span></code></p></td>
<td><p>Proxy user name to use if connecting through a proxy.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.password</span></code></p></td>
<td><p>Proxy password to use if connecting through a proxy.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.preemptive-basic-auth</span></code></p></td>
<td><p>Whether to attempt to authenticate preemptively against proxy when using
base authorization, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sts.endpoint</span></code></p></td>
<td><p>Optional override for the sts endpoint given that IAM role based
authentication via sts is used.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sts.region</span></code></p></td>
<td><p>Optional override for the sts region given that IAM role based
authentication via sts is used.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.storage-class-filter</span></code></p></td>
<td><p>Filter based on storage class of S3 object, defaults to <code class="docutils literal notranslate"><span class="pre">READ_ALL</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="s3-credentials">
<span id="hive-s3-credentials"></span><h2 id="s3-credentials">S3 credentials<a class="headerlink" href="#s3-credentials" title="Permalink to this heading">#</a></h2>
<p>If you are running Trino on Amazon EC2, using EMR or another facility,
it is recommended that you use IAM Roles for EC2 to govern access to S3.
To enable this, your EC2 instances need to be assigned an IAM Role which
grants appropriate access to the data stored in the S3 bucket(s) you wish
to use. It is also possible to configure an IAM role with <code class="docutils literal notranslate"><span class="pre">hive.s3.iam-role</span></code>
that is used for accessing any S3 bucket. This is much cleaner than
setting AWS access and secret keys in the <code class="docutils literal notranslate"><span class="pre">hive.s3.aws-access-key</span></code>
and <code class="docutils literal notranslate"><span class="pre">hive.s3.aws-secret-key</span></code> settings, and also allows EC2 to automatically
rotate credentials on a regular basis without any additional work on your part.</p>
<p>If you are running Trino on Amazon EKS, and authenticate using a Kubernetes
service account, you can set the
<code class="docutils literal notranslate"><span class="pre">trino.s3.use-web-identity-token-credentials-provider</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>, so Trino does
not try using different credential providers from the default credential
provider chain.</p>
</section>
<section id="custom-s3-credentials-provider">
<h2 id="custom-s3-credentials-provider">Custom S3 credentials provider<a class="headerlink" href="#custom-s3-credentials-provider" title="Permalink to this heading">#</a></h2>
<p>You can configure a custom S3 credentials provider by setting the configuration
property <code class="docutils literal notranslate"><span class="pre">trino.s3.credentials-provider</span></code> to the fully qualified class name of
a custom AWS credentials provider implementation. The property must be set in
the Hadoop configuration files referenced by the <code class="docutils literal notranslate"><span class="pre">hive.config.resources</span></code> Hive
connector property.</p>
<p>The class must implement the
<a class="reference external" href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/AWSCredentialsProvider.html">AWSCredentialsProvider</a>
interface and provide a two-argument constructor that takes a
<code class="docutils literal notranslate"><span class="pre">java.net.URI</span></code> and a Hadoop <code class="docutils literal notranslate"><span class="pre">org.apache.hadoop.conf.Configuration</span></code>
as arguments. A custom credentials provider can be used to provide
temporary credentials from STS (using <code class="docutils literal notranslate"><span class="pre">STSSessionCredentialsProvider</span></code>),
IAM role-based credentials (using <code class="docutils literal notranslate"><span class="pre">STSAssumeRoleSessionCredentialsProvider</span></code>),
or credentials for a specific use case (e.g., bucket/user specific credentials).</p>
</section>
<section id="s3-security-mapping">
<span id="hive-s3-security-mapping"></span><h2 id="s3-security-mapping">S3 security mapping<a class="headerlink" href="#s3-security-mapping" title="Permalink to this heading">#</a></h2>
<p>Trino supports flexible security mapping for S3, allowing for separate
credentials or IAM roles for specific users or buckets/paths. The IAM role
for a specific query can be selected from a list of allowed roles by providing
it as an <em>extra credential</em>.</p>
<p>Each security mapping entry may specify one or more match criteria. If multiple
criteria are specified, all criteria must match. Available match criteria:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code>: Regular expression to match against username. Example: <code class="docutils literal notranslate"><span class="pre">alice|bob</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code>: Regular expression to match against any of the groups that the user
belongs to. Example: <code class="docutils literal notranslate"><span class="pre">finance|sales</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prefix</span></code>: S3 URL prefix. It can specify an entire bucket or a path within a
bucket. The URL must start with <code class="docutils literal notranslate"><span class="pre">s3://</span></code> but will also match <code class="docutils literal notranslate"><span class="pre">s3a</span></code> or <code class="docutils literal notranslate"><span class="pre">s3n</span></code>.
Example: <code class="docutils literal notranslate"><span class="pre">s3://bucket-name/abc/xyz/</span></code></p></li>
</ul>
<p>The security mapping must provide one or more configuration settings:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">accessKey</span></code> and <code class="docutils literal notranslate"><span class="pre">secretKey</span></code>: AWS access key and secret key. This overrides
any globally configured credentials, such as access key or instance credentials.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iamRole</span></code>: IAM role to use if no user provided role is specified as an
extra credential. This overrides any globally configured IAM role. This role
is allowed to be specified as an extra credential, although specifying it
explicitly has no effect, as it would be used anyway.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">roleSessionName</span></code>: Optional role session name to use with <code class="docutils literal notranslate"><span class="pre">iamRole</span></code>. This can only
be used when <code class="docutils literal notranslate"><span class="pre">iamRole</span></code> is specified. If <code class="docutils literal notranslate"><span class="pre">roleSessionName</span></code> includes the string
<code class="docutils literal notranslate"><span class="pre">${USER}</span></code>, then the <code class="docutils literal notranslate"><span class="pre">${USER}</span></code> portion of the string will be replaced with the
current session’s username. If <code class="docutils literal notranslate"><span class="pre">roleSessionName</span></code> is not specified, it defaults
to <code class="docutils literal notranslate"><span class="pre">trino-session</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allowedIamRoles</span></code>: IAM roles that are allowed to be specified as an extra
credential. This is useful because a particular AWS account may have permissions
to use many roles, but a specific user should only be allowed to use a subset
of those roles.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kmsKeyId</span></code>: ID of KMS-managed key to be used for client-side encryption.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allowedKmsKeyIds</span></code>: KMS-managed key IDs that are allowed to be specified as an extra
credential. If list cotains “*”, then any key can be specified via extra credential.</p></li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">endpoint</span></code>: The S3 storage endpoint server. This optional property can be used
to override S3 endpoints on a per-bucket basis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">region</span></code>: The region S3 client should connect to. This optional property can be used
to override S3 regions on a per-bucket basis.</p></li>
</ul>
<p>The security mapping entries are processed in the order listed in the configuration
JSON. More specific mappings should thus be specified before less specific mappings.
For example, the mapping list might have URL prefix <code class="docutils literal notranslate"><span class="pre">s3://abc/xyz/</span></code> followed by
<code class="docutils literal notranslate"><span class="pre">s3://abc/</span></code> to allow different configuration for a specific path within a bucket
than for other paths within the bucket. You can set default configuration by not
including any match criteria for the last entry in the list.</p>
<p>In addition to the rules above, the default mapping can contain the optional
<code class="docutils literal notranslate"><span class="pre">useClusterDefault</span></code> boolean property with the following behavior:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code> - (is set by default) property is ignored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code> - This causes the default cluster role to be used as a fallback option.
It can not be used with the following configuration properties:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">accessKey</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secretKey</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iamRole</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allowedIamRoles</span></code></p></li>
</ul>
</li>
</ul>
<p>If no mapping entry matches and no default is configured, the access is denied.</p>
<p>The configuration JSON can either be retrieved from a file or REST-endpoint specified via
<code class="docutils literal notranslate"><span class="pre">hive.s3.security-mapping.config-file</span></code>.</p>
<p>Example JSON configuration:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"mappings"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"prefix"</span><span class="p">:</span> <span class="s2">"s3://bucket-name/abc/"</span><span class="p">,</span>
      <span class="nt">"iamRole"</span><span class="p">:</span> <span class="s2">"arn:aws:iam::123456789101:role/test_path"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"bob|charlie"</span><span class="p">,</span>
      <span class="nt">"iamRole"</span><span class="p">:</span> <span class="s2">"arn:aws:iam::123456789101:role/test_default"</span><span class="p">,</span>
      <span class="nt">"allowedIamRoles"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"arn:aws:iam::123456789101:role/test1"</span><span class="p">,</span>
        <span class="s2">"arn:aws:iam::123456789101:role/test2"</span><span class="p">,</span>
        <span class="s2">"arn:aws:iam::123456789101:role/test3"</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"prefix"</span><span class="p">:</span> <span class="s2">"s3://special-bucket/"</span><span class="p">,</span>
      <span class="nt">"accessKey"</span><span class="p">:</span> <span class="s2">"AKIAxxxaccess"</span><span class="p">,</span>
      <span class="nt">"secretKey"</span><span class="p">:</span> <span class="s2">"iXbXxxxsecret"</span>
    <span class="p">},</span> 
    <span class="p">{</span>
      <span class="nt">"prefix"</span><span class="p">:</span> <span class="s2">"s3://regional-bucket/"</span><span class="p">,</span>
      <span class="nt">"iamRole"</span><span class="p">:</span> <span class="s2">"arn:aws:iam::123456789101:role/regional-user"</span><span class="p">,</span>
      <span class="nt">"endpoint"</span><span class="p">:</span> <span class="s2">"https://bucket.vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com"</span><span class="p">,</span>
      <span class="nt">"region"</span><span class="p">:</span> <span class="s2">"us-east-1"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"prefix"</span><span class="p">:</span> <span class="s2">"s3://encrypted-bucket/"</span><span class="p">,</span>
      <span class="nt">"kmsKeyId"</span><span class="p">:</span> <span class="s2">"kmsKey_10"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"test.*"</span><span class="p">,</span>
      <span class="nt">"iamRole"</span><span class="p">:</span> <span class="s2">"arn:aws:iam::123456789101:role/test_users"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"group"</span><span class="p">:</span> <span class="s2">"finance"</span><span class="p">,</span>
      <span class="nt">"iamRole"</span><span class="p">:</span> <span class="s2">"arn:aws:iam::123456789101:role/finance_users"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"iamRole"</span><span class="p">:</span> <span class="s2">"arn:aws:iam::123456789101:role/default"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.security-mapping.config-file</span></code></p></td>
<td><p>The JSON configuration file or REST-endpoint URI containing security mappings.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.security-mapping.json-pointer</span></code></p></td>
<td><p>A JSON pointer (RFC 6901) to mappings inside the JSON retrieved from the config file or REST-endpont. The whole document (“”) by default.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.security-mapping.iam-role-credential-name</span></code></p></td>
<td><p>The name of the <em>extra credential</em> used to provide the IAM role.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.security-mapping.kms-key-id-credential-name</span></code></p></td>
<td><p>The name of the <em>extra credential</em> used to provide the KMS-managed key ID.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.security-mapping.refresh-period</span></code></p></td>
<td><p>How often to refresh the security mapping configuration.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.security-mapping.colon-replacement</span></code></p></td>
<td><p>The character or characters to be used in place of the colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>) character when specifying an IAM role name as an extra credential. Any instances of this replacement value in the extra credential value will be converted to a colon. Choose a value that is not used in any of your IAM ARNs.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tuning-properties">
<span id="hive-s3-tuning-configuration"></span><h2 id="tuning-properties">Tuning properties<a class="headerlink" href="#tuning-properties" title="Permalink to this heading">#</a></h2>
<p>The following tuning properties affect the behavior of the client
used by the Trino S3 filesystem when communicating with S3.
Most of these parameters affect settings on the <code class="docutils literal notranslate"><span class="pre">ClientConfiguration</span></code>
object associated with the <code class="docutils literal notranslate"><span class="pre">AmazonS3Client</span></code>.</p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-error-retries</span></code></p></td>
<td><p>Maximum number of error retries, set on the S3 client.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-client-retries</span></code></p></td>
<td><p>Maximum number of read attempts to retry.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-backoff-time</span></code></p></td>
<td><p>Use exponential backoff starting at 1 second up to this maximum value when communicating with S3.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">minutes</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-retry-time</span></code></p></td>
<td><p>Maximum time to retry communicating with S3.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">minutes</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.connect-timeout</span></code></p></td>
<td><p>TCP connect timeout.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">seconds</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.connect-ttl</span></code></p></td>
<td><p>TCP connect TTL, which affects connection reusage.</p></td>
<td><p>Connections do not expire.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.socket-timeout</span></code></p></td>
<td><p>TCP socket read timeout.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">seconds</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-connections</span></code></p></td>
<td><p>Maximum number of simultaneous open connections to S3.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">500</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.multipart.min-file-size</span></code></p></td>
<td><p>Minimum file size before multi-part upload to S3 is used.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16</span> <span class="pre">MB</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.multipart.min-part-size</span></code></p></td>
<td><p>Minimum multi-part upload part size.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">MB</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="s3-data-encryption">
<span id="hive-s3-data-encryption"></span><h2 id="s3-data-encryption">S3 data encryption<a class="headerlink" href="#s3-data-encryption" title="Permalink to this heading">#</a></h2>
<p>SEP supports reading and writing encrypted data in S3 using server-side
encryption with S3 managed keys, server-side encryption with customer-managed
keys, and client-side encryption using either the Amazon KMS or a software
plugin to manage AES encryption keys.</p>
<section id="server-side-encryption-with-s3-managed-keys">
<span id="hive-sse-s3"></span><h3 id="server-side-encryption-with-s3-managed-keys">Server-side encryption with S3 managed keys<a class="headerlink" href="#server-side-encryption-with-s3-managed-keys" title="Permalink to this heading">#</a></h3>
<p>With <a class="reference external" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/serv-side-encryption.html">S3 server-side encryption</a>,
called <em>SSE-S3</em> in the Amazon documentation, the S3 infrastructure takes care of all encryption and decryption
work. One exception is SSL to the client, assuming you have <code class="docutils literal notranslate"><span class="pre">hive.s3.ssl.enabled</span></code> set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.
S3 also manages all the encryption keys for you. To enable this, set <code class="docutils literal notranslate"><span class="pre">hive.s3.sse.enabled</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</section>
<section id="server-side-encryption-with-customer-provided-keys">
<h3 id="server-side-encryption-with-customer-provided-keys">Server-side encryption with customer-provided keys<a class="headerlink" href="#server-side-encryption-with-customer-provided-keys" title="Permalink to this heading">#</a></h3>
<p>Server-side encryption with customer-provided keys (SSE-C) allows you to to use
a custom key to encrypt your data stored in S3.</p>
<p>To enable SSE-C, set the following configuration properties:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">hive.s3.sse.type</span><span class="o">=</span><span class="s">CUSTOMER</span>
<span class="na">hive.s3.sse.customer-key</span><span class="o">=</span><span class="s">&lt;your-key&gt;</span>
<span class="na">hive.s3.sse.enabled</span><span class="o">=</span><span class="s">true</span>
</pre></div>
</div>
</section>
<section id="client-side-encryption">
<h3 id="client-side-encryption">Client-side encryption<a class="headerlink" href="#client-side-encryption" title="Permalink to this heading">#</a></h3>
<p>With <a class="reference external" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingClientSideEncryption.html">S3 client-side encryption</a>,
S3 stores encrypted data and the encryption keys are managed outside of the S3 infrastructure. Data is encrypted
and decrypted by Trino instead of in the S3 infrastructure. In this case, encryption keys can be managed
either by using the AWS KMS, or your own key management system. To use the AWS KMS for key management, set
<code class="docutils literal notranslate"><span class="pre">hive.s3.kms-key-id</span></code> to the UUID of a KMS key. Your AWS credentials or EC2 IAM role will need to be
granted permission to use the given key as well.</p>
<p>To use a custom encryption key management system, set <code class="docutils literal notranslate"><span class="pre">hive.s3.encryption-materials-provider</span></code> to the
fully qualified name of a class which implements the
<a class="reference external" href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/model/EncryptionMaterialsProvider.html">EncryptionMaterialsProvider</a>
interface from the AWS Java SDK. This class has to be accessible to the Hive Connector through the
classpath and must be able to communicate with your custom key management system. If this class also implements
the <code class="docutils literal notranslate"><span class="pre">org.apache.hadoop.conf.Configurable</span></code> interface from the Hadoop Java API, then the Hadoop configuration
is passed in after the object instance is created, and before it is asked to provision or retrieve any
encryption keys.</p>
</section>
</section>
<section id="migration-to-native-s3-implementation">
<span id="legacy-s3-migration"></span><h2 id="migration-to-native-s3-implementation">Migration to native S3 implementation<a class="headerlink" href="#migration-to-native-s3-implementation" title="Permalink to this heading">#</a></h2>
<p>SEP includes a <a class="reference internal" href="file-system-s3.html"><span class="doc">native S3 implementation</span></a> that does not rely on the legacy Hadoop
implementation. Starburst recommends upgrading existing deployments to the new
native implementation at your earliest convenience.</p>
<p>The following considerations apply to legacy configurations moving to the
native implementation:</p>
<ul class="simple">
<li><p>SSL is always enabled and cannot be disabled.</p></li>
<li><p>Client-side encryption is not supported. Server-side encryption (SSE) is
the recommended alternative.</p></li>
<li><p>Multipart (non-streaming) writes and upload are not supported.</p></li>
</ul>
<p>To migrate a catalog to use the native filesystem implementation for S3, make
the following edits to your catalog configuration:</p>
<ol class="arabic simple">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">fs.hadoop.enabled</span></code> catalog configuration property to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>Add the <code class="docutils literal notranslate"><span class="pre">fs.native-s3.enabled=true</span></code> catalog configuration property.</p></li>
<li><p>Refer to the following table to rename your existing legacy catalog
configuration properties to the corresponding native configuration
properties. Supported configuration values are identical unless otherwise
noted.</p></li>
</ol>
<table>
<colgroup>
<col style="width: 26%"/>
<col style="width: 26%"/>
<col style="width: 48%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Legacy property</p></th>
<th class="head"><p>Native property</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.aws-access-key</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.aws-access-key</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.aws-secret-key</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.aws-secret-key</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.iam-role</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.iam-role</span></code></p></td>
<td><p>Also see <code class="docutils literal notranslate"><span class="pre">s3.role-session-name</span></code> in <a class="reference internal" href="file-system-s3.html"><span class="doc">S3 file system support</span></a>
for more role configuration options.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.external-id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.external-id</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.endpoint</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.endpoint</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.region</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.region</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.enabled</span></code></p></td>
<td><p>None</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.sse.type</span></code> being set to the default value of <code class="docutils literal notranslate"><span class="pre">NONE</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">hive.s3.sse.enabled=false</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.sse.type</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.kms-key-id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.sse.kms-key-id</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.upload-acl-type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.canned-acl</span></code></p></td>
<td><p>See <a class="reference internal" href="file-system-s3.html"><span class="doc">S3 file system support</span></a> for supported values.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.streaming.part-size</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.streaming.part-size</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.host</span></code>, <code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.port</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.http-proxy</span></code></p></td>
<td><p>Specify the host and port in one URL, for example <code class="docutils literal notranslate"><span class="pre">localhost:8888</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.protocol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.http-proxy.secure</span></code></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> to enable HTTPS.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.non-proxy-hosts</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.http-proxy.non-proxy-hosts</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.username</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.http-proxy.username</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.password</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.http-proxy.password</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.proxy.preemptive-basic-auth</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.http-proxy.preemptive-basic-auth</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sts.endpoint</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.sts.endpoint</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sts.region</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.sts.region</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-error-retries</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.max-error-retries</span></code></p></td>
<td><p>Also see <code class="docutils literal notranslate"><span class="pre">s3.retry-mode</span></code> in <a class="reference internal" href="file-system-s3.html"><span class="doc">S3 file system support</span></a> for
more retry behavior configuration options.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.connect-timeout</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.connect-timeout</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.connect-ttl</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.connection-ttl</span></code></p></td>
<td><p>Also see <code class="docutils literal notranslate"><span class="pre">s3.connection-max-idle-time</span></code> in
<a class="reference internal" href="file-system-s3.html"><span class="doc">S3 file system support</span></a> for more connection keep-alive
options.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.socket-timeout</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.socket-read-timeout</span></code></p></td>
<td><p>Also see <code class="docutils literal notranslate"><span class="pre">s3.tcp-keep-alive</span></code> in <a class="reference internal" href="file-system-s3.html"><span class="doc">S3 file system support</span></a> for
more socket connection keep-alive options.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-connections</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.max-connections</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3.path-style-access</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3.path-style-access</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="4">
<li><p>Remove the following legacy configuration properties if they
exist in your catalog configuration:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.storage-class</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.signer-type</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.signer-class</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.staging-directory</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.pin-client-to-current-region</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.ssl.enabled</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.sse.enabled</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.kms-key-id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.encryption-materials-provider</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.streaming.enabled</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-client-retries</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-backoff-time</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.max-retry-time</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.multipart.min-file-size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.multipart.min-part-size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3-file-system-type</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hive.s3.user-agent-prefix</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warp-speed.config.internal-communication.shared-secret</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warp-speed.use-http-server-port</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warp-speed.config.http-rest-port-enabled</span></code></p></li>
</ul>
</li>
</ol>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
<div class="md-grid md-main__inner" style="height: auto;">
  <div class="md-content">
    <div class="feedback-container md-content__inner md-typeset">
      <div class="feedback-thumbs">
        <p>Is the information on this page helpful?</p>
        <p class="feedback-option" title="yes">Yes</p>
        <p class="feedback-option" title="no">No</p>
      </div>
      <div class="feedback-message">
        <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
        <button type="button" onclick="sendMessage()" class="feedback-button">Email</button>
        <a onclick="skip()" class="feedback-skip">Cancel</a>
      </div>
    </div>
  </div>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '');
</script>
<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="legacy-gcs.html" title="Legacy Google Cloud Storage support"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Legacy Google Cloud Storage support </span>
              </div>
            </a>
          
          
            <a href="file-system-cache.html" title="File system cache"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> File system cache </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
<!-- custom footer should go here in time -->
<div class="page-footer">
  <div class="container md-grid">
    <div class="row">
      <div class="col-md-3">
        <p style="font-weight:900">Resources</p>
        <ul>
          <li class="footer-item"><a href="https://docs.starburst.io/latest/index.html">Starburst Enterprise reference documentation</a></li>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/starburst-intro-and-demo/" target="_blank">Join our weekly demos</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#!" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">

        <a href="https://www.starburst.io/" target="_blank">
          
            <img src="../_static/Starburst_Logo_White+Blue.svg" height="26"
                  alt="Starburst Enterprise 453-e.10 LTS logo">
        
        </a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2024<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
  </div>
</div>
<script src="https://docs.starburst.io/453-e/_static/algolia.js"></script>
<script src="https://docs.starburst.io/453-e/_static/searchbox.js" data-versions="{'Latest LTS (462-e)': '/462-e/', '453-e LTS': '/453-e/', '443-e LTS': '/443-e/', '435-e LTS': '/435-e/', 'Latest STS (468-e)': '/468-e/', '467-e STS': '/467-e/'}"></script>
<script src="https://docs.starburst.io/453-e/_static/searchresults.js" data-versions="{'Latest LTS (462-e)': '/462-e/', '453-e LTS': '/453-e/', '443-e LTS': '/443-e/', '435-e LTS': '/435-e/', 'Latest STS (468-e)': '/468-e/', '467-e STS': '/467-e/'}"></script>
  </body>
</html>