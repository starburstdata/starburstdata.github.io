
<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CY10FQPGJS"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-CY10FQPGJS');
</script>
  
  
    <title>Installation &#8212; Starburst Enterprise</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=bbebba6e" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/algolia.css?v=0e0f969e" />
    <link rel="stylesheet" type="text/css" href="../../_static/starburst.css?v=c0e612e9" />
    <link rel="stylesheet" type="text/css" href="../../_static/search.css?v=87ff3654" />
    <link rel="stylesheet" type="text/css" href="../../_static/sidebar.css?v=7da5440c" />
    <script src="../../_static/documentation_options.js?v=a68ab161"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=e378d701"></script>
    <script src="../../_static/main.js?v=45c62a64"></script>
    <script src="../../_static/heap_analytics.js?v=eba036f6"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Gateway API" href="gateway-api.html" />
    <link rel="prev" title="Starburst Gateway" href="index.html" />

  
   

<link href="https://fonts.googleapis.com/css2?family=Barlow&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" >


<!-- Always link to the latest version, as canonical -->
<link rel="canonical" href="https://docs.starburst.io/latest/admin/starburst-gateway/installation.html">

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#admin/starburst-gateway/installation" tabindex="1" class="md-skip"> Skip to content </a>
  
<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.starburst.io" title="Starburst Enterprise"
          class="md-header-nav__button md-logo">
            <img src="../../_static/img/Starburst_Logo_White+Blue.svg"
              alt="Starburst Enterprise 478-e STS logo">
        </a>
      </div>
      <span class="header-divider"></span>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <a href="/starburst-enterprise/index.html"
          class="md-header-nav__topic">
          Documentation: Starburst Enterprise 478-e STS</a>
          <span class="md-header-nav__topic"> Installation </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        <div id="algolia-search">
  <div id="searchbox"></div>
  <div id="product-list">
    <h6 class="filter-label">Product:</h6>
  </div>
  <div id="versionsRefinementList" id="version-list" style="display:none"></div>
  <div id="hits"></div>
  <div id="stats"></div>
</div>
      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (477-e)" href="/477-e/">Latest LTS (477-e)</a>
      
          <a title="476-e LTS" href="/476-e/">476-e LTS</a>
      
          <a title="474-e LTS" href="/474-e/">474-e LTS</a>
      
          <a title="468-e LTS" href="/468-e/">468-e LTS</a>
      
          <a title="Latest STS (478-e)" href="/478-e/">Latest STS (478-e)</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="/introduction/index.html" class="md-tabs__link">Introduction</a></li>
            
            <li class="md-tabs__item"><a href="/clients/index.html" class="md-tabs__link">Clients</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-galaxy/index.html" class="md-tabs__link">Starburst Galaxy</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-enterprise/index.html" class="md-tabs__link">Starburst Enterprise</a></li>
            
            <li class="md-tabs__item"><a href="/resources.html" class="md-tabs__link">Resources</a></li>
          <li class="md-tabs__item"><a href="../../admin.html" class="md-tabs__link">Performance, logging, and governance features</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Starburst Gateway</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="Starburst Enterprise" class="md-nav__button md-logo">
      
        <img src="../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="Starburst Enterprise">Starburst Enterprise 478-e STS</a>
  </label>
  
  
  <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/starburst-enterprise.html">What is Starburst Enterprise?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/try/try-sep.html">Try Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../learn/index.html">Learn Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Product versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.starburst.io/support.html">Get support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For all users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/sep-ui.html">Starburst Enterprise web UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../starburst-ai/index.html">Starburst AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client.html">Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-products.html">Data products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../insights.html">Insights</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use SQL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language.html">SQL language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sql.html">SQL statement syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functions.html">Functions and operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../udf.html">User-defined functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For data engineers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../catalogs.html">Define catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object-storage.html">Object storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-engineering/materialized-views.html">Materialized views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-engineering/data-maintenance.html">Data maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optimizer.html">Query optimizer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Connect to data sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connector.html">Connector overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object-storage-connectors.html">Object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-object-storage-connectors.html">Non-object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community-connectors.html">Community-supported connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../starburst-catalog.html">Starburst catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../connector/starburst-connectors.html">Starburst connectors feature matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-engineering/cost-and-performance/index.html">Monitor and manage cost and performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For platform administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-topics.html">Administration topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin.html">Performance, logging, and governance features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../starburst-rest-api.html">Starburst Enterprise REST API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deploy in cloud ecosystems</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystems/aws/index.html">AWS ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystems/google/index.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystems/microsoft/index.html">Microsoft Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystems/redhat/index.html">Red Hat OpenShift</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SEP deployment mechanisms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license-requirements.html">Starburst Enterprise license</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../k8s.html">Deploy with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../starburst-admin.html">Deploy with Starburst Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aws.html">Deploy with CFT on AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Local installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../develop.html">Trino developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html">Version-specific notices and information</a></li>
</ul>
  
  
</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
  <div class="local-toc">
    <strong>Contents</strong>
    <ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#backend-database">Backend database</a></li>
<li><a class="reference internal" href="#starburst-clusters">Starburst clusters</a></li>
<li><a class="reference internal" href="#sep-configuration">SEP Configuration</a><ul>
<li><a class="reference internal" href="#enable-forward-processing">Enable forward processing</a></li>
<li><a class="reference internal" href="#configure-header-forwarding">Configure header forwarding</a></li>
<li><a class="reference internal" href="#predefined-proxy-paths">Predefined proxy paths</a></li>
<li><a class="reference internal" href="#environment-variables">Environment variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#routing-rules">Routing rules</a><ul>
<li><a class="reference internal" href="#querycountbasedrouter">QueryCountBasedRouter</a></li>
<li><a class="reference internal" href="#user-queue-awareness-and-monitor-support">User queue awareness and monitor support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logging">Logging <a name="logging"></a></li>
<li><a class="reference internal" href="#additional-statement-paths">Additional statement paths</a></li>
<li><a class="reference internal" href="#load-balancer">Load balancer</a></li>
<li><a class="reference internal" href="#proxy-response-size">Proxy response size</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deploy-gateway-using-starburst-portal">Deploy Gateway using Starburst Portal</a><ul>
<li><a class="reference internal" href="#access-the-helm-chart">Access the Helm Chart</a></li>
<li><a class="reference internal" href="#create-a-secret">Create a secret</a></li>
<li><a class="reference internal" href="#deploy-a-postgresql-database">Deploy a PostgreSQL database</a></li>
<li><a class="reference internal" href="#install-starburst-gateway">Install Starburst Gateway</a></li>
<li><a class="reference internal" href="#enable-starburst-gateway">Enable Starburst Gateway</a></li>
<li><a class="reference internal" href="#access-the-gateway-ui">Access the Gateway UI</a></li>
<li><a class="reference internal" href="#configure-routing-rules">Configure routing rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#health-checks">Health checks</a><ul>
<li><a class="reference internal" href="#info-api-default">INFO_API (default)</a></li>
<li><a class="reference internal" href="#metrics">METRICS</a></li>
<li><a class="reference internal" href="#jdbc">JDBC</a></li>
<li><a class="reference internal" href="#jmx">JMX</a></li>
<li><a class="reference internal" href="#ui-api">UI_API</a></li>
<li><a class="reference internal" href="#noop">NOOP</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>

              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="installation">
<h1 id="admin-starburst-gateway-installation--page-root">Installation<a class="headerlink" href="#admin-starburst-gateway-installation--page-root" title="Link to this heading">#</a></h1>
<p>As of version 476-e, Starburst Gateway and Starburst data catalog are deployed
together using a unified Helm chart called <code class="docutils literal notranslate"><span class="pre">starburst-portal</span></code>. This new
deployment artifact simplifies installation and ensures compatibility with the
latest features and fixes. The previous individual Helm chart for
<code class="docutils literal notranslate"><span class="pre">starburst-gateway</span></code> is no longer supported.</p>
<p>This page provides instructions for installing and configuring Starburst Gateway.</p>
<p>Install Starburst Gateway with <a class="reference internal" href="#gateway-helm">Helm</a>.</p>
<section id="configuration">
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h2>
<p>The following sections describe the configuration requirements for Starburst
Gateway.</p>
<p>Each component of Starburst Gateway has a corresponding node in the
configuration YAML file.</p>
<section id="backend-database">
<span id="gateway-backend-database"></span><h3 id="backend-database">Backend database<a class="headerlink" href="#backend-database" title="Link to this heading">#</a></h3>
<p>Starburst Gateway requires a MySQL, PostgreSQL, or Oracle database.</p>
<p>The Gateway automatically initializes your database when you start it.</p>
</section>
<section id="starburst-clusters">
<h3 id="starburst-clusters">Starburst clusters<a class="headerlink" href="#starburst-clusters" title="Link to this heading">#</a></h3>
<p>Starburst Galaxy and the current and previous Starburst Enterprise LTS versions are compatible
with Starburst Gateway.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starburst Gateway is not compatible with Trino or Amazon Athena.</p>
</div>
</section>
<section id="sep-configuration">
<h3 id="sep-configuration">SEP Configuration<a class="headerlink" href="#sep-configuration" title="Link to this heading">#</a></h3>
<p>Starburst Gateway acts as a transparent proxy for one or more clusters.</p>
<p>Configure all clusters behind Starburst Gateway with the following settings.</p>
<section id="enable-forward-processing">
<h4 id="enable-forward-processing">Enable forward processing<a class="headerlink" href="#enable-forward-processing" title="Link to this heading">#</a></h4>
<p>If you route all client and server communication through Starburst Gateway, enable
process forwarded HTTP headers:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">http-server.process-forwarded</span><span class="o">=</span><span class="s">true</span>
</pre></div>
</div>
<p>Without this setting, initial requests may route correctly from your client to
Starburst Gateway and then to Starburst Enterprise. However, subsequent requests for quests
for query results use the cluster’s local URL instead of the Gateway URL,
bypassing the Gateway entirely. If the cluster’s local URL is private to the
network, these subsequent calls fail.</p>
<p>This setting is also required for SEP to authenticate when TLS terminates at
the Gateway. Normally, SEP refuses to authenticate plain HTTP requests, but
with <code class="docutils literal notranslate"><span class="pre">http-server.process-forwarded=true</span></code>, SEP authenticates over HTTP when
the request includes <code class="docutils literal notranslate"><span class="pre">X-Forwarded-Proto:</span> <span class="pre">HTTPS</span></code>.</p>
</section>
<section id="configure-header-forwarding">
<h4 id="configure-header-forwarding">Configure header forwarding<a class="headerlink" href="#configure-header-forwarding" title="Link to this heading">#</a></h4>
<p>To prevent Starburst Gateway from sending <code class="docutils literal notranslate"><span class="pre">X-Forwarded-*</span></code> headers, set the
following configuration property:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">routing</span><span class="p">:</span>
<span class="w">  </span><span class="nt">addXForwardedHeaders</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>When proxying clusters that are behind firewalls or otherwise not directly
routable from your client, set this property to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</section>
<section id="predefined-proxy-paths">
<h4 id="predefined-proxy-paths">Predefined proxy paths<a class="headerlink" href="#predefined-proxy-paths" title="Link to this heading">#</a></h4>
<p>Starburst Gateway automatically proxies the following paths to SEP clusters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/v1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/ui</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/api/v1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/api/openapi</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/oauth2</span></code></p></li>
</ul>
</section>
<section id="environment-variables">
<h4 id="environment-variables">Environment variables<a class="headerlink" href="#environment-variables" title="Link to this heading">#</a></h4>
<p>Set environment variables in the command line or in your configuration file.</p>
<p>To manually set an environment variable in the command line:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">DB_PASSWORD</span><span class="o">=</span>my-super-secret-pwd
</pre></div>
</div>
<p>To use an environment variable in your configuration file, reference it using
the syntax <code class="docutils literal notranslate"><span class="pre">${ENV:VARIABLE}</span></code>.</p>
</section>
</section>
<section id="routing-rules">
<h3 id="routing-rules">Routing rules<a class="headerlink" href="#routing-rules" title="Link to this heading">#</a></h3>
<p>Find more information in the <a class="reference internal" href="routing-rules.html"><span class="std std-doc">routing rules documentation</span></a>.</p>
<section id="querycountbasedrouter">
<h4 id="querycountbasedrouter">QueryCountBasedRouter<a class="headerlink" href="#querycountbasedrouter" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouter</span></code> is the main routing algorithm Starburst Gateway uses. It
routes queries to a backend within a routing group based on live cluster
statistics and per-user queue pressure.</p>
<p>The algorithm:</p>
<ol class="arabic simple">
<li><p>Filters to healthy backends in the requested routing group</p></li>
<li><p>Chooses the best backend by comparing:</p>
<ul class="simple">
<li><p>The queued query count on each backend (the lowest count wins)</p></li>
<li><p>If two or more queued query counts are equal, the backend’s total queued
queries (the lowest count wins)</p></li>
<li><p>If all of the backend’s total queued queries are equal, the backend’s running
queries (the lowest count wins)</p></li>
</ul>
</li>
</ol>
<p>This makes routing user-aware. When you submit a query, the algorithm routes
it to the backend where it’s likely to start executing soonest. This balances
query load across backends and optimizes for your individual query latency.</p>
<p>After selecting a backend, the router updates a local view of stats:</p>
<ul class="simple">
<li><p>If there are already queued queries on the selected backend, the router
increments your queued query count for that backend</p></li>
<li><p>Otherwise, the router increments the backend’s running query count.</p></li>
</ul>
<p>The router’s local adjustments to the usage statistics help it make informed,
balanced decisions in real-time between the periodic stats refreshes it receives
from the configured monitor.</p>
</section>
<section id="user-queue-awareness-and-monitor-support">
<h4 id="user-queue-awareness-and-monitor-support">User queue awareness and monitor support<a class="headerlink" href="#user-queue-awareness-and-monitor-support" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">UI_API</span></code> monitor is the only monitor type that provides per-user queue
information. When you set <code class="docutils literal notranslate"><span class="pre">clusterStatsConfiguration.monitorType</span></code> to <code class="docutils literal notranslate"><span class="pre">UI_API</span></code>,
the router receives a <code class="docutils literal notranslate"><span class="pre">userQueuedCount</span></code> map for each backend. This map
associates each user with their number of queued queries on that backend. The
<code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouter</span></code> algorithm uses this information to prioritize the
backend where the requesting user has the fewest queued queries, minimizing
their wait time.</p>
<p>If you configure a different monitor type (<code class="docutils literal notranslate"><span class="pre">INFO_API</span></code>, <code class="docutils literal notranslate"><span class="pre">JDBC</span></code>, <code class="docutils literal notranslate"><span class="pre">JMX</span></code>, <code class="docutils literal notranslate"><span class="pre">METRICS</span></code>,
or <code class="docutils literal notranslate"><span class="pre">NOOP</span></code>), the router does not receive per-user queue information. In this
case, the <code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouter</span></code> falls back to cluster-level metrics and
selects the backend with:</p>
<ol class="arabic simple">
<li><p>The lowest total number of queued queries across all users</p></li>
<li><p>If two or more queued query counts are equal, the lowest total number of running
queries across all users</p></li>
</ol>
</section>
</section>
<section id="logging">
<h3 id="logging">Logging <a name="logging"><a class="headerlink" href="#logging" title="Link to this heading">#</a></a></h3>
<p>To configure the logging level for classes, specify the path to the
<code class="docutils literal notranslate"><span class="pre">log.properties</span></code> file by using <code class="docutils literal notranslate"><span class="pre">log.levels-file</span></code> in <code class="docutils literal notranslate"><span class="pre">serverConfig</span></code>.</p>
<p>For additional configurations, use the <code class="docutils literal notranslate"><span class="pre">log.*</span></code> properties from the <a class="reference internal" href="../properties-logging.html"><span class="doc">logging properties documentation</span></a> and specify the properties
in <code class="docutils literal notranslate"><span class="pre">serverConfig</span></code>.</p>
</section>
<section id="additional-statement-paths">
<h3 id="additional-statement-paths">Additional statement paths<a class="headerlink" href="#additional-statement-paths" title="Link to this heading">#</a></h3>
<p>The SEP client protocol initiates queries with a <code class="docutils literal notranslate"><span class="pre">POST</span></code> to <code class="docutils literal notranslate"><span class="pre">v1/statement</span></code>.
Starburst Gateway incorporates this into its routing logic by extracting and
recording the query ID from responses to these requests.</p>
<p>Starburst Gateway automatically supports standard SEP paths including <code class="docutils literal notranslate"><span class="pre">/v1</span></code>,
<code class="docutils literal notranslate"><span class="pre">/ui</span></code>, <code class="docutils literal notranslate"><span class="pre">/api/v1</span></code>, <code class="docutils literal notranslate"><span class="pre">/api/openapi</span></code>, and <code class="docutils literal notranslate"><span class="pre">/oauth2</span></code>.</p>
<p>If you use a build of SEP that supports additional endpoints, configure
Starburst Gateway to treat them like <code class="docutils literal notranslate"><span class="pre">/v1/statement</span></code> by adding them under
<code class="docutils literal notranslate"><span class="pre">additionalStatementPaths</span></code>. The standard <code class="docutils literal notranslate"><span class="pre">/v1/statement</span></code> path is always
included:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalStatementPaths</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'/ui/api/insights/ide/statement'</span>
</pre></div>
</div>
</section>
<section id="load-balancer">
<h3 id="load-balancer">Load balancer<a class="headerlink" href="#load-balancer" title="Link to this heading">#</a></h3>
<p>To deploy multiple instances of Starburst Gateway behind a generic load balancer,
you must the <code class="docutils literal notranslate"><span class="pre">serverConfig</span></code> to enable process forwarded HTTP headers:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">serverConfig</span><span class="p">:</span>
<span class="w">  </span><span class="nt">http-server.process-forwarded</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="proxy-response-size">
<h3 id="proxy-response-size">Proxy response size<a class="headerlink" href="#proxy-response-size" title="Link to this heading">#</a></h3>
<p>Starburst Gateway reads responses from SEP in bytes (up to 32MB by default).
To configure a larger size, set the following configuration property:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">proxyResponseConfiguration</span><span class="p">:</span>
<span class="w">  </span><span class="nt">responseSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50MB</span>
</pre></div>
</div>
</section>
</section>
<section id="deploy-gateway-using-starburst-portal">
<span id="gateway-helm"></span><h2 id="deploy-gateway-using-starburst-portal">Deploy Gateway using Starburst Portal<a class="headerlink" href="#deploy-gateway-using-starburst-portal" title="Link to this heading">#</a></h2>
<p>Use the following steps to deploy Starburst Gateway on Kubernetes with Helm.</p>
<section id="access-the-helm-chart">
<h3 id="access-the-helm-chart">Access the Helm Chart<a class="headerlink" href="#access-the-helm-chart" title="Link to this heading">#</a></h3>
<p>The Starburst Portal Helm chart is available in the <a class="reference external" href="https://harbor.starburstdata.net/">Starburst Helm chart
project</a>. It contains both Starburst Gateway and
Starburst data catalog.</p>
<p>Use the following commands to access the chart:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>helm<span class="w"> </span>registry<span class="w"> </span>login<span class="w"> </span>harbor.starburstdata.net/starburstdata
<span class="c1"># Enter your credentials</span>
helm<span class="w"> </span>pull<span class="w"> </span>oci://harbor.starburstdata.net/starburstdata/charts/starburst-portal<span class="w"> </span>--version<span class="w"> </span>&lt;version&gt;
</pre></div>
</div>
</section>
<section id="create-a-secret">
<h3 id="create-a-secret">Create a secret<a class="headerlink" href="#create-a-secret" title="Link to this heading">#</a></h3>
<p>Use the following command to create a secret for Harbor registry authentication:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>docker-registry<span class="w"> </span>harbor-auth<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--docker-server<span class="o">=</span>harbor.starburstdata.net<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--docker-username<span class="o">=</span>&lt;your-username&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--docker-password<span class="o">=</span>&lt;your-password&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--docker-email<span class="o">=</span>&lt;your-email&gt;
</pre></div>
</div>
</section>
<section id="deploy-a-postgresql-database">
<h3 id="deploy-a-postgresql-database">Deploy a PostgreSQL database<a class="headerlink" href="#deploy-a-postgresql-database" title="Link to this heading">#</a></h3>
<p>Use the following command to create a PostgreSQL pod:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>val-posgres.yaml
</pre></div>
</div>
</section>
<section id="install-starburst-gateway">
<h3 id="install-starburst-gateway">Install Starburst Gateway<a class="headerlink" href="#install-starburst-gateway" title="Link to this heading">#</a></h3>
<p>Use the following command to install Starburst Gateway via the Portal chart:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>helm<span class="w"> </span>upgrade<span class="w"> </span>--install<span class="w"> </span>starburst-portal<span class="w"> </span>starburst-portal-&lt;version&gt;.tgz<span class="w"> </span>-f<span class="w"> </span>gateway-config.yaml
</pre></div>
</div>
</section>
<section id="enable-starburst-gateway">
<h3 id="enable-starburst-gateway">Enable Starburst Gateway<a class="headerlink" href="#enable-starburst-gateway" title="Link to this heading">#</a></h3>
<p>By default, Starburst Gateway is disabled in the Portal deployment.</p>
<p>To enable it:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">gateway.enabled=true</span>
<span class="l l-Scalar l-Scalar-Plain">gateway.config.file=config.yaml</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">values.yaml</span></code> file defines how Starburst Portal is configured during Helm
deployment. The following example shows a basic configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">etcFiles</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">node.environment=starburst_portal</span>
<span class="w">    </span><span class="no">http-server.http.port=8080</span>
<span class="w">    </span><span class="no">http-server.http.enabled=true</span>
<span class="w">    </span><span class="no">http-server.https.port=8443</span>
<span class="w">    </span><span class="no">http-server.https.enabled=false</span>
<span class="w">    </span><span class="no">credentials-provider.type=file</span>
<span class="w">    </span><span class="no">credentials-provider.credentials-file-path=/opt/starburst/etc/catalog-credentials.json</span>
<span class="w">    </span><span class="no">persistence.database.url=jdbc:postgresql://postgresql:5432/&lt;db/schema name&gt;</span>
<span class="w">    </span><span class="no">persistence.database.user=&lt;db username&gt;</span>
<span class="w">    </span><span class="no">persistence.database.password=&lt;db password&gt;</span>
</pre></div>
</div>
</section>
<section id="access-the-gateway-ui">
<h3 id="access-the-gateway-ui">Access the Gateway UI<a class="headerlink" href="#access-the-gateway-ui" title="Link to this heading">#</a></h3>
<p>User the following command to access the Starburst Gateway UI:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>port-forward<span class="w"> </span>service/starburst-gateway<span class="w"> </span><span class="m">8080</span>:8080
</pre></div>
</div>
<p>Access the UI at http://localhost:8080.</p>
</section>
<section id="configure-routing-rules">
<h3 id="configure-routing-rules">Configure routing rules<a class="headerlink" href="#configure-routing-rules" title="Link to this heading">#</a></h3>
<p>To implement static routing rules, create a <code class="docutils literal notranslate"><span class="pre">configMap</span></code> from your routing rules
YAML definition:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>create<span class="w"> </span>cm<span class="w"> </span>routing-rules<span class="w"> </span>--from-file<span class="w"> </span>your-routing-rules.yaml
</pre></div>
</div>
<p>Then mount it to your container:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
<span class="w">      </span><span class="nt">configMap</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
<span class="w">          </span><span class="nt">items</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>
<span class="w">              </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>

<span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
<span class="w">      </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s">"/etc/routing-rules/your-routing-rules.yaml"</span>
<span class="w">      </span><span class="nt">subPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>
</pre></div>
</div>
<p>Ensure the <code class="docutils literal notranslate"><span class="pre">mountPath</span></code> matches the <code class="docutils literal notranslate"><span class="pre">rulesConfigPath</span></code> you specify in your
configuration. The <code class="docutils literal notranslate"><span class="pre">subPath</span></code> is optional. Without the <code class="docutils literal notranslate"><span class="pre">subPath</span></code>, the file
mounts at <code class="docutils literal notranslate"><span class="pre">mountPath/&lt;configMap</span> <span class="pre">key&gt;</span></code>.</p>
<p>Standard Helm options such as <code class="docutils literal notranslate"><span class="pre">replicaCount</span></code>, <code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">imagePullSecrets</span></code>,
<code class="docutils literal notranslate"><span class="pre">service</span></code>, <code class="docutils literal notranslate"><span class="pre">ingress</span></code> and <code class="docutils literal notranslate"><span class="pre">resources</span></code> are supported in <code class="docutils literal notranslate"><span class="pre">helm/values.yaml</span></code>.</p>
</section>
</section>
<section id="health-checks">
<h2 id="health-checks">Health checks<a class="headerlink" href="#health-checks" title="Link to this heading">#</a></h2>
<p>Starburst Gateway periodically performs health checks and maintains an in-memory
health status for each backend. When a backend fails a health check, the Gateway
marks it as <code class="docutils literal notranslate"><span class="pre">UNHEALTHY</span></code> and stops routing requests to it.</p>
<p>The health status differs from the active/inactive state of a backend. The
active/inactive state indicates whether a backend is on or off, while health
status is determined programmatically by the health check process. Health checks
only run on active backends.</p>
<p>Starburst recommends using either <code class="docutils literal notranslate"><span class="pre">INFO_API</span></code> or <code class="docutils literal notranslate"><span class="pre">METRICS</span></code> for your health check.
Other options may be deprecated in the future.</p>
<p>For more details, see the <a class="reference internal" href="routing-rules.html#gateway-healthstatus"><span class="std std-ref">health status</span></a> section.</p>
<p>To select the type of health check, set the following configuration property:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">clusterStatsConfiguration</span><span class="p">:</span>
<span class="w">  </span><span class="nt">monitorType</span><span class="p">:</span><span class="w"> </span><span class="s">""</span>
</pre></div>
</div>
<p>Choose from the following health check types.</p>
<section id="info-api-default">
<h3 id="info-api-default">INFO_API (default)<a class="headerlink" href="#info-api-default" title="Link to this heading">#</a></h3>
<p>By default, Starburst Gateway uses the <code class="docutils literal notranslate"><span class="pre">v1/info</span></code> REST endpoint. A successful
requires a <code class="docutils literal notranslate"><span class="pre">200</span></code> response with <code class="docutils literal notranslate"><span class="pre">starting:</span> <span class="pre">false</span></code>. Configure connection timeout
parameters through the <code class="docutils literal notranslate"><span class="pre">monitor</span></code> node:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
<span class="w">  </span><span class="nt">connectTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">requestTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">idleTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>All timeout parameters are optional.</p>
</section>
<section id="metrics">
<h3 id="metrics">METRICS<a class="headerlink" href="#metrics" title="Link to this heading">#</a></h3>
<p>This method pulls statistics from the <a class="reference external" href="https://openmetrics.io/">OpenMetrics</a>
endpoint and retrieves the number of running and queued queries for use with
<code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouter</span></code>.</p>
<p>You must enable either <code class="docutils literal notranslate"><span class="pre">METRICS</span></code> or <code class="docutils literal notranslate"><span class="pre">JDBC</span></code> if you use <code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouter</span></code>.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">METRICS</span></code> uses <code class="docutils literal notranslate"><span class="pre">trino_execution_name_QueryManager_RunningQueries</span></code>
and <code class="docutils literal notranslate"><span class="pre">trino_execution_name_QueryManager_QueuedQueries</span></code> to track the number of
running and queued queries. See the following example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runningQueriesMetricName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">io_starburst_galaxy_name_GalaxyMetrics_RunningQueries</span>
<span class="w">    </span><span class="nt">queuedQueriesMetricName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">io_starburst_galaxy_name_GalaxyMetrics_QueuedQueries</span>
</pre></div>
</div>
<p>By default the monitor pulls metrics using the <code class="docutils literal notranslate"><span class="pre">/metrics</span></code> endpoint. To configure
an alternative endpoint, use the <code class="docutils literal notranslate"><span class="pre">metricsEndpoint</span></code> property.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metricsEndpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/v1/metrics</span>
</pre></div>
</div>
<p>This monitor supports custom health definitions by comparing metrics using two
maps: <code class="docutils literal notranslate"><span class="pre">metricMinimumValues</span></code> and <code class="docutils literal notranslate"><span class="pre">metricMaximumValues</span></code>. The keys metric names,
and the values are minimum or maximum values (inclusive) considered healthy. By
default, the only metric populated is
<code class="docutils literal notranslate"><span class="pre">trino_node_name_CoordinatorNodeManager_ActiveNodeCount</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metricMinimumValues</span><span class="p">:</span>
<span class="w">        </span><span class="nt">trino_node_name_CoordinatorNodeManager_ActiveNodeCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>For the cluster to be considered healthy, one worker node must be active. To
increase the minimum worker count to <code class="docutils literal notranslate"><span class="pre">10</span></code> and disqualify clusters experiencing
frequent major garbage collections, set the following configuration properties:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metricMinimumValues</span><span class="p">:</span>
<span class="w">        </span><span class="nt">trino_node_name_CoordinatorNodeManager_ActiveNodeCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">metricMaximumValues</span><span class="p">:</span>
<span class="w">        </span><span class="nt">io_airlift_stats_name_GcMonitor_MajorGc_FiveMinutes_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</pre></div>
</div>
</section>
<section id="jdbc">
<h3 id="jdbc">JDBC<a class="headerlink" href="#jdbc" title="Link to this heading">#</a></h3>
<p>This method uses a JDBC connection to query <code class="docutils literal notranslate"><span class="pre">system.runtime</span></code> tables for cluster
information. It is required for the query count-based routing strategy.</p>
<p>This method is recommended over <code class="docutils literal notranslate"><span class="pre">UI_API</span></code> since it does not restrict the
Starburst Enterprise web UI authentication method of backend clusters.</p>
<p>Configure a username and password by adding <code class="docutils literal notranslate"><span class="pre">backendState</span></code> to your
configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">backendState</span><span class="p">:</span>
<span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">"user"</span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">"password"</span>
</pre></div>
</div>
<p>The credentials must be valid across all backends.</p>
<p>Starburst Gateway uses <code class="docutils literal notranslate"><span class="pre">explicitPrepare=false</span></code> by default. This property uses a
single query for prepared statements instead of a <code class="docutils literal notranslate"><span class="pre">PREPARE/EXECUTE</span></code> pair. If you
are using the JDBC health check option with older versions of Trino, set the
following configuration property:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
<span class="w">   </span><span class="nt">explicitPrepare</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>To set the query timeout, set the following configuration property:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">queryTimeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</pre></div>
</div>
<p>Other timeout parameters do not apply to the JDBC connection.</p>
</section>
<section id="jmx">
<h3 id="jmx">JMX<a class="headerlink" href="#jmx" title="Link to this heading">#</a></h3>
<p>The method collects cluster information, required for
<code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouterProvider</span></code> using the <code class="docutils literal notranslate"><span class="pre">v1/jmx/mbean</span></code> endpoint on clusters.</p>
<p>To enable JMX monitoring, complete the following steps:</p>
<ol class="arabic simple">
<li><p>Activate <a class="reference internal" href="../jmx.html"><span class="doc">JMX monitoring</span></a> on all Trino clusters:</p></li>
</ol>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">jmx.rmiregistry.port</span><span class="o">=</span><span class="s">&lt;port&gt;</span>
<span class="na">jmx.rmiserver.port</span><span class="o">=</span><span class="s">&lt;port&gt;</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Allow JMX endpoint access by adding rules to your <a class="reference external" href="https://trino.io/docs/current/security/file-system-access-control.html">file-based access
control</a>
configuration:</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">"catalogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"catalog"</span><span class="p">:</span><span class="w"> </span><span class="s2">"system"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"allow"</span><span class="p">:</span><span class="w"> </span><span class="s2">"read-only"</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">"system_information"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span>
<span class="w">      </span><span class="nt">"allow"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"read"</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Configure a username and password in the the <code class="docutils literal notranslate"><span class="pre">backendState</span></code> section:</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">backendState</span><span class="p">:</span>
<span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">"user"</span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">"password"</span>
</pre></div>
</div>
<p>The credentials must be consistent across all backend clusters and have <code class="docutils literal notranslate"><span class="pre">read</span></code>
rights on <code class="docutils literal notranslate"><span class="pre">system_information</span></code>. The JMX monitor uses these credentials to
authenticate against the JMX endpoint of each cluster and collect metrics like
running queries, queued queries, and worker nodes information.</p>
</section>
<section id="ui-api">
<h3 id="ui-api">UI_API<a class="headerlink" href="#ui-api" title="Link to this heading">#</a></h3>
<p>This method pulls cluster information from the <code class="docutils literal notranslate"><span class="pre">ui/api/stats</span></code> REST endpoint. It
only works with backend clusters using <code class="docutils literal notranslate"><span class="pre">web-ui.authentication.type=FORM</span></code>. Set a
username and password using <code class="docutils literal notranslate"><span class="pre">backendState</span></code> as with the <code class="docutils literal notranslate"><span class="pre">JDBC</span></code> option.</p>
</section>
<section id="noop">
<h3 id="noop">NOOP<a class="headerlink" href="#noop" title="Link to this heading">#</a></h3>
<p>This option disables health checks.</p>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
<div class="md-grid md-main__inner" style="height: auto;">
  <div class="md-content">
    <div class="feedback-container md-content__inner md-typeset">
      <div class="feedback-thumbs">
        <p>Is the information on this page helpful?</p>
        <p class="feedback-option" title="yes">Yes</p>
        <p class="feedback-option" title="no">No</p>
      </div>
      <div class="feedback-message">
        <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
        <button type="button" onclick="sendMessage()" class="feedback-button">Email</button>
        <a onclick="skip()" class="feedback-skip">Cancel</a>
      </div>
    </div>
  </div>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '');
</script>
<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="index.html" title="Starburst Gateway"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Starburst Gateway </span>
              </div>
            </a>
          
          
            <a href="gateway-api.html" title="Gateway API"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Gateway API </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
<!-- custom footer should go here in time -->
<div class="page-footer">
  <div class="container md-grid">
    <div class="row">
      <div class="col-md-3">
        <p style="font-weight:900">Resources</p>
        <ul>
          <li class="footer-item"><a href="https://docs.starburst.io/latest/index.html">Starburst Enterprise reference documentation</a></li>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/starburst-intro-and-demo/" target="_blank">Join our weekly demos</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#!" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">

        <a href="https://www.starburst.io/" target="_blank">
          <img src="../../_static/img/Starburst_Logo_White+Blue.svg" height="34"
            alt="Starburst Enterprise 478-e STS logo">
        </a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2025<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
  </div>
</div>
<script src="https://docs.starburst.io/478-e/_static/algolia.js"></script>
<script src="https://docs.starburst.io/478-e/_static/searchbox.js" data-versions="{'Latest LTS (477-e)': '/477-e/', '476-e LTS': '/476-e/', '474-e LTS': '/474-e/', '468-e LTS': '/468-e/', 'Latest STS (478-e)': '/478-e/'}"></script>
<script src="https://docs.starburst.io/478-e/_static/searchresults.js" data-versions="{'Latest LTS (477-e)': '/477-e/', '476-e LTS': '/476-e/', '474-e LTS': '/474-e/', '468-e LTS': '/468-e/', 'Latest STS (478-e)': '/478-e/'}"></script>
  </body>
</html>