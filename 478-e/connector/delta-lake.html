
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CY10FQPGJS"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-CY10FQPGJS');
</script>
  
  
    <title>Delta Lake connector &#8212; Starburst Enterprise</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=bbebba6e" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/algolia.css?v=0e0f969e" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css?v=c0e612e9" />
    <link rel="stylesheet" type="text/css" href="../_static/search.css?v=87ff3654" />
    <link rel="stylesheet" type="text/css" href="../_static/sidebar.css?v=7da5440c" />
    <script src="../_static/documentation_options.js?v=a68ab161"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=e378d701"></script>
    <script src="../_static/main.js?v=45c62a64"></script>
    <script src="../_static/heap_analytics.js?v=eba036f6"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hive connector" href="hive.html" />
    <link rel="prev" title="Object storage connectors" href="../object-storage-connectors.html" />

  
   

<link href="https://fonts.googleapis.com/css2?family=Barlow&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" >


<!-- Always link to the latest version, as canonical -->
<link rel="canonical" href="https://docs.starburst.io/latest/connector/delta-lake.html">

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#connector/delta-lake" tabindex="1" class="md-skip"> Skip to content </a>
  
<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.starburst.io" title="Starburst Enterprise"
          class="md-header-nav__button md-logo">
            <img src="../_static/img/Starburst_Logo_White+Blue.svg"
              alt="Starburst Enterprise 478-e STS logo">
        </a>
      </div>
      <span class="header-divider"></span>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <a href="/starburst-enterprise/index.html"
          class="md-header-nav__topic">
          Documentation: Starburst Enterprise 478-e STS</a>
          <span class="md-header-nav__topic"> Delta Lake connector </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        <div id="algolia-search">
  <div id="searchbox"></div>
  <div id="product-list">
    <h6 class="filter-label">Product:</h6>
  </div>
  <div id="versionsRefinementList" id="version-list" style="display:none"></div>
  <div id="hits"></div>
  <div id="stats"></div>
</div>
      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (477-e)" href="/477-e/">Latest LTS (477-e)</a>
      
          <a title="476-e LTS" href="/476-e/">476-e LTS</a>
      
          <a title="474-e LTS" href="/474-e/">474-e LTS</a>
      
          <a title="468-e LTS" href="/468-e/">468-e LTS</a>
      
          <a title="Latest STS (478-e)" href="/478-e/">Latest STS (478-e)</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="/introduction/index.html" class="md-tabs__link">Introduction</a></li>
            
            <li class="md-tabs__item"><a href="/clients/index.html" class="md-tabs__link">Clients</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-galaxy/index.html" class="md-tabs__link">Starburst Galaxy</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-enterprise/index.html" class="md-tabs__link">Starburst Enterprise</a></li>
            
            <li class="md-tabs__item"><a href="/resources.html" class="md-tabs__link">Resources</a></li>
          <li class="md-tabs__item"><a href="../object-storage-connectors.html" class="md-tabs__link">Object storage connectors</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise">Starburst Enterprise 478-e STS</a>
  </label>
  
  
  <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get-started/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/starburst-enterprise.html">What is Starburst Enterprise?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/try/try-sep.html">Try Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learn/index.html">Learn Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Product versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.starburst.io/support.html">Get support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For all users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/sep-ui.html">Starburst Enterprise web UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starburst-ai/index.html">Starburst AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-products.html">Data products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../insights.html">Insights</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use SQL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language.html">SQL language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">SQL statement syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">Functions and operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../udf.html">User-defined functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For data engineers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../catalogs.html">Define catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object-storage.html">Object storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-engineering/materialized-views.html">Materialized views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-engineering/data-maintenance.html">Data maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">Query optimizer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Connect to data sources</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../connector.html">Connector overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../object-storage-connectors.html">Object storage connectors</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../object-storage-connectors.html#id1">Object storage connectors</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Delta Lake connector</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extensions">Extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#general-configuration-properties">General configuration properties</a></li>
<li class="toctree-l5"><a class="reference internal" href="#catalog-session-properties">Catalog session properties</a></li>
<li class="toctree-l5"><a class="reference internal" href="#fault-tolerant-execution-support">Fault-tolerant execution support</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#file-system-access-configuration">File system access configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#type-mapping">Type mapping</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#delta-lake-to-trino-type-mapping">Delta Lake to Trino type mapping</a></li>
<li class="toctree-l5"><a class="reference internal" href="#trino-to-delta-lake-type-mapping">Trino to Delta Lake type mapping</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#delta-lake-table-features">Delta Lake table features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sql-support">SQL support</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#time-travel-queries">Time travel queries</a></li>
<li class="toctree-l5"><a class="reference internal" href="#procedures">Procedures</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#register-table">Register table</a></li>
<li class="toctree-l6"><a class="reference internal" href="#unregister-table">Unregister table</a></li>
<li class="toctree-l6"><a class="reference internal" href="#flush-metadata-cache">Flush metadata cache</a></li>
<li class="toctree-l6"><a class="reference internal" href="#vacuum"><code class="docutils literal notranslate"><span class="pre">VACUUM</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#data-management">Data management</a></li>
<li class="toctree-l5"><a class="reference internal" href="#schema-and-table-management">Schema and table management</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#schema-evolution">Schema evolution</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#replacing-tables">Replacing tables</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#alter-table-execute">ALTER TABLE EXECUTE</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#optimize">optimize</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#alter-table-rename-to">ALTER TABLE RENAME TO</a></li>
<li class="toctree-l6"><a class="reference internal" href="#table-properties">Table properties</a></li>
<li class="toctree-l6"><a class="reference internal" href="#shallow-cloned-tables">Shallow cloned tables</a></li>
<li class="toctree-l6"><a class="reference internal" href="#metadata-tables">Metadata tables</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#history-table"><code class="docutils literal notranslate"><span class="pre">$history</span></code> table</a></li>
<li class="toctree-l7"><a class="reference internal" href="#partitions-table"><code class="docutils literal notranslate"><span class="pre">$partitions</span></code> table</a></li>
<li class="toctree-l7"><a class="reference internal" href="#properties-table"><code class="docutils literal notranslate"><span class="pre">$properties</span></code> table</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#metadata-columns">Metadata columns</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#table-functions">Table functions</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#table-changes">table_changes</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#sql-security">SQL security</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#performance">Performance</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#table-statistics">Table statistics</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#fine-tuning">Fine-tuning</a></li>
<li class="toctree-l6"><a class="reference internal" href="#disable-and-drop-extended-statistics">Disable and drop extended statistics</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#memory-usage">Memory usage</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#memory-monitoring">Memory monitoring</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#table-redirection">Table redirection</a></li>
<li class="toctree-l5"><a class="reference internal" href="#performance-tuning-configuration-properties">Performance tuning configuration properties</a></li>
<li class="toctree-l5"><a class="reference internal" href="#file-system-cache">File system cache</a></li>
<li class="toctree-l5"><a class="reference internal" href="#dynamic-row-filtering">Dynamic row filtering</a></li>
<li class="toctree-l5"><a class="reference internal" href="#starburst-cached-views">Starburst Cached Views</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#security">Security</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#authorization-checks">Authorization checks</a></li>
<li class="toctree-l5"><a class="reference internal" href="#built-in-access-control">Built-in access control</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hive.html">Hive connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="hudi.html">Hudi connector</a></li>
<li class="toctree-l3"><a class="reference internal" href="iceberg.html">Iceberg connector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../object-storage-connectors.html#object-storage-extensions">Object storage extensions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../non-object-storage-connectors.html">Non-object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community-connectors.html">Community-supported connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starburst-catalog.html">Starburst catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="starburst-connectors.html">Starburst connectors feature matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-engineering/cost-and-performance/index.html">Monitor and manage cost and performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For platform administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-topics.html">Administration topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">Performance, logging, and governance features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starburst-rest-api.html">Starburst Enterprise REST API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deploy in cloud ecosystems</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/aws/index.html">AWS ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/google/index.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/microsoft/index.html">Microsoft Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystems/redhat/index.html">Red Hat OpenShift</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SEP deployment mechanisms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license-requirements.html">Starburst Enterprise license</a></li>
<li class="toctree-l1"><a class="reference internal" href="../k8s.html">Deploy with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starburst-admin.html">Deploy with Starburst Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">Deploy with CFT on AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Local installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">Trino developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Version-specific notices and information</a></li>
</ul>
  
  
</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
  <div class="local-toc">
    <strong>Contents</strong>
    <ul>
<li><a class="reference internal" href="#">Delta Lake connector</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#extensions">Extensions</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#general-configuration-properties">General configuration properties</a></li>
<li><a class="reference internal" href="#catalog-session-properties">Catalog session properties</a></li>
<li><a class="reference internal" href="#fault-tolerant-execution-support">Fault-tolerant execution support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#file-system-access-configuration">File system access configuration</a></li>
<li><a class="reference internal" href="#type-mapping">Type mapping</a><ul>
<li><a class="reference internal" href="#delta-lake-to-trino-type-mapping">Delta Lake to Trino type mapping</a></li>
<li><a class="reference internal" href="#trino-to-delta-lake-type-mapping">Trino to Delta Lake type mapping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delta-lake-table-features">Delta Lake table features</a></li>
<li><a class="reference internal" href="#sql-support">SQL support</a><ul>
<li><a class="reference internal" href="#time-travel-queries">Time travel queries</a></li>
<li><a class="reference internal" href="#procedures">Procedures</a><ul>
<li><a class="reference internal" href="#register-table">Register table</a></li>
<li><a class="reference internal" href="#unregister-table">Unregister table</a></li>
<li><a class="reference internal" href="#flush-metadata-cache">Flush metadata cache</a></li>
<li><a class="reference internal" href="#vacuum"><code class="docutils literal notranslate"><span class="pre">VACUUM</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-management">Data management</a></li>
<li><a class="reference internal" href="#schema-and-table-management">Schema and table management</a><ul>
<li><a class="reference internal" href="#schema-evolution">Schema evolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#replacing-tables">Replacing tables</a><ul>
<li><a class="reference internal" href="#alter-table-execute">ALTER TABLE EXECUTE</a><ul>
<li><a class="reference internal" href="#optimize">optimize</a></li>
</ul>
</li>
<li><a class="reference internal" href="#alter-table-rename-to">ALTER TABLE RENAME TO</a></li>
<li><a class="reference internal" href="#table-properties">Table properties</a></li>
<li><a class="reference internal" href="#shallow-cloned-tables">Shallow cloned tables</a></li>
<li><a class="reference internal" href="#metadata-tables">Metadata tables</a><ul>
<li><a class="reference internal" href="#history-table"><code class="docutils literal notranslate"><span class="pre">$history</span></code> table</a></li>
<li><a class="reference internal" href="#partitions-table"><code class="docutils literal notranslate"><span class="pre">$partitions</span></code> table</a></li>
<li><a class="reference internal" href="#properties-table"><code class="docutils literal notranslate"><span class="pre">$properties</span></code> table</a></li>
</ul>
</li>
<li><a class="reference internal" href="#metadata-columns">Metadata columns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#table-functions">Table functions</a><ul>
<li><a class="reference internal" href="#table-changes">table_changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-security">SQL security</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance">Performance</a><ul>
<li><a class="reference internal" href="#table-statistics">Table statistics</a><ul>
<li><a class="reference internal" href="#fine-tuning">Fine-tuning</a></li>
<li><a class="reference internal" href="#disable-and-drop-extended-statistics">Disable and drop extended statistics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#memory-usage">Memory usage</a><ul>
<li><a class="reference internal" href="#memory-monitoring">Memory monitoring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#table-redirection">Table redirection</a></li>
<li><a class="reference internal" href="#performance-tuning-configuration-properties">Performance tuning configuration properties</a></li>
<li><a class="reference internal" href="#file-system-cache">File system cache</a></li>
<li><a class="reference internal" href="#dynamic-row-filtering">Dynamic row filtering</a></li>
<li><a class="reference internal" href="#starburst-cached-views">Starburst Cached Views</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security">Security</a><ul>
<li><a class="reference internal" href="#authorization-checks">Authorization checks</a></li>
<li><a class="reference internal" href="#built-in-access-control">Built-in access control</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>

              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="delta-lake-connector">
<h1 id="connector-delta-lake--page-root">Delta Lake connector<a class="headerlink" href="#connector-delta-lake--page-root" title="Link to this heading">#</a></h1>
<img class="connector-logo" src="../_static/img/delta-lake.png"/><p>The Delta Lake connector lets you query data stored in the <a class="reference external" href="https://delta.io">Delta
Lake</a> format, including <a class="reference external" href="https://docs.databricks.com/delta/index.html">Databricks Delta
Lake</a>. The connector can natively
read the Delta Lake transaction log and detect when external systems change
data.</p>
<p>SEP includes additional enterprise features that are built on top of the
existing Trino connector functionality. For more information on connector key
feature differences between Trino and SEP, see the <a class="reference internal" href="starburst-connectors.html#sb-connectors-object"><span class="std std-ref">connectors feature
matrix</span></a>.</p>
<section id="requirements">
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Link to this heading">#</a></h2>
<p>To connect to Databricks Delta Lake, you need:</p>
<ul class="simple">
<li><p>Tables written by Databricks Runtime 7.3 LTS, 9.1 LTS, 10.4 LTS, 11.3 LTS,
12.2 LTS, 13.3 LTS, 14.3 LTS, 15.4 LTS, and 16.4 LTS are supported.</p></li>
<li><p>Deployments using AWS, HDFS, Azure Storage, and Google Cloud Storage (GCS) are
fully supported.</p></li>
<li><p>Network access from the coordinator and workers to the Delta Lake storage.</p></li>
<li><p>Access to the Hive metastore service (HMS) of Delta Lake or a separate HMS,
or a Glue metastore.</p></li>
<li><p>Network access to the HMS from the coordinator and workers. Port 9083 is the
default port for the Thrift protocol used by the HMS.</p></li>
<li><p>Data files stored in the <a class="reference internal" href="../object-storage/file-formats.html#parquet-format-configuration"><span class="std std-ref">Parquet file format</span></a>
on a <a class="reference internal" href="#delta-lake-file-system-configuration"><span class="std std-ref">supported file system</span></a>.</p></li>
<li><p>A valid <a class="reference internal" href="../license-requirements.html"><span class="doc std std-doc">Starburst Enterprise license</span></a>.</p></li>
</ul>
</section>
<section id="extensions">
<h2 id="extensions">Extensions<a class="headerlink" href="#extensions" title="Link to this heading">#</a></h2>
<p>The connector includes all the features and integrations detailed in the
following section:</p>
<ul class="simple">
<li><p><a class="reference internal" href="starburst-ceph.html"><span class="doc std std-doc">Ceph storage support</span></a></p></li>
<li><p><a class="reference internal" href="starburst-dell-object-storage.html"><span class="doc std std-doc">Dell object storage support</span></a></p></li>
<li><p><a class="reference internal" href="starburst-minio.html"><span class="doc std std-doc">MinIO storage support</span></a></p></li>
<li><p><a class="reference internal" href="starburst-delta-lake-unity.html"><span class="doc std std-doc">Unity catalog with Delta Lake</span></a></p></li>
</ul>
</section>
<section id="configuration">
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h2>
<p>To configure the Delta Lake connector, create a catalog properties file that
specifies the Delta Lake connector by setting the <code class="docutils literal notranslate"><span class="pre">connector.name</span></code> to
<code class="docutils literal notranslate"><span class="pre">delta_lake</span></code>.</p>
<p>You must configure a <a class="reference internal" href="../object-storage/metastores.html"><span class="doc std std-doc">metastore for metadata</span></a>.</p>
<p>You must select and configure one of the <a class="reference internal" href="#delta-lake-file-system-configuration"><span class="std std-ref">supported file
systems</span></a>.</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">connector.name</span><span class="o">=</span><span class="s">delta_lake</span>
<span class="na">hive.metastore.uri</span><span class="o">=</span><span class="s">thrift://example.net:9083</span>
<span class="na">fs.x.enabled</span><span class="o">=</span><span class="s">true</span>
</pre></div>
</div>
<p>Replace the <code class="docutils literal notranslate"><span class="pre">fs.x.enabled</span></code> configuration property with the desired file system.</p>
<p>If you are using <a class="reference internal" href="../object-storage/metastores.html#hive-glue-metastore"><span class="std std-ref">AWS Glue</span></a> as your metastore, you must
instead set <code class="docutils literal notranslate"><span class="pre">hive.metastore</span></code> to <code class="docutils literal notranslate"><span class="pre">glue</span></code>:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">connector.name</span><span class="o">=</span><span class="s">delta_lake</span>
<span class="na">hive.metastore</span><span class="o">=</span><span class="s">glue</span>
</pre></div>
</div>
<p>Each metastore type has specific configuration properties along with <a class="reference internal" href="../object-storage/metastores.html#general-metastore-properties"><span class="std std-ref">general
metastore configuration properties</span></a>.</p>
<p>The connector recognizes Delta Lake tables created in the metastore by the
Databricks runtime. If non-Delta Lake tables are present in the metastore as
well, they are not visible to the connector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Delta Lake connector does not support reading from Databricks views.</p>
</div>
<section id="general-configuration-properties">
<h3 id="general-configuration-properties">General configuration properties<a class="headerlink" href="#general-configuration-properties" title="Link to this heading">#</a></h3>
<p>The following configuration properties are all using reasonable, tested default
values. Typical usage does not require you to configure them.</p>
<table>
<colgroup>
<col style="width: 30%"/>
<col style="width: 55%"/>
<col style="width: 15%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.metadata.cache-ttl</span></code></p></td>
<td><p>Caching duration for Delta Lake tables metadata.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">30m</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.metadata.cache-max-retained-size</span></code></p></td>
<td><p>Maximum retained size of Delta table metadata stored in cache. Must be
specified in <a class="reference internal" href="../admin/properties.html#prop-type-data-size"><span class="std std-ref">data size</span></a> values such as <code class="docutils literal notranslate"><span class="pre">64MB</span></code>. Default is
calculated to 5% of the maximum memory allocated to the JVM.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.metadata.live-files.cache-size</span></code></p></td>
<td><p>Amount of memory allocated for caching information about files. Must be
specified in <a class="reference internal" href="../admin/properties.html#prop-type-data-size"><span class="std std-ref">data size</span></a> values such as <code class="docutils literal notranslate"><span class="pre">64MB</span></code>. Default is
calculated to 10% of the maximum memory allocated to the JVM.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.metadata.live-files.cache-ttl</span></code></p></td>
<td><p>Caching duration for active files that correspond to the Delta Lake tables.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">30m</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.compression-codec</span></code></p></td>
<td><p>The compression codec to be used when writing new data files. Possible
values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NONE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNAPPY</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ZSTD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GZIP</span></code></p></li>
</ul>
<p>The equivalent catalog session property is <code class="docutils literal notranslate"><span class="pre">compression_codec</span></code>.</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">ZSTD</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.max-partitions-per-writer</span></code></p></td>
<td><p>Maximum number of partitions per writer.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.hide-non-delta-lake-tables</span></code></p></td>
<td><p>Hide information about tables that are not managed by Delta Lake. Hiding
only applies to tables with the metadata managed in a Glue catalog, and does
not apply to usage with a Hive metastore service.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.enable-non-concurrent-writes</span></code></p></td>
<td><p>Enable <a class="reference internal" href="#delta-lake-data-management"><span class="std std-ref">write support</span></a> for all supported file
systems. Specifically, take note of the warning about concurrency and
checkpoints.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.default-checkpoint-writing-interval</span></code></p></td>
<td><p>Default integer count to write transaction log checkpoint entries. If the
value is set to N, then checkpoints are written after every Nth statement
performing table writes. The value can be overridden for a specific table
with the <code class="docutils literal notranslate"><span class="pre">checkpoint_interval</span></code> table property.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.hive-catalog-name</span></code></p></td>
<td><p>Name of the catalog to which <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> queries are redirected when a
Hive table is detected.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.checkpoint-row-statistics-writing.enabled</span></code></p></td>
<td><p>Enable writing row statistics to checkpoint files.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.checkpoint-filtering.enabled</span></code></p></td>
<td><p>Enable pruning of data file entries as well as data file statistics columns
which are irrelevant for the query when reading Delta Lake checkpoint files.
Reading only the relevant active file data from the checkpoint, directly
from the storage, instead of relying on the active files caching, likely
results in decreased memory pressure on the coordinator. The equivalent
catalog session property is <code class="docutils literal notranslate"><span class="pre">checkpoint_filtering_enabled</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.dynamic-filtering.wait-timeout</span></code></p></td>
<td><p>Duration to wait for completion of <a class="reference internal" href="../admin/dynamic-filtering.html"><span class="doc std std-doc">dynamic
filtering</span></a> during split generation. The equivalent
catalog session property is <code class="docutils literal notranslate"><span class="pre">dynamic_filtering_wait_timeout</span></code>.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.table-statistics-enabled</span></code></p></td>
<td><p>Enables <a class="reference internal" href="#delta-lake-table-statistics"><span class="std std-ref">Table statistics</span></a> for performance
improvements. The equivalent catalog session property is
<code class="docutils literal notranslate"><span class="pre">statistics_enabled</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.extended-statistics.enabled</span></code></p></td>
<td><p>Enable statistics collection with <a class="reference internal" href="../sql/analyze.html"><span class="doc std std-doc">ANALYZE</span></a> and use of extended
statistics. The equivalent catalog session property is
<code class="docutils literal notranslate"><span class="pre">extended_statistics_enabled</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.extended-statistics.collect-on-write</span></code></p></td>
<td><p>Enable collection of extended statistics for write operations. The
equivalent catalog session property is
<code class="docutils literal notranslate"><span class="pre">extended_statistics_collect_on_write</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.per-transaction-metastore-cache-maximum-size</span></code></p></td>
<td><p>Maximum number of metastore data objects per transaction in the Hive
metastore cache.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.metastore.store-table-metadata</span></code></p></td>
<td><p>Store table comments and colum definitions in the metastore. The write
permission is required to update the metastore.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.metastore.store-table-metadata-threads</span></code></p></td>
<td><p>Number of threads used for storing table metadata in metastore.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.delete-schema-locations-fallback</span></code></p></td>
<td><p>Whether schema locations are deleted when Trino can’t determine whether they
contain external files.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.parquet.time-zone</span></code></p></td>
<td><p>Time zone for Parquet read and write.</p></td>
<td><p>JVM default</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.target-max-file-size</span></code></p></td>
<td><p>Target maximum size of written files; the actual size could be larger. The
equivalent catalog session property is <code class="docutils literal notranslate"><span class="pre">target_max_file_size</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1GB</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.unique-table-location</span></code></p></td>
<td><p>Use randomized, unique table locations.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.register-table-procedure.enabled</span></code></p></td>
<td><p>Enable to allow users to call the <a class="reference internal" href="#delta-lake-register-table"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">register_table</span></code>
procedure</span></a>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.vacuum.min-retention</span></code></p></td>
<td><p>Minimum retention threshold for the files taken into account for removal by
the <a class="reference internal" href="#delta-lake-vacuum"><span class="std std-ref">VACUUM</span></a> procedure. The equivalent catalog session
property is <code class="docutils literal notranslate"><span class="pre">vacuum_min_retention</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">DAYS</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.deletion-vectors-enabled</span></code></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">true</span></code> for enabling deletion vectors by default when creating new
tables.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.metadata.parallelism</span></code></p></td>
<td><p>Number of threads used for retrieving metadata. Currently, only table
loading is parallelized.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">8</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.checkpoint-processing.parallelism</span></code></p></td>
<td><p>Number of threads used for retrieving checkpoint files of each table.
Currently, only retrievals of V2 Checkpoint’s sidecar files are
parallelized.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="catalog-session-properties">
<h3 id="catalog-session-properties">Catalog session properties<a class="headerlink" href="#catalog-session-properties" title="Link to this heading">#</a></h3>
<p>The following table describes <a class="reference internal" href="../sql/set-session.html#session-properties-definition"><span class="std std-ref">catalog session
properties</span></a> supported by the Delta Lake
connector:</p>
<table id="id1">
<caption><span class="caption-text">Catalog session properties</span><a class="headerlink" href="#id1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 50%"/>
<col style="width: 17%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">parquet_max_read_block_size</span></code></p></td>
<td><p>The maximum block size used when reading Parquet files.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16MB</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">parquet_writer_block_size</span></code></p></td>
<td><p>The maximum block size created by the Parquet writer.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">128MB</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">parquet_writer_page_size</span></code></p></td>
<td><p>The maximum page size created by the Parquet writer.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1MB</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">parquet_writer_page_value_count</span></code></p></td>
<td><p>The maximum value count of pages created by the Parquet writer.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">60000</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">parquet_writer_batch_size</span></code></p></td>
<td><p>Maximum number of rows processed by the Parquet writer in a batch.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">projection_pushdown_enabled</span></code></p></td>
<td><p>Read only projected fields from row columns while performing <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>
queries.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="fault-tolerant-execution-support">
<span id="delta-lake-fte-support"></span><h3 id="fault-tolerant-execution-support">Fault-tolerant execution support<a class="headerlink" href="#fault-tolerant-execution-support" title="Link to this heading">#</a></h3>
<p>The connector supports <a class="reference internal" href="../admin/fault-tolerant-execution.html"><span class="doc std std-doc">Fault-tolerant execution</span></a> of query
processing. Read and write operations are both supported with any retry policy.</p>
</section>
</section>
<section id="file-system-access-configuration">
<span id="delta-lake-file-system-configuration"></span><h2 id="file-system-access-configuration">File system access configuration<a class="headerlink" href="#file-system-access-configuration" title="Link to this heading">#</a></h2>
<p>The connector supports accessing the following file systems:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../object-storage/file-system-azure.html"><span class="doc std std-doc">Azure Storage file system support</span></a></p></li>
<li><p><a class="reference internal" href="../object-storage/file-system-gcs.html"><span class="doc std std-doc">Google Cloud Storage file system support</span></a></p></li>
<li><p><a class="reference internal" href="../object-storage/file-system-s3.html"><span class="doc std std-doc">S3 file system support</span></a></p></li>
<li><p><a class="reference internal" href="../object-storage/file-system-hdfs.html"><span class="doc std std-doc">HDFS file system support</span></a></p></li>
</ul>
<p>You must enable and configure the specific file system access. <a class="reference internal" href="../object-storage.html#file-system-legacy"><span class="std std-ref">Legacy
support</span></a> is not recommended and will be removed.</p>
</section>
<section id="type-mapping">
<span id="delta-lake-type-mapping"></span><h2 id="type-mapping">Type mapping<a class="headerlink" href="#type-mapping" title="Link to this heading">#</a></h2>
<p>Because Trino and Delta Lake each support types that the other does not, this
connector <a class="reference internal" href="../language/types.html#type-mapping-overview"><span class="std std-ref">modifies some types</span></a> when reading or writing
data. Data types might not map the same way in both directions between Trino
and the data source. Refer to the following sections for type mapping in each
direction.</p>
<p>See the <a class="reference external" href="https://github.com/delta-io/delta/blob/master/PROTOCOL.md#primitive-types">Delta Transaction Log
specification</a>
for more information about supported data types in the Delta Lake table format
specification.</p>
<section id="delta-lake-to-trino-type-mapping">
<h3 id="delta-lake-to-trino-type-mapping">Delta Lake to Trino type mapping<a class="headerlink" href="#delta-lake-to-trino-type-mapping" title="Link to this heading">#</a></h3>
<p>The connector maps Delta Lake types to the corresponding Trino types following
this table:</p>
<table id="id2">
<caption><span class="caption-text">Delta Lake to Trino type mapping</span><a class="headerlink" href="#id2" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 40%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Delta Lake type</p></th>
<th class="head"><p>Trino type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BYTE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TINYINT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SHORT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LONG</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL(p,s)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL(p,s)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">STRING</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">BINARY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARBINARY</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMPNTZ</span></code> (<code class="docutils literal notranslate"><span class="pre">TIMESTAMP_NTZ</span></code>)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP(6)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP(3)</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">VARIANT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">JSON</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">STRUCT(...)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ROW(...)</span></code></p></td>
</tr>
</tbody>
</table>
<p>No other types are supported.</p>
</section>
<section id="trino-to-delta-lake-type-mapping">
<h3 id="trino-to-delta-lake-type-mapping">Trino to Delta Lake type mapping<a class="headerlink" href="#trino-to-delta-lake-type-mapping" title="Link to this heading">#</a></h3>
<p>The connector maps Trino types to the corresponding Delta Lake types following
this table:</p>
<table id="id3">
<caption><span class="caption-text">Trino to Delta Lake type mapping</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 60%"/>
<col style="width: 40%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Trino type</p></th>
<th class="head"><p>Delta Lake type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TINYINT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BYTE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SHORT</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LONG</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL(p,s)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL(p,s)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">STRING</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">VARBINARY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BINARY</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMPNTZ</span></code> (<code class="docutils literal notranslate"><span class="pre">TIMESTAMP_NTZ</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP(3)</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">JSON</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARIANT</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ROW(...)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">STRUCT(...)</span></code></p></td>
</tr>
</tbody>
</table>
<p>No other types are supported.</p>
</section>
</section>
<section id="delta-lake-table-features">
<h2 id="delta-lake-table-features">Delta Lake table features<a class="headerlink" href="#delta-lake-table-features" title="Link to this heading">#</a></h2>
<p>The connector supports the following <a class="reference external" href="https://github.com/delta-io/delta/blob/master/PROTOCOL.md#table-features">Delta Lake table
features</a>:</p>
<table>
<colgroup>
<col style="width: 70%"/>
<col style="width: 30%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Append-only tables</p></td>
<td><p>Writers only</p></td>
</tr>
<tr class="row-odd"><td><p>Column invariants</p></td>
<td><p>Writers only</p></td>
</tr>
<tr class="row-even"><td><p>CHECK constraints</p></td>
<td><p>Writers only</p></td>
</tr>
<tr class="row-odd"><td><p>Change data feed</p></td>
<td><p>Writers only</p></td>
</tr>
<tr class="row-even"><td><p>Column mapping</p></td>
<td><p>Readers and writers</p></td>
</tr>
<tr class="row-odd"><td><p>Deletion vectors</p></td>
<td><p>Readers and writers</p></td>
</tr>
<tr class="row-even"><td><p>Iceberg compatibility V1 &amp; V2</p></td>
<td><p>Readers only</p></td>
</tr>
<tr class="row-odd"><td><p>Invariants</p></td>
<td><p>Writers only</p></td>
</tr>
<tr class="row-even"><td><p>Timestamp without time zone</p></td>
<td><p>Readers and writers</p></td>
</tr>
<tr class="row-odd"><td><p>Type widening</p></td>
<td><p>Readers only</p></td>
</tr>
<tr class="row-even"><td><p>Vacuum protocol check</p></td>
<td><p>Readers and writers</p></td>
</tr>
<tr class="row-odd"><td><p>V2 checkpoint</p></td>
<td><p>Readers only</p></td>
</tr>
</tbody>
</table>
<p>No other features are supported.</p>
</section>
<section id="sql-support">
<span id="delta-lake-sql-support"></span><h2 id="sql-support">SQL support<a class="headerlink" href="#sql-support" title="Link to this heading">#</a></h2>
<p>The connector provides read and write access to data and metadata in Delta Lake.
In addition to the <a class="reference internal" href="../language/sql-support.html#sql-globally-available"><span class="std std-ref">globally available</span></a> and <a class="reference internal" href="../language/sql-support.html#sql-read-operations"><span class="std std-ref">read
operation</span></a> statements, the connector supports the following
features:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../language/sql-support.html#sql-write-operations"><span class="std std-ref">Write operations</span></a>:</p>
<ul>
<li><p><a class="reference internal" href="../language/sql-support.html#sql-data-management"><span class="std std-ref">Data management</span></a>, see details for <a class="reference internal" href="#delta-lake-data-management"><span class="std std-ref">Delta Lake data
management</span></a></p></li>
<li><p><a class="reference internal" href="../language/sql-support.html#sql-schema-table-management"><span class="std std-ref">Schema and table management</span></a>, see details for <a class="reference internal" href="#delta-lake-schema-table-management"><span class="std std-ref">Delta Lake schema and
table management</span></a></p></li>
<li><p><a class="reference internal" href="../language/sql-support.html#sql-view-management"><span class="std std-ref">View management</span></a></p></li>
<li><p><a class="reference internal" href="../language/sql-support.html#sql-security-operations"><span class="std std-ref">Security operations</span></a>, see also <a class="reference internal" href="#delta-lake-sql-security"><span class="std std-ref">SQL security</span></a></p></li>
<li><p>Table replacement, see <a class="reference internal" href="#delta-lake-create-or-replace"><span class="std std-ref">Replacing tables</span></a></p></li>
</ul>
</li>
</ul>
<section id="time-travel-queries">
<span id="delta-time-travel"></span><h3 id="time-travel-queries">Time travel queries<a class="headerlink" href="#time-travel-queries" title="Link to this heading">#</a></h3>
<p>The connector offers the ability to query historical data. This allows to
query the table as it was when a previous snapshot of the table was taken, even
if the data has since been modified or deleted.</p>
<p>The historical data of the table can be retrieved by specifying the version
number corresponding to the version of the table to be retrieved:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="n">customer_orders</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">VERSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="mi">3</span>
</pre></div>
</div>
<p>A different approach of retrieving historical data is to specify a point in
time, such as a day or week ago. The latest snapshot of the table taken before
or at the specified timestamp in the query is internally used for providing the
previous state of the table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="n">customer_orders</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">'2022-03-23 09:59:29.803 America/Los_Angeles'</span><span class="p">;</span>
</pre></div>
</div>
<p>Create a new snapshot through Delta Lake’s <a class="reference internal" href="#delta-lake-create-or-replace"><span class="std std-ref">replace
table</span></a>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="n">customer_orders</span><span class="w"> </span><span class="k">AS</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="n">customer_orders</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">'2022-03-23 09:59:29.803 America/Los_Angeles'</span><span class="p">;</span>
</pre></div>
</div>
<p>You can use a date to specify a point a time in the past for using a snapshot of
a table in a query. Assuming that the session time zone is <code class="docutils literal notranslate"><span class="pre">America/Los_Angeles</span></code>
the following queries are equivalent:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="n">customer_orders</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="s1">'2022-03-23'</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="n">customer_orders</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">'2022-03-23 00:00:00'</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="n">customer_orders</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">'2022-03-23 00:00:00.000 America/Los_Angeles'</span><span class="p">;</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">$history</span></code> metadata table to determine the snapshot ID of the
table like in the following query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">version</span><span class="p">,</span><span class="w"> </span><span class="k">operation</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">testdb</span><span class="p">.</span><span class="ss">"customer_orders$history"</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">version</span><span class="w"> </span><span class="k">DESC</span>
</pre></div>
</div>
</section>
<section id="procedures">
<h3 id="procedures">Procedures<a class="headerlink" href="#procedures" title="Link to this heading">#</a></h3>
<p>Use the <a class="reference internal" href="../sql/call.html"><span class="doc std std-doc">CALL</span></a> statement to perform data manipulation or
administrative tasks. Procedures are available in the system schema of each
catalog. The following code snippet displays how to call the
<code class="docutils literal notranslate"><span class="pre">example_procedure</span></code> in the <code class="docutils literal notranslate"><span class="pre">examplecatalog</span></code> catalog:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span><span class="w"> </span><span class="n">examplecatalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">example_procedure</span><span class="p">()</span>
</pre></div>
</div>
<section id="register-table">
<span id="delta-lake-register-table"></span><h4 id="register-table">Register table<a class="headerlink" href="#register-table" title="Link to this heading">#</a></h4>
<p>The connector can register existing Delta Lake tables into the metastore if
<code class="docutils literal notranslate"><span class="pre">delta.register-table-procedure.enabled</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> for the catalog.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">system.register_table</span></code> procedure allows the caller to register an existing
Delta Lake table in the metastore, using its existing transaction logs and data
files:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">register_table</span><span class="p">(</span><span class="k">schema_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'testdb'</span><span class="p">,</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'customer_orders'</span><span class="p">,</span><span class="w"> </span><span class="n">table_location</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'s3://my-bucket/a/path'</span><span class="p">)</span>
</pre></div>
</div>
<p>To prevent unauthorized users from accessing data, this procedure is disabled by
default. The procedure is enabled only when
<code class="docutils literal notranslate"><span class="pre">delta.register-table-procedure.enabled</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</section>
<section id="unregister-table">
<span id="delta-lake-unregister-table"></span><h4 id="unregister-table">Unregister table<a class="headerlink" href="#unregister-table" title="Link to this heading">#</a></h4>
<p>The connector can remove existing Delta Lake tables from the metastore. Once
unregistered, you can no longer query the table from Trino.</p>
<p>The procedure <code class="docutils literal notranslate"><span class="pre">system.unregister_table</span></code> allows the caller to unregister an
existing Delta Lake table from the metastores without deleting the data:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">unregister_table</span><span class="p">(</span><span class="k">schema_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'testdb'</span><span class="p">,</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'customer_orders'</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="flush-metadata-cache">
<span id="delta-lake-flush-metadata-cache"></span><h4 id="flush-metadata-cache">Flush metadata cache<a class="headerlink" href="#flush-metadata-cache" title="Link to this heading">#</a></h4>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">system.flush_metadata_cache()</span></code></p>
<p>Flushes all metadata caches.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">system.flush_metadata_cache(schema_name</span> <span class="pre">=&gt;</span> <span class="pre">...,</span> <span class="pre">table_name</span> <span class="pre">=&gt;</span> <span class="pre">...)</span></code></p>
<p>Flushes metadata cache entries of a specific table.
Procedure requires passing named parameters.</p>
</li>
</ul>
</section>
<section id="vacuum">
<span id="delta-lake-vacuum"></span><h4 id="vacuum"><code class="docutils literal notranslate"><span class="pre">VACUUM</span></code><a class="headerlink" href="#vacuum" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">VACUUM</span></code> procedure removes all old files that are not in the transaction
log, as well as files that are not needed to read table snapshots newer than the
current time minus the retention period defined by the <code class="docutils literal notranslate"><span class="pre">retention</span> <span class="pre">period</span></code>
parameter.</p>
<p>Users with <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> and <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> permissions on a table can run <code class="docutils literal notranslate"><span class="pre">VACUUM</span></code> as
follows:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="k">vacuum</span><span class="p">(</span><span class="s1">'exampleschemaname'</span><span class="p">,</span><span class="w"> </span><span class="s1">'exampletablename'</span><span class="p">,</span><span class="w"> </span><span class="s1">'7d'</span><span class="p">);</span>
</pre></div>
</div>
<p>All parameters are required and must be presented in the following order:</p>
<ul class="simple">
<li><p>Schema name</p></li>
<li><p>Table name</p></li>
<li><p>Retention period</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">delta.vacuum.min-retention</span></code> configuration property provides a safety
measure to ensure that files are retained as expected. The minimum value for
this property is <code class="docutils literal notranslate"><span class="pre">0s</span></code>. There is a minimum retention session property as well,
<code class="docutils literal notranslate"><span class="pre">vacuum_min_retention</span></code>.</p>
</section>
</section>
<section id="data-management">
<span id="delta-lake-data-management"></span><h3 id="data-management">Data management<a class="headerlink" href="#data-management" title="Link to this heading">#</a></h3>
<p>You can use the connector to <a class="reference internal" href="../sql/insert.html"><span class="doc std std-doc">INSERT</span></a>, <a class="reference internal" href="../sql/delete.html"><span class="doc std std-doc">DELETE</span></a>, <a class="reference internal" href="../sql/update.html"><span class="doc std std-doc">UPDATE</span></a>,
and <a class="reference internal" href="../sql/merge.html"><span class="doc std std-doc">MERGE</span></a> data in Delta Lake tables.</p>
<p>Write operations are supported for tables stored on the following systems:</p>
<ul>
<li><p>Azure ADLS Gen2, Google Cloud Storage</p>
<p>Writes to the Azure ADLS Gen2 and Google Cloud Storage are enabled by default.
SEP detects write collisions on these storage systems when writing from
multiple Trino clusters, or from other query engines.</p>
</li>
<li><p>S3 and S3-compatible storage</p>
<p>Writes to <a class="reference internal" href="../object-storage/file-system-s3.html"><span class="doc std std-doc">Amazon S3</span></a> and S3-compatible
storage must be enabled with the <code class="docutils literal notranslate"><span class="pre">delta.enable-non-concurrent-writes</span></code>
property. Writes to S3 can safely be made from multiple SEP clusters.
However, write collisions are not detected when writing concurrently from
other Delta Lake engines. You must make sure that no concurrent data
modifications are run to avoid data corruption.</p>
</li>
</ul>
</section>
<section id="schema-and-table-management">
<span id="delta-lake-schema-table-management"></span><h3 id="schema-and-table-management">Schema and table management<a class="headerlink" href="#schema-and-table-management" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="../language/sql-support.html#sql-schema-table-management"><span class="std std-ref">Schema and table management</span></a> functionality includes support for:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../sql/create-table.html"><span class="doc std std-doc">CREATE TABLE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/create-table-as.html"><span class="doc std std-doc">CREATE TABLE AS</span></a></p></li>
<li><p><a class="reference internal" href="../sql/drop-table.html"><span class="doc std std-doc">DROP TABLE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/alter-table.html"><span class="doc std std-doc">ALTER TABLE</span></a>, see details for <a class="reference internal" href="#delta-lake-alter-table"><span class="std std-ref">Delta Lake ALTER
TABLE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/create-schema.html"><span class="doc std std-doc">CREATE SCHEMA</span></a></p></li>
<li><p><a class="reference internal" href="../sql/drop-schema.html"><span class="doc std std-doc">DROP SCHEMA</span></a></p></li>
<li><p><a class="reference internal" href="../sql/comment.html"><span class="doc std std-doc">COMMENT</span></a></p></li>
</ul>
<p>The connector supports creating schemas. You can create a schema with or without
a specified location.</p>
<p>You can create a schema with the <a class="reference internal" href="../sql/create-schema.html"><span class="doc std std-doc">CREATE SCHEMA</span></a> statement and the
<code class="docutils literal notranslate"><span class="pre">location</span></code> schema property. Tables in this schema are located in a subdirectory
under the schema location. Data files for tables in this schema using the
default location are cleaned up if the table is dropped:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example_schema</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="k">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'s3://my-bucket/a/path'</span><span class="p">);</span>
</pre></div>
</div>
<p>Optionally, the location can be omitted. Tables in this schema must have a
location included when you create them. The data files for these tables are not
removed if the table is dropped:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example_schema</span><span class="p">;</span>
</pre></div>
</div>
<p>When Delta Lake tables exist in storage but not in the metastore, SEP can be
used to register the tables:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">register_table</span><span class="p">(</span><span class="k">schema_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'testdb'</span><span class="p">,</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'example_table'</span><span class="p">,</span><span class="w"> </span><span class="n">table_location</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'s3://my-bucket/a/path'</span><span class="p">)</span>
</pre></div>
</div>
<p>The table schema is read from the transaction log instead. If the schema is
changed by an external system, SEP automatically uses the new schema.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> with an existing table content is disallowed, use the
<code class="docutils literal notranslate"><span class="pre">system.register_table</span></code> procedure instead.</p>
</div>
<p>If the specified location does not already contain a Delta table, the connector
automatically writes the initial transaction log entries and registers the table
in the metastore. As a result, any Databricks engine can write to the table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">new_table</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">);</span>
</pre></div>
</div>
<p>The Delta Lake connector also supports creating tables using the <a class="reference internal" href="../sql/create-table-as.html"><span class="doc std std-doc">CREATE TABLE
AS</span></a> syntax.</p>
<section id="schema-evolution">
<span id="delta-lake-schema-evolution"></span><h4 id="schema-evolution">Schema evolution<a class="headerlink" href="#schema-evolution" title="Link to this heading">#</a></h4>
<p>The Delta Lake connector supports schema evolution, with safe column add, drop,
and rename operations for non-nested structures.</p>
<p id="delta-lake-alter-table">The connector supports the following <a class="reference internal" href="../sql/alter-table.html"><span class="doc std std-doc">ALTER TABLE</span></a> statements.</p>
</section>
</section>
<section id="replacing-tables">
<span id="delta-lake-create-or-replace"></span><h3 id="replacing-tables">Replacing tables<a class="headerlink" href="#replacing-tables" title="Link to this heading">#</a></h3>
<p>The connector supports replacing an existing table as an atomic operation.
Atomic table replacement creates a new snapshot with the new table definition as
part of the <a class="reference internal" href="#delta-lake-history-table">table history</a>. Only the name of the
table remains identical.</p>
<p>To replace a table, use <a class="reference internal" href="../sql/create-table.html"><span class="doc std std-doc">CREATE OR REPLACE TABLE</span></a> or <a class="reference internal" href="../sql/create-table-as.html"><span class="doc std std-doc">CREATE
OR REPLACE TABLE AS</span></a>.</p>
<p>In the following example a partitioned table <code class="docutils literal notranslate"><span class="pre">my_table</span></code> can be replaced by a
completely new definition.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">my_table</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="k">c</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioned_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'a'</span><span class="p">]);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">my_table</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="k">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'s3://my-bucket/path/to/table'</span><span class="p">)</span>
<span class="k">AS</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">another_table</span><span class="p">;</span>
</pre></div>
</div>
<p>Table replacement in the Starburst Delta Lake connector has the following
limitations:</p>
<ul class="simple">
<li><p>Table replacement does not work on append-only Delta Lake tables.</p></li>
<li><p>Table replacement does not work for tables with the
<code class="docutils literal notranslate"><span class="pre">change_data_feed_enabled</span></code> property set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p>Table replacement does not work if the new table after replacement has the
<code class="docutils literal notranslate"><span class="pre">change_data_feed_enabled</span></code> property set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p>Table replacement does not work if the location specified in the property is
different from the location of the existing table.</p></li>
<li><p>Table types must stay the same. For example, table replacement cannot be used
to replace a managed table with an external table.</p></li>
</ul>
<section id="alter-table-execute">
<span id="delta-lake-alter-table-execute"></span><h4 id="alter-table-execute">ALTER TABLE EXECUTE<a class="headerlink" href="#alter-table-execute" title="Link to this heading">#</a></h4>
<p>The connector supports the following commands for use with <a class="reference internal" href="../sql/alter-table.html#alter-table-execute"><span class="std std-ref">ALTER TABLE
EXECUTE</span></a>.</p>
<section id="optimize">
<h5 id="optimize">optimize<a class="headerlink" href="#optimize" title="Link to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">optimize</span></code> command is used for rewriting the content of the specified
table so that it is merged into fewer but larger files. If the table is
partitioned, the data compaction acts separately on each partition selected for
optimization. This operation improves read performance.</p>
<p>All files with a size below the optional <code class="docutils literal notranslate"><span class="pre">file_size_threshold</span></code> parameter
(default value for the threshold is <code class="docutils literal notranslate"><span class="pre">100MB</span></code>) are merged:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="n">optimize</span>
</pre></div>
</div>
<p>The following statement merges files in a table that are
under 128 megabytes in size:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="n">optimize</span><span class="p">(</span><span class="n">file_size_threshold</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'128MB'</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use a <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause with the columns used to partition the table
to filter which partitions are optimized:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_partitioned_table</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="n">optimize</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">partition_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>You can use a more complex <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause to narrow down the scope of the
<code class="docutils literal notranslate"><span class="pre">optimize</span></code> procedure. The following example casts the timestamp values to
dates, and uses a comparison to only optimize partitions with data from the year
2022 or newer:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="n">optimize</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">timestamp_tz</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">DATE</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="s1">'2021-12-31'</span>
</pre></div>
</div>
<p>Use a <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause with <a class="reference internal" href="#delta-lake-special-columns"><span class="std std-ref">metadata columns</span></a> to
filter which files are optimized.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="n">optimize</span>
<span class="k">WHERE</span><span class="w"> </span><span class="ss">"$file_modified_time"</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">date_trunc</span><span class="p">(</span><span class="s1">'day'</span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="n">optimize</span>
<span class="k">WHERE</span><span class="w"> </span><span class="ss">"$path"</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s1">'skipping-file-path'</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- optimze files smaller than 1MB</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="k">EXECUTE</span><span class="w"> </span><span class="n">optimize</span>
<span class="k">WHERE</span><span class="w"> </span><span class="ss">"$file_size"</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span>
</pre></div>
</div>
</section>
</section>
<section id="alter-table-rename-to">
<span id="delta-lake-alter-table-rename-to"></span><h4 id="alter-table-rename-to">ALTER TABLE RENAME TO<a class="headerlink" href="#alter-table-rename-to" title="Link to this heading">#</a></h4>
<p>The connector only supports the <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">RENAME</span> <span class="pre">TO</span></code> statement when met with
one of the following conditions:</p>
<ul class="simple">
<li><p>The table type is external.</p></li>
<li><p>The table is backed by a metastore that does not perform object storage
operations, for example, AWS Glue.</p></li>
</ul>
</section>
<section id="table-properties">
<h4 id="table-properties">Table properties<a class="headerlink" href="#table-properties" title="Link to this heading">#</a></h4>
<p>The following table properties are available for use:</p>
<table id="id4">
<caption><span class="caption-text">Delta Lake table properties</span><a class="headerlink" href="#id4" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 40%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">location</span></code></p></td>
<td><p>File system location URI for the table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">partitioned_by</span></code></p></td>
<td><p>Set partition columns.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">checkpoint_interval</span></code></p></td>
<td><p>Set the checkpoint interval in number of table writes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">change_data_feed_enabled</span></code></p></td>
<td><p>Enables storing change data feed entries.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">column_mapping_mode</span></code></p></td>
<td><p>Column mapping mode. Possible values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ID</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NAME</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NONE</span></code></p></li>
</ul>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">NONE</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">deletion_vectors_enabled</span></code></p></td>
<td><p>Enables deletion vectors.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">in_commit_timestamp_enabled</span></code></p></td>
<td><p>Enables storing <code class="docutils literal notranslate"><span class="pre">inCommitTimestamp</span></code> in every commit.</p></td>
</tr>
</tbody>
</table>
<p>The following example uses all available table properties:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">example_partitioned_table</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'s3://my-bucket/a/path'</span><span class="p">,</span>
<span class="w">  </span><span class="n">partitioned_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'regionkey'</span><span class="p">],</span>
<span class="w">  </span><span class="n">checkpoint_interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">  </span><span class="n">change_data_feed_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">,</span>
<span class="w">  </span><span class="n">column_mapping_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'name'</span><span class="p">,</span>
<span class="w">  </span><span class="n">deletion_vectors_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
<span class="p">)</span>
<span class="k">AS</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">comment</span><span class="p">,</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tpch</span><span class="p">.</span><span class="n">tiny</span><span class="p">.</span><span class="n">nation</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="shallow-cloned-tables">
<span id="delta-lake-shallow-clone"></span><h4 id="shallow-cloned-tables">Shallow cloned tables<a class="headerlink" href="#shallow-cloned-tables" title="Link to this heading">#</a></h4>
<p>The connector supports read and write operations on shallow cloned tables. Trino
does not support creating shallow clone tables. More information about shallow
cloning is available in the <a class="reference external" href="https://docs.delta.io/latest/delta-utility.html#shallow-clone-a-delta-table">Delta Lake
documentation</a>.</p>
<p>Shallow cloned tables let you test queries or experiment with changes to a table
without duplicating data.</p>
</section>
<section id="metadata-tables">
<h4 id="metadata-tables">Metadata tables<a class="headerlink" href="#metadata-tables" title="Link to this heading">#</a></h4>
<p>The connector exposes several metadata tables for each Delta Lake table.
These metadata tables contain information about the internal structure
of the Delta Lake table. You can query each metadata table by appending the
metadata table name to the table name:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">"test_table$history"</span>
</pre></div>
</div>
<section id="history-table">
<span id="delta-lake-history-table"></span><h5 id="history-table"><code class="docutils literal notranslate"><span class="pre">$history</span></code> table<a class="headerlink" href="#history-table" title="Link to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">$history</span></code> table provides a log of the metadata changes performed on
the Delta Lake table.</p>
<p>You can retrieve the changelog of the Delta Lake table <code class="docutils literal notranslate"><span class="pre">test_table</span></code>
by using the following query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">"test_table$history"</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> version |               timestamp               | user_id | user_name |  operation   |         operation_parameters          |                 cluster_id      | read_version |  isolation_level  | is_blind_append | operation_metrics
---------+---------------------------------------+---------+-----------+--------------+---------------------------------------+---------------------------------+--------------+-------------------+-----------------+-------------------
       2 | 2023-01-19 07:40:54.684 Europe/Vienna | trino   | trino     | WRITE        | {queryId=20230119_064054_00008_4vq5t} | trino-406-trino-coordinator     |            2 | WriteSerializable | true            | {}
       1 | 2023-01-19 07:40:41.373 Europe/Vienna | trino   | trino     | ADD COLUMNS  | {queryId=20230119_064041_00007_4vq5t} | trino-406-trino-coordinator     |            0 | WriteSerializable | true            | {}
       0 | 2023-01-19 07:40:10.497 Europe/Vienna | trino   | trino     | CREATE TABLE | {queryId=20230119_064010_00005_4vq5t} | trino-406-trino-coordinator     |            0 | WriteSerializable | true            | {}
</pre></div>
</div>
<p>The output of the query has the following history columns:</p>
<table id="id5">
<caption><span class="caption-text">History columns</span><a class="headerlink" href="#id5" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 30%"/>
<col style="width: 30%"/>
<col style="width: 40%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">version</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>The version of the table corresponding to the operation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP(3)</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code></p></td>
<td><p>The time when the table version became active. For tables with in-Commit
timestamps enabled, this field returns the value of
<a class="reference external" href="https://github.com/delta-io/delta/blob/master/PROTOCOL.md#in-commit-timestamps">inCommitTimestamp</a>.
Otherwise, it returns the value of the <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> field in
<a class="reference external" href="https://github.com/delta-io/delta/blob/master/PROTOCOL.md#commit-provenance-information">commitInfo</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">user_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p>The identifier for the user which performed the operation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">user_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p>The username for the user which performed the operation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p>The name of the operation performed on the table</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">operation_parameters</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">map(VARCHAR,</span> <span class="pre">VARCHAR)</span></code></p></td>
<td><p>Parameters of the operation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cluster_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p>The ID of the cluster which ran the operation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">read_version</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>The version of the table which was read in order to perform the operation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isolation_level</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p>The level of isolation used to perform the operation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">is_blind_append</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p>Whether or not the operation appended data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">operation_metrics</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">map(VARCHAR,</span> <span class="pre">VARCHAR)</span></code></p></td>
<td><p>Metrics of the operation</p></td>
</tr>
</tbody>
</table>
</section>
<section id="partitions-table">
<span id="delta-lake-partitions-table"></span><h5 id="partitions-table"><code class="docutils literal notranslate"><span class="pre">$partitions</span></code> table<a class="headerlink" href="#partitions-table" title="Link to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">$partitions</span></code> table provides a detailed overview of the partitions of the
Delta Lake table.</p>
<p>You can retrieve the information about the partitions of the Delta Lake table
<code class="docutils literal notranslate"><span class="pre">test_table</span></code> by using the following query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">"test_table$partitions"</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>           partition           | file_count | total_size |                     data                     |
-------------------------------+------------+------------+----------------------------------------------+
{_bigint=1, _date=2021-01-12}  |          2 |        884 | {_decimal={min=1.0, max=2.0, null_count=0}}  |
{_bigint=1, _date=2021-01-13}  |          1 |        442 | {_decimal={min=1.0, max=1.0, null_count=0}}  |
</pre></div>
</div>
<p>The output of the query has the following columns:</p>
<table id="id6">
<caption><span class="caption-text">Partitions columns</span><a class="headerlink" href="#id6" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20%"/>
<col style="width: 30%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">partition</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ROW(...)</span></code></p></td>
<td><p>A row that contains the mapping of the partition column names to the
partition column values.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">file_count</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>The number of files mapped in the partition.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">total_size</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>The size of all the files in the partition.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">data</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ROW(...</span> <span class="pre">ROW</span> <span class="pre">(min</span> <span class="pre">...,</span> <span class="pre">max</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">null_count</span> <span class="pre">BIGINT))</span></code></p></td>
<td><p>Partition range and null counts.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="properties-table">
<h5 id="properties-table"><code class="docutils literal notranslate"><span class="pre">$properties</span></code> table<a class="headerlink" href="#properties-table" title="Link to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">$properties</span></code> table provides access to Delta Lake table configuration, table
features and table properties. The table rows are key/value pairs.</p>
<p>You can retrieve the properties of the Delta table <code class="docutils literal notranslate"><span class="pre">test_table</span></code> by using the
following query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">"test_table$properties"</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> key                        | value           |
----------------------------+-----------------+
delta.minReaderVersion      | 1               |
delta.minWriterVersion      | 4               |
delta.columnMapping.mode    | name            |
delta.feature.columnMapping | supported       |
</pre></div>
</div>
</section>
</section>
<section id="metadata-columns">
<span id="delta-lake-special-columns"></span><h4 id="metadata-columns">Metadata columns<a class="headerlink" href="#metadata-columns" title="Link to this heading">#</a></h4>
<p>In addition to the defined columns, the Delta Lake connector automatically
exposes metadata in a number of hidden columns in each table. You can use these
columns in your SQL statements like any other column, e.g., they can be selected
directly or used in conditional statements.</p>
<ul class="simple">
<li><dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">$path</span></code></dt><dd><p>Full file system path name of the file for this row.</p>
</dd>
</dl>
</li>
<li><dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">$file_modified_time</span></code></dt><dd><p>Date and time of the last modification of the file for this row.</p>
</dd>
</dl>
</li>
<li><dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">$file_size</span></code></dt><dd><p>Size of the file for this row.</p>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="table-functions">
<h3 id="table-functions">Table functions<a class="headerlink" href="#table-functions" title="Link to this heading">#</a></h3>
<p>The connector provides the following table functions:</p>
<section id="table-changes">
<h4 id="table-changes">table_changes<a class="headerlink" href="#table-changes" title="Link to this heading">#</a></h4>
<p>Allows reading Change Data Feed (CDF) entries to expose row-level changes
between two versions of a Delta Lake table. When the <code class="docutils literal notranslate"><span class="pre">change_data_feed_enabled</span></code>
table property is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> on a specific Delta Lake table, the connector
records change events for all data changes on the table. This is how these
changes can be read:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="w">  </span><span class="o">*</span>
<span class="k">FROM</span>
<span class="w">  </span><span class="k">TABLE</span><span class="p">(</span>
<span class="w">    </span><span class="k">system</span><span class="p">.</span><span class="n">table_changes</span><span class="p">(</span>
<span class="w">      </span><span class="k">schema_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'test_schema'</span><span class="p">,</span>
<span class="w">      </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'tableName'</span><span class="p">,</span>
<span class="w">      </span><span class="n">since_version</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">schema_name</span></code> - type <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>, required, name of the schema for which the
function is called</p>
<p><code class="docutils literal notranslate"><span class="pre">table_name</span></code> - type <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>, required, name of the table for which the
function is called</p>
<p><code class="docutils literal notranslate"><span class="pre">since_version</span></code> - type <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, optional, version from which changes are shown,
exclusive</p>
<p>In addition to returning the columns present in the table, the function returns
the following values for each change event:</p>
<ul class="simple">
<li><dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">_change_type</span></code></dt><dd><p>Gives the type of change that occurred. Possible values are <code class="docutils literal notranslate"><span class="pre">insert</span></code>,
<code class="docutils literal notranslate"><span class="pre">delete</span></code>, <code class="docutils literal notranslate"><span class="pre">update_preimage</span></code> and <code class="docutils literal notranslate"><span class="pre">update_postimage</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">_commit_version</span></code></dt><dd><p>Shows the table version for which the change occurred.</p>
</dd>
</dl>
</li>
<li><dl class="simple myst">
<dt><code class="docutils literal notranslate"><span class="pre">_commit_timestamp</span></code></dt><dd><p>Represents the timestamp for the commit in which the specified change happened.</p>
</dd>
</dl>
</li>
</ul>
<p>This is how it would be normally used:</p>
<p>Create table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_schema</span><span class="p">.</span><span class="n">pages</span><span class="w"> </span><span class="p">(</span><span class="n">page_url</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="k">domain</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="n">views</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">)</span>
<span class="w">    </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">change_data_feed_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Insert data:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">test_schema</span><span class="p">.</span><span class="n">pages</span>
<span class="w">    </span><span class="k">VALUES</span>
<span class="w">        </span><span class="p">(</span><span class="s1">'url1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'domain1'</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="p">(</span><span class="s1">'url2'</span><span class="p">,</span><span class="w"> </span><span class="s1">'domain2'</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w">        </span><span class="p">(</span><span class="s1">'url3'</span><span class="p">,</span><span class="w"> </span><span class="s1">'domain1'</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">test_schema</span><span class="p">.</span><span class="n">pages</span>
<span class="w">    </span><span class="k">VALUES</span>
<span class="w">        </span><span class="p">(</span><span class="s1">'url4'</span><span class="p">,</span><span class="w"> </span><span class="s1">'domain1'</span><span class="p">,</span><span class="w"> </span><span class="mi">400</span><span class="p">),</span>
<span class="w">        </span><span class="p">(</span><span class="s1">'url5'</span><span class="p">,</span><span class="w"> </span><span class="s1">'domain2'</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">),</span>
<span class="w">        </span><span class="p">(</span><span class="s1">'url6'</span><span class="p">,</span><span class="w"> </span><span class="s1">'domain3'</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>Update data:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">test_schema</span><span class="p">.</span><span class="n">pages</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="k">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'domain4'</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">views</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
<p>Select changes:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="w">  </span><span class="o">*</span>
<span class="k">FROM</span>
<span class="w">  </span><span class="k">TABLE</span><span class="p">(</span>
<span class="w">    </span><span class="k">system</span><span class="p">.</span><span class="n">table_changes</span><span class="p">(</span>
<span class="w">      </span><span class="k">schema_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'test_schema'</span><span class="p">,</span>
<span class="w">      </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'pages'</span><span class="p">,</span>
<span class="w">      </span><span class="n">since_version</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">_commit_version</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span>
</pre></div>
</div>
<p>The preceding sequence of SQL statements returns the following result:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>page_url    |     domain     |    views    |    _change_type     |    _commit_version    |    _commit_timestamp
url4        |     domain1    |    400      |    insert           |     2                 |    2023-03-10T21:22:23.000+0000
url5        |     domain2    |    500      |    insert           |     2                 |    2023-03-10T21:22:23.000+0000
url6        |     domain3    |    2        |    insert           |     2                 |    2023-03-10T21:22:23.000+0000
url2        |     domain2    |    2        |    update_preimage  |     3                 |    2023-03-10T22:23:24.000+0000
url2        |     domain4    |    2        |    update_postimage |     3                 |    2023-03-10T22:23:24.000+0000
url6        |     domain3    |    2        |    update_preimage  |     3                 |    2023-03-10T22:23:24.000+0000
url6        |     domain4    |    2        |    update_postimage |     3                 |    2023-03-10T22:23:24.000+0000
</pre></div>
</div>
<p>The output shows what changes happen in which version. For example in version 3
two rows were modified, first one changed from <code class="docutils literal notranslate"><span class="pre">('url2',</span> <span class="pre">'domain2',</span> <span class="pre">2)</span></code> into
<code class="docutils literal notranslate"><span class="pre">('url2',</span> <span class="pre">'domain4',</span> <span class="pre">2)</span></code> and the second from <code class="docutils literal notranslate"><span class="pre">('url6',</span> <span class="pre">'domain2',</span> <span class="pre">2)</span></code> into
<code class="docutils literal notranslate"><span class="pre">('url6',</span> <span class="pre">'domain4',</span> <span class="pre">2)</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">since_version</span></code> is not provided the function produces change events starting
from when the table was created.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="w">  </span><span class="o">*</span>
<span class="k">FROM</span>
<span class="w">  </span><span class="k">TABLE</span><span class="p">(</span>
<span class="w">    </span><span class="k">system</span><span class="p">.</span><span class="n">table_changes</span><span class="p">(</span>
<span class="w">      </span><span class="k">schema_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'test_schema'</span><span class="p">,</span>
<span class="w">      </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'pages'</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">_commit_version</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span>
</pre></div>
</div>
<p>The preceding SQL statement returns the following result:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>page_url    |     domain     |    views    |    _change_type     |    _commit_version    |    _commit_timestamp
url1        |     domain1    |    1        |    insert           |     1                 |    2023-03-10T20:21:22.000+0000
url2        |     domain2    |    2        |    insert           |     1                 |    2023-03-10T20:21:22.000+0000
url3        |     domain1    |    3        |    insert           |     1                 |    2023-03-10T20:21:22.000+0000
url4        |     domain1    |    400      |    insert           |     2                 |    2023-03-10T21:22:23.000+0000
url5        |     domain2    |    500      |    insert           |     2                 |    2023-03-10T21:22:23.000+0000
url6        |     domain3    |    2        |    insert           |     2                 |    2023-03-10T21:22:23.000+0000
url2        |     domain2    |    2        |    update_preimage  |     3                 |    2023-03-10T22:23:24.000+0000
url2        |     domain4    |    2        |    update_postimage |     3                 |    2023-03-10T22:23:24.000+0000
url6        |     domain3    |    2        |    update_preimage  |     3                 |    2023-03-10T22:23:24.000+0000
url6        |     domain4    |    2        |    update_postimage |     3                 |    2023-03-10T22:23:24.000+0000
</pre></div>
</div>
<p>You can see changes that occurred at version 1 as three inserts. They are not
visible in the previous statement when <code class="docutils literal notranslate"><span class="pre">since_version</span></code> value was set to 1.</p>
</section>
</section>
<section id="sql-security">
<span id="delta-lake-sql-security"></span><h3 id="sql-security">SQL security<a class="headerlink" href="#sql-security" title="Link to this heading">#</a></h3>
<p>You must set the <code class="docutils literal notranslate"><span class="pre">delta.security</span></code> property in your catalog properties file to
<code class="docutils literal notranslate"><span class="pre">sql-standard</span></code> in order to use SQL <a class="reference internal" href="../language/sql-support.html#sql-security-operations"><span class="std std-ref">security operation
statements</span></a>. See
<a class="reference internal" href="hive.html#hive-sql-standard-based-authorization"><span class="std std-ref">SQL standard based authorization</span></a> for more information.</p>
</section>
</section>
<section id="performance">
<h2 id="performance">Performance<a class="headerlink" href="#performance" title="Link to this heading">#</a></h2>
<p>The connector includes a number of performance features detailed in the
following sections.</p>
<ul class="simple">
<li><p>Support for <a class="reference internal" href="../admin/properties-write-partitioning.html"><span class="doc std std-doc">write partitioning</span></a>.</p></li>
</ul>
<section id="table-statistics">
<span id="delta-lake-table-statistics"></span><h3 id="table-statistics">Table statistics<a class="headerlink" href="#table-statistics" title="Link to this heading">#</a></h3>
<p>Use <a class="reference internal" href="../sql/analyze.html"><span class="doc std std-doc">ANALYZE</span></a> statements in Trino to populate data size and number of
distinct values (NDV) extended table statistics in Delta Lake. The minimum
value, maximum value, value count, and null value count statistics are computed
on the fly out of the transaction log of the Delta Lake table. The <a class="reference internal" href="../optimizer/cost-based-optimizations.html"><span class="doc std std-doc">cost-based
optimizer</span></a> then uses these statistics to
improve query performance.</p>
<p>Extended statistics enable a broader set of optimizations, including join
reordering. The controlling catalog property <code class="docutils literal notranslate"><span class="pre">delta.table-statistics-enabled</span></code> is
enabled by default. The equivalent <a class="reference internal" href="../sql/set-session.html#session-properties-definition"><span class="std std-ref">catalog session
property</span></a> is <code class="docutils literal notranslate"><span class="pre">statistics_enabled</span></code>.</p>
<p>Each <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> statement updates the table statistics incrementally, so only the
data changed since the last <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> is counted. The table statistics are not
automatically updated by write operations such as <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, and
<code class="docutils literal notranslate"><span class="pre">DELETE</span></code>. You must manually run <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> again to update the table statistics.</p>
<p>To collect statistics for a table, execute the following statement:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ANALYZE</span><span class="w"> </span><span class="n">table_schema</span><span class="p">.</span><span class="k">table_name</span><span class="p">;</span>
</pre></div>
</div>
<p>To recalculate from scratch the statistics for the table use additional parameter <code class="docutils literal notranslate"><span class="pre">mode</span></code>:</p>
<blockquote>
<div><p>ANALYZE table_schema.table_name WITH(mode = ‘full_refresh’);</p>
</div></blockquote>
<p>There are two modes available <code class="docutils literal notranslate"><span class="pre">full_refresh</span></code> and <code class="docutils literal notranslate"><span class="pre">incremental</span></code>. The procedure
use <code class="docutils literal notranslate"><span class="pre">incremental</span></code> by default.</p>
<p>To gain the most benefit from cost-based optimizations, run periodic <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code>
statements on every large table that is frequently queried.</p>
<section id="fine-tuning">
<h4 id="fine-tuning">Fine-tuning<a class="headerlink" href="#fine-tuning" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">files_modified_after</span></code> property is useful if you want to run the <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code>
statement on a table that was previously analyzed. You can use it to limit the
amount of data used to generate the table statistics:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ANALYZE</span><span class="w"> </span><span class="n">example_table</span><span class="w"> </span><span class="k">WITH</span><span class="p">(</span><span class="n">files_modified_after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">'2021-08-23</span>
<span class="s1">16:43:01.321 Z'</span><span class="p">)</span>
</pre></div>
</div>
<p>As a result, only files newer than the specified time stamp are used in the
analysis.</p>
<p>You can also specify a set or subset of columns to analyze using the <code class="docutils literal notranslate"><span class="pre">columns</span></code>
property:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ANALYZE</span><span class="w"> </span><span class="n">example_table</span><span class="w"> </span><span class="k">WITH</span><span class="p">(</span><span class="n">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'nationkey'</span><span class="p">,</span><span class="w"> </span><span class="s1">'regionkey'</span><span class="p">])</span>
</pre></div>
</div>
<p>To run <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> with <code class="docutils literal notranslate"><span class="pre">columns</span></code> more than once, the next <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code> must run on
the same set or a subset of the original columns used.</p>
<p>To broaden the set of <code class="docutils literal notranslate"><span class="pre">columns</span></code>, drop the statistics and reanalyze the table.</p>
</section>
<section id="disable-and-drop-extended-statistics">
<h4 id="disable-and-drop-extended-statistics">Disable and drop extended statistics<a class="headerlink" href="#disable-and-drop-extended-statistics" title="Link to this heading">#</a></h4>
<p>You can disable extended statistics by setting the catalog configuration
property <code class="docutils literal notranslate"><span class="pre">delta.extended-statistics.enabled</span></code> to <code class="docutils literal notranslate"><span class="pre">false</span></code>. Alternatively, you can
disable it for a session, by setting the <a class="reference internal" href="../sql/set-session.html"><span class="doc std std-doc">catalog session
property</span></a> <code class="docutils literal notranslate"><span class="pre">extended_statistics_enabled</span></code> to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<p>If a table is changed with many delete and update operations, calling <code class="docutils literal notranslate"><span class="pre">ANALYZE</span></code>
does not result in accurate statistics. To correct the statistics, you have to
drop the extended statistics and analyze the table again.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">system.drop_extended_stats</span></code> procedure in the catalog to drop the
extended statistics for a specified table in a specified schema:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">drop_extended_stats</span><span class="p">(</span><span class="s1">'example_schema'</span><span class="p">,</span><span class="w"> </span><span class="s1">'example_table'</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="memory-usage">
<h3 id="memory-usage">Memory usage<a class="headerlink" href="#memory-usage" title="Link to this heading">#</a></h3>
<p>The Delta Lake connector is memory intensive and the amount of required memory
grows with the size of Delta Lake transaction logs of any accessed tables. It is
important to take that into account when provisioning the coordinator.</p>
<p>You must decrease memory usage by keeping the number of active data files in the
table low by regularly running <code class="docutils literal notranslate"><span class="pre">OPTIMIZE</span></code> and <code class="docutils literal notranslate"><span class="pre">VACUUM</span></code> in Delta Lake.</p>
<section id="memory-monitoring">
<h4 id="memory-monitoring">Memory monitoring<a class="headerlink" href="#memory-monitoring" title="Link to this heading">#</a></h4>
<p>When using the Delta Lake connector, you must monitor memory usage on the
coordinator. Specifically, monitor JVM heap utilization using standard tools as
part of routine operation of the cluster.</p>
<p>A good proxy for memory usage is the cache utilization of Delta Lake caches. It
is exposed by the connector with the
<code class="docutils literal notranslate"><span class="pre">plugin.deltalake.transactionlog:name=&lt;catalog-name&gt;,type=transactionlogaccess</span></code>
JMX bean.</p>
<p>You can access it with any standard monitoring software with JMX support, or use
the <a class="reference internal" href="jmx.html"><span class="doc std std-doc">JMX connector</span></a> with the following query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="ss">"*.plugin.deltalake.transactionlog:name=&lt;catalog-name&gt;,type=transactionlogaccess"</span>
</pre></div>
</div>
<p>The following is an example result:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>datafilemetadatacachestats.hitrate      | 0.97
datafilemetadatacachestats.missrate     | 0.03
datafilemetadatacachestats.requestcount | 3232
metadatacachestats.hitrate              | 0.98
metadatacachestats.missrate             | 0.02
metadatacachestats.requestcount         | 6783
node                                    | trino-master
object_name                             | io.trino.plugin.deltalake.transactionlog:type=TransactionLogAccess,name=delta
</pre></div>
</div>
<p>In a healthy system, both <code class="docutils literal notranslate"><span class="pre">datafilemetadatacachestats.hitrate</span></code> and
<code class="docutils literal notranslate"><span class="pre">metadatacachestats.hitrate</span></code> are close to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</section>
</section>
<section id="table-redirection">
<span id="delta-lake-table-redirection"></span><h3 id="table-redirection">Table redirection<a class="headerlink" href="#table-redirection" title="Link to this heading">#</a></h3>
<p>Trino offers the possibility to transparently redirect operations on an existing
table to the appropriate catalog based on the format of the table and catalog configuration.</p>
<p>In the context of connectors which depend on a metastore service
(for example, <a class="reference internal" href="hive.html"><span class="doc">Hive connector</span></a>, <a class="reference internal" href="iceberg.html"><span class="doc">Iceberg connector</span></a> and <a class="reference internal" href="#"><span class="doc">Delta Lake connector</span></a>),
the metastore (Hive metastore service, <a class="reference external" href="https://aws.amazon.com/glue/">AWS Glue Data Catalog</a>)
can be used to accustom tables with different table formats.
Therefore, a metastore database can hold a variety of tables with different table formats.</p>
<p>As a concrete example, let’s use the following
simple scenario which makes use of table redirection:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">USE</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example_schema</span><span class="p">;</span>

<span class="k">EXPLAIN</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">example_table</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                               Query Plan
-------------------------------------------------------------------------
Fragment 0 [SOURCE]
     ...
     Output[columnNames = [...]]
     │   ...
     └─ TableScan[table = another_catalog:example_schema:example_table]
            ...
</pre></div>
</div>
<p>The output of the <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span></code> statement points out the actual
catalog which is handling the <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> query over the table <code class="docutils literal notranslate"><span class="pre">example_table</span></code>.</p>
<p>The table redirection functionality works also when using
fully qualified names for the tables:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example_schema</span><span class="p">.</span><span class="n">example_table</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                               Query Plan
-------------------------------------------------------------------------
Fragment 0 [SOURCE]
     ...
     Output[columnNames = [...]]
     │   ...
     └─ TableScan[table = another_catalog:example_schema:example_table]
            ...
</pre></div>
</div>
<p>Trino offers table redirection support for the following operations:</p>
<ul class="simple">
<li><p>Table read operations</p>
<ul>
<li><p><a class="reference internal" href="../sql/select.html"><span class="doc">SELECT</span></a></p></li>
<li><p><a class="reference internal" href="../sql/describe.html"><span class="doc">DESCRIBE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/show-stats.html"><span class="doc">SHOW STATS</span></a></p></li>
<li><p><a class="reference internal" href="../sql/show-create-table.html"><span class="doc">SHOW CREATE TABLE</span></a></p></li>
</ul>
</li>
<li><p>Table write operations</p>
<ul>
<li><p><a class="reference internal" href="../sql/insert.html"><span class="doc">INSERT</span></a></p></li>
<li><p><a class="reference internal" href="../sql/update.html"><span class="doc">UPDATE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/merge.html"><span class="doc">MERGE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/delete.html"><span class="doc">DELETE</span></a></p></li>
</ul>
</li>
<li><p>Table management operations</p>
<ul>
<li><p><a class="reference internal" href="../sql/alter-table.html"><span class="doc">ALTER TABLE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/drop-table.html"><span class="doc">DROP TABLE</span></a></p></li>
<li><p><a class="reference internal" href="../sql/comment.html"><span class="doc">COMMENT</span></a></p></li>
</ul>
</li>
</ul>
<p>Trino does not offer view redirection support.</p>
<p>The connector supports redirection from Delta Lake tables to Hive tables with
the <code class="docutils literal notranslate"><span class="pre">delta.hive-catalog-name</span></code> catalog configuration property.</p>
</section>
<section id="performance-tuning-configuration-properties">
<h3 id="performance-tuning-configuration-properties">Performance tuning configuration properties<a class="headerlink" href="#performance-tuning-configuration-properties" title="Link to this heading">#</a></h3>
<p>The following table describes performance tuning catalog configuration
properties for the Delta Lake connector.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Performance tuning configuration properties are considered expert-level
features. Altering these properties from their default values is likely to cause
instability and performance degradation. It is strongly suggested that you use
them only to address non-trivial performance issues, and that you keep a backup
of the original values if you change them.</p>
</div>
<table id="id7">
<caption><span class="caption-text">Delta Lake performance tuning configuration properties</span><a class="headerlink" href="#id7" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 30%"/>
<col style="width: 50%"/>
<col style="width: 20%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.domain-compaction-threshold</span></code></p></td>
<td><p>Minimum size of query predicates above which Trino compacts the predicates.
Pushing a large list of predicates down to the data source can compromise
performance. For optimization in that situation, Trino can compact the large
predicates. If necessary, adjust the threshold to ensure a balance between
performance and predicate pushdown.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.max-outstanding-splits</span></code></p></td>
<td><p>The target number of buffered splits for each table scan in a query, before
the scheduler tries to pause.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1000</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.max-splits-per-second</span></code></p></td>
<td><p>Sets the maximum number of splits used per second to access underlying
storage. Reduce this number if your limit is routinely exceeded, based on
your filesystem limits. This is set to the absolute maximum value, which
results in Trino maximizing the parallelization of data access by default.
Attempting to set it higher results in Trino not being able to start.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Integer.MAX_VALUE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.max-split-size</span></code></p></td>
<td><p>Sets the largest <a class="reference internal" href="../admin/properties.html#prop-type-data-size"><span class="std std-ref">data size</span></a> for a single read section assigned
to a worker after <code class="docutils literal notranslate"><span class="pre">max-initial-splits</span></code> have been processed. You can also use
the corresponding catalog session property <code class="docutils literal notranslate"><span class="pre">&lt;catalog-name&gt;.max_split_size</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">128MB</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.minimum-assigned-split-weight</span></code></p></td>
<td><p>A decimal value in the range (0, 1] used as a minimum for weights assigned
to each split. A low value might improve performance on tables with small
files. A higher value might improve performance for queries with highly
skewed aggregations or joins.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.05</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta.projection-pushdown-enabled</span></code></p></td>
<td><p>Read only projected fields from row columns while performing <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>
queries.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.query-partition-filter-required</span></code></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">true</span></code> to force a query to use a partition filter. You can use the
<code class="docutils literal notranslate"><span class="pre">query_partition_filter_required</span></code> catalog session property for temporary,
catalog specific use.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="file-system-cache">
<h3 id="file-system-cache">File system cache<a class="headerlink" href="#file-system-cache" title="Link to this heading">#</a></h3>
<p>The connector supports configuring and using <a class="reference internal" href="../object-storage/file-system-cache.html"><span class="doc std std-doc">file system
caching</span></a>.</p>
<p>The following table describes file system cache properties specific to the Delta
Lake connector.</p>
<table id="id8">
<caption><span class="caption-text">Delta Lake file system cache configuration properties</span><a class="headerlink" href="#id8" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 30%"/>
<col style="width: 50%"/>
<col style="width: 20%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta.fs.cache.disable-transaction-log-caching</span></code></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">true</span></code> to disable caching of the <code class="docutils literal notranslate"><span class="pre">_delta_log</span></code> directory of Delta
Tables. This is useful in those cases when Delta Tables are destroyed and
recreated, and the files inside the transaction log directory get
overwritten and cannot be safely cached. Effective only when
<code class="docutils literal notranslate"><span class="pre">fs.cache.enabled=true</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="dynamic-row-filtering">
<h3 id="dynamic-row-filtering">Dynamic row filtering<a class="headerlink" href="#dynamic-row-filtering" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="../admin/dynamic-filtering.html"><span class="doc">Dynamic filtering</span></a>, and specifically also
dynamic row filtering, is enabled by default. Row filtering improves the
effectiveness of dynamic filtering for a connector by using dynamic filters to
remove unnecessary rows during a table scan. It is especially powerful for
selective filters on columns that are not used for partitioning, bucketing, or
when the values do not appear in any clustered order naturally.</p>
<p>As a result the amount of data read from storage and transferred across the
network is further reduced. You get access to higher query performance and a
reduced cost.</p>
<p>You can use the following properties to configure dynamic row filtering:</p>
<table id="id9">
<caption><span class="caption-text">Dynamic row filtering properties</span><a class="headerlink" href="#id9" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 45%"/>
<col style="width: 55%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dynamic-row-filtering.enabled</span></code></p></td>
<td><p>Toggle dynamic row filtering. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>. Catalog session
property name is <code class="docutils literal notranslate"><span class="pre">dynamic_row_filtering_enabled</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dynamic-row-filtering.selectivity-threshold</span></code></p></td>
<td><p>Control the threshold for the fraction of the selected rows from the
overall table above which dynamic row filters are not used. Defaults to
0.7. Catalog session property name is
<code class="docutils literal notranslate"><span class="pre">dynamic_row_filtering_selectivity_threshold</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dynamic-row-filtering.wait-timeout</span></code></p></td>
<td><p>Duration to wait for completion of dynamic row filtering. Defaults to 0.
The default causes query processing to proceed without waiting for the
dynamic row filter, it is collected asynchronously and used as soon as
it becomes available. Catalog session property name is
<code class="docutils literal notranslate"><span class="pre">dynamic_row_filtering_wait_timeout</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="starburst-cached-views">
<h3 id="starburst-cached-views">Starburst Cached Views<a class="headerlink" href="#starburst-cached-views" title="Link to this heading">#</a></h3>
<p>The connector supports <a class="reference internal" href="../admin/table-scan-redirection.html"><span class="doc std std-doc">table scan redirection</span></a>
to improve performance and reduce load on the data source.</p>
</section>
</section>
<section id="security">
<h2 id="security">Security<a class="headerlink" href="#security" title="Link to this heading">#</a></h2>
<p>The connector includes a number of security-related features, detailed in the
following sections.</p>
<section id="authorization-checks">
<span id="delta-lake-authorization"></span><h3 id="authorization-checks">Authorization checks<a class="headerlink" href="#authorization-checks" title="Link to this heading">#</a></h3>
<p>The connector supports standard Hive security for authorization and lets you
choose one of several means of providing authorization at the catalog level. You
can select a different type of authorization check in different Delta Lake
catalog files.</p>
<p>Enable authorization checks for the connector by configuring the
<code class="docutils literal notranslate"><span class="pre">delta.security</span></code> property in the catalog properties file. This property must
include one of the following security values:</p>
<table id="id10">
<caption><span class="caption-text">Delta Lake security values</span><a class="headerlink" href="#id10" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 67%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ALLOW_ALL</span></code> (default value)</p></td>
<td><p>No authorization checks are enforced.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SYSTEM</span></code></p></td>
<td><p>The connector relies on system-level access control.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">READ_ONLY</span></code></p></td>
<td><p>Operations that read data or metadata, such as <a class="reference internal" href="../sql/select.html"><span class="doc std std-doc">SELECT</span></a> are
permitted. No operations that write data or metadata, such as
<a class="reference internal" href="../sql/create-table.html"><span class="doc std std-doc">CREATE TABLE</span></a>, <a class="reference internal" href="../sql/insert.html"><span class="doc std std-doc">INSERT</span></a>, or <a class="reference internal" href="../sql/delete.html"><span class="doc std std-doc">DELETE</span></a> are allowed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FILE</span></code></p></td>
<td><p>Authorization checks are enforced using a catalog-level access control
configuration file whose path is specified in the <code class="docutils literal notranslate"><span class="pre">security.config-file</span></code>
catalog configuration property. See <a class="reference internal" href="../security/file-system-access-control.html#catalog-file-based-access-control"><span class="std std-ref">Catalog-level access control files</span></a>
for information on the authorization configuration file.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="built-in-access-control">
<span id="delta-lake-biac"></span><h3 id="built-in-access-control">Built-in access control<a class="headerlink" href="#built-in-access-control" title="Link to this heading">#</a></h3>
<p>If you have enabled <a class="reference internal" href="../security/biac-overview.html"><span class="doc std std-doc">built-in access control</span></a> for
SEP, you must add the following configuration to all Delta Lake catalogs:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">delta.security</span><span class="o">=</span><span class="s">starburst</span>
</pre></div>
</div>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
<div class="md-grid md-main__inner" style="height: auto;">
  <div class="md-content">
    <div class="feedback-container md-content__inner md-typeset">
      <div class="feedback-thumbs">
        <p>Is the information on this page helpful?</p>
        <p class="feedback-option" title="yes">Yes</p>
        <p class="feedback-option" title="no">No</p>
      </div>
      <div class="feedback-message">
        <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
        <button type="button" onclick="sendMessage()" class="feedback-button">Email</button>
        <a onclick="skip()" class="feedback-skip">Cancel</a>
      </div>
    </div>
  </div>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '');
</script>
<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../object-storage-connectors.html" title="Object storage connectors"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Object storage connectors </span>
              </div>
            </a>
          
          
            <a href="hive.html" title="Hive connector"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Hive connector </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
<!-- custom footer should go here in time -->
<div class="page-footer">
  <div class="container md-grid">
    <div class="row">
      <div class="col-md-3">
        <p style="font-weight:900">Resources</p>
        <ul>
          <li class="footer-item"><a href="https://docs.starburst.io/latest/index.html">Starburst Enterprise reference documentation</a></li>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/starburst-intro-and-demo/" target="_blank">Join our weekly demos</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#!" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">

        <a href="https://www.starburst.io/" target="_blank">
          <img src="../_static/img/Starburst_Logo_White+Blue.svg" height="34"
            alt="Starburst Enterprise 478-e STS logo">
        </a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2025<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
  </div>
</div>
<script src="https://docs.starburst.io/478-e/_static/algolia.js"></script>
<script src="https://docs.starburst.io/478-e/_static/searchbox.js" data-versions="{'Latest LTS (477-e)': '/477-e/', '476-e LTS': '/476-e/', '474-e LTS': '/474-e/', '468-e LTS': '/468-e/', 'Latest STS (478-e)': '/478-e/'}"></script>
<script src="https://docs.starburst.io/478-e/_static/searchresults.js" data-versions="{'Latest LTS (477-e)': '/477-e/', '476-e LTS': '/476-e/', '474-e LTS': '/474-e/', '468-e LTS': '/468-e/', 'Latest STS (478-e)': '/478-e/'}"></script>
  </body>
</html>