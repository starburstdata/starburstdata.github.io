
<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CY10FQPGJS"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-CY10FQPGJS');
</script>
  
  
    <title>Operating Starburst Enterprise in AWS &#8212; Starburst Enterprise</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=bbebba6e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/algolia.css?v=0e0f969e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/starburst.css?v=c0e612e9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/search.css?v=87ff3654" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sidebar.css?v=7da5440c" />
    <script src="../../../_static/documentation_options.js?v=a68ab161"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=e378d701"></script>
    <script src="../../../_static/main.js?v=5bbdfc95"></script>
    <script src="../../../_static/heap_analytics.js?v=eba036f6"></script>
    <link rel="icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Amazon EKS overview" href="../eks/index.html" />
    <link rel="prev" title="Connection parameters in CFT" href="cft-connection-info.html" />

  
   

<link href="https://fonts.googleapis.com/css2?family=Barlow&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" >


<!-- Always link to the latest version, as canonical -->
<link rel="canonical" href="https://docs.starburst.io/latest/ecosystems/aws/cft/operate-sep-in-aws.html">

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#ecosystems/aws/cft/operate-sep-in-aws" tabindex="1" class="md-skip"> Skip to content </a>
  
<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.starburst.io" title="Starburst Enterprise"
          class="md-header-nav__button md-logo">
            <img src="../../../_static/img/Starburst_Logo_White+Blue.svg"
              alt="Starburst Enterprise 476-e STS logo">
        </a>
      </div>
      <span class="header-divider"></span>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <a href="/starburst-enterprise/index.html"
          class="md-header-nav__topic">
          Documentation: Starburst Enterprise 476-e STS</a>
          <span class="md-header-nav__topic"> Operating Starburst Enterprise in AWS </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        <div id="algolia-search">
  <div id="searchbox"></div>
  <div id="product-list">
    <h6 class="filter-label">Product:</h6>
  </div>
  <div id="versionsRefinementList" id="version-list" style="display:none"></div>
  <div id="hits"></div>
  <div id="stats"></div>
</div>
      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (474-e)" href="/474-e/">Latest LTS (474-e)</a>
      
          <a title="468-e LTS" href="/468-e/">468-e LTS</a>
      
          <a title="462-e LTS" href="/462-e/">462-e LTS</a>
      
          <a title="453-e LTS" href="/453-e/">453-e LTS</a>
      
          <a title="Latest STS (475-e)" href="/475-e/">Latest STS (475-e)</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="/introduction/index.html" class="md-tabs__link">Introduction</a></li>
            
            <li class="md-tabs__item"><a href="/clients/index.html" class="md-tabs__link">Clients</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-galaxy/index.html" class="md-tabs__link">Starburst Galaxy</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-enterprise/index.html" class="md-tabs__link">Starburst Enterprise</a></li>
            
            <li class="md-tabs__item"><a href="/resources.html" class="md-tabs__link">Resources</a></li>
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Amazon AWS</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Deploy SEP with CFT</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="Starburst Enterprise" class="md-nav__button md-logo">
      
        <img src="../../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../index.html"
       title="Starburst Enterprise">Starburst Enterprise 476-e STS</a>
  </label>
  
  
  <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/starburst-enterprise.html">What is Starburst Enterprise?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/try/try-sep.html">Try Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../learn/index.html">Learn Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">Product versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.starburst.io/support.html">Get support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For all users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/sep-ui.html">Starburst Enterprise web UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../client.html">Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data-products.html">Data products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../insights.html">Insights</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use SQL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../language.html">SQL language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sql.html">SQL statement syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions.html">Functions and operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../udf.html">User-defined functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For data engineers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../catalogs.html">Define catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../object-storage.html">Object storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data-engineering/materialized-views.html">Materialized views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data-engineering/data-maintenance.html">Data maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../optimizer.html">Query optimizer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Connect to data sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../connector.html">Connector overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../object-storage-connectors.html">Object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../non-object-storage-connectors.html">Non-object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../community-connectors.html">Community-supported connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../connector/starburst-connectors.html">Starburst connectors feature matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data-engineering/cost-and-performance/index.html">Monitor and manage cost and performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For platform administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-topics.html">Administration topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin.html">Performance, logging, and governance features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../starburst-rest-api.html">Starburst Enterprise REST API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deploy in cloud ecosystems</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">AWS ecosystem</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#starburst-enterprise">Starburst Enterprise</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../marketplace/index.html">AWS Marketplace for CFT and EKS users</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">AWS CFT</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cft-connection-info.html">Connection parameters in CFT</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Operating Starburst Enterprise in AWS</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#querying-sep">Querying SEP</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#example-trino-cli">Example: Trino CLI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#manually-scaling-a-running-sep-cluster">Manually scaling a running SEP cluster</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#add-or-remove-workers-using-the-aws-cloudformation-console">Add or remove workers using the AWS CloudFormation console</a></li>
<li class="toctree-l6"><a class="reference internal" href="#add-and-remove-an-instance-using-the-aws-cli">Add and remove an instance using the AWS CLI</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#auto-scaling">Auto scaling</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#manage-auto-scaling-groups">Manage auto scaling groups</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#auto-scaling-models">Auto scaling models</a></li>
<li class="toctree-l7"><a class="reference internal" href="#auto-scaling-activity">Auto scaling activity</a></li>
<li class="toctree-l7"><a class="reference internal" href="#manual">Manual</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#graceful-scaledown-of-workers">Graceful scaledown of workers</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#how-it-works">How it works</a></li>
<li class="toctree-l7"><a class="reference internal" href="#aws-elements-on-the-stack">AWS elements on the stack</a></li>
<li class="toctree-l7"><a class="reference internal" href="#sep-node-role-permissions">SEP node role permissions</a></li>
<li class="toctree-l7"><a class="reference internal" href="#graceful-scaledown-limitations">Graceful scaledown limitations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#coordinator-high-availability">Coordinator high availability</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#configuring-ha">Configuring HA</a></li>
<li class="toctree-l6"><a class="reference internal" href="#coordinator-ip-address">Coordinator IP address</a></li>
<li class="toctree-l6"><a class="reference internal" href="#failover-scenarios">Failover scenarios</a></li>
<li class="toctree-l6"><a class="reference internal" href="#ha-considerations">HA considerations</a></li>
<li class="toctree-l6"><a class="reference internal" href="#ha-with-https-enabled">HA with HTTPS enabled</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="index.html#releases-and-software">Releases and software</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#available-deployment-options">Available deployment options</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#sep-cluster-design-for-aws">SEP cluster design for AWS</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#sep-cloud-architecture">SEP cloud architecture</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../eks/index.html">AWS EKS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#sep-on-amazon-eks">SEP on Amazon EKS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#sep-on-amazon-ec2">SEP on Amazon EC2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#support-for-sep">Support for SEP</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../google/index.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../microsoft/index.html">Microsoft Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redhat/index.html">Red Hat OpenShift</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SEP deployment mechanisms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license-requirements.html">Starburst Enterprise license</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../k8s.html">Deploy with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../starburst-admin.html">Deploy with Starburst Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aws.html">Deploy with CFT on AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Local installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../develop.html">Trino developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendix.html">Version-specific notices and information</a></li>
</ul>
  
  
</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
  <div class="local-toc">
    <strong>Contents</strong>
    <ul>
<li><a class="reference internal" href="#">Operating Starburst Enterprise in AWS</a><ul>
<li><a class="reference internal" href="#querying-sep">Querying SEP</a><ul>
<li><a class="reference internal" href="#example-trino-cli">Example: Trino CLI</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manually-scaling-a-running-sep-cluster">Manually scaling a running SEP cluster</a><ul>
<li><a class="reference internal" href="#add-or-remove-workers-using-the-aws-cloudformation-console">Add or remove workers using the AWS CloudFormation console</a></li>
<li><a class="reference internal" href="#add-and-remove-an-instance-using-the-aws-cli">Add and remove an instance using the AWS CLI</a></li>
</ul>
</li>
<li><a class="reference internal" href="#auto-scaling">Auto scaling</a><ul>
<li><a class="reference internal" href="#manage-auto-scaling-groups">Manage auto scaling groups</a><ul>
<li><a class="reference internal" href="#auto-scaling-models">Auto scaling models</a></li>
<li><a class="reference internal" href="#auto-scaling-activity">Auto scaling activity</a></li>
<li><a class="reference internal" href="#manual">Manual</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graceful-scaledown-of-workers">Graceful scaledown of workers</a><ul>
<li><a class="reference internal" href="#how-it-works">How it works</a></li>
<li><a class="reference internal" href="#aws-elements-on-the-stack">AWS elements on the stack</a></li>
<li><a class="reference internal" href="#sep-node-role-permissions">SEP node role permissions</a></li>
<li><a class="reference internal" href="#graceful-scaledown-limitations">Graceful scaledown limitations</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#coordinator-high-availability">Coordinator high availability</a><ul>
<li><a class="reference internal" href="#configuring-ha">Configuring HA</a></li>
<li><a class="reference internal" href="#coordinator-ip-address">Coordinator IP address</a></li>
<li><a class="reference internal" href="#failover-scenarios">Failover scenarios</a></li>
<li><a class="reference internal" href="#ha-considerations">HA considerations</a></li>
<li><a class="reference internal" href="#ha-with-https-enabled">HA with HTTPS enabled</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>

              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="operating-starburst-enterprise-in-aws">
<h1 id="ecosystems-aws-cft-operate-sep-in-aws--page-root">Operating Starburst Enterprise in AWS<a class="headerlink" href="#ecosystems-aws-cft-operate-sep-in-aws--page-root" title="Link to this heading">#</a></h1>
<p>Congratulations! Your cluster is up and running. Now it is time to test it out
by connecting your clients like the CLI or a BI application using the JDBC
driver.</p>
<p>With that usage you gain insights on the correct configuration, data sources,
and sizing of the cluster for the desired usage and performance. This, in turn,
leads you to make additional changes, such as updating configuration, scaling
your cluster or upgrading to a newer release.</p>
<p>This document covers these operations and other aspects associated to running
your Starburst Enterprise platform (SEP) cluster, or even clusters.</p>
<section id="querying-sep">
<h2 id="querying-sep">Querying SEP<a class="headerlink" href="#querying-sep" title="Link to this heading">#</a></h2>
<p>Any query has to be submitted to the coordinator for processing on the cluster.
Typically you need the following parameters to connect:</p>
<ul class="simple">
<li><p>coordinator host name such as <code class="docutils literal notranslate"><span class="pre">starburst.example.com</span></code>, or IP address</p></li>
<li><p>protocol HTTP, defaults to port 80, or HTTPS, defaults to port 443</p></li>
<li><p>port, if non-default port is configured and exposed, commonly 8080 or 8443</p></li>
<li><p>username</p></li>
<li><p>password</p></li>
</ul>
<p>Locate the IP address, protocol, and port of your coordinator, for your
connection string, with following the steps:</p>
<ol class="arabic simple">
<li><p>Navigate to the CloudFormation console under <strong>Management Tools</strong> within the
<strong>Services</strong> menu.</p></li>
<li><p>Select your <strong>Stack Name</strong> and click the associated tab labeled <strong>Outputs</strong>.</p></li>
<li><p>Note the value for the <strong>StarburstCoordinatorURL</strong>.</p></li>
<li><p>Using the URL within the VPC, exposes the
<a class="reference internal" href="../../../overview/sep-ui.html"><span class="doc">Starburst Enterprise UI</span></a>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The coordinator IP address is private and therefore only accessible within the
same VPC as the SEP cluster stack. You need to ensure run your client tool from
within the VPC or allow connectivity to the VPC.</p>
</div>
<p>Now you can use <a class="external reference" href="../../../../clients/index.html">any client or driver</a>
supported by SEP to connect and query.</p>
<section id="example-trino-cli">
<h3 id="example-trino-cli">Example: Trino CLI<a class="headerlink" href="#example-trino-cli" title="Link to this heading">#</a></h3>
<p>You can use the Trino CLI from your local workstation:</p>
<ol class="arabic simple">
<li><p>Install the <a class="external reference" href="../../../../clients/cli.html">CLI</a>.</p></li>
<li><p>Use the parameters determined in the preceding section.</p></li>
<li><p>Run the CLI with URL and username supplied and activate the password dialog:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>trino<span class="w"> </span>--server<span class="w"> </span>https://starburst.example.com<span class="w"> </span>--user<span class="w"> </span>admin<span class="w"> </span>--password
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Once connected you can check for available catalogs with
<code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CATALOGS</span></code>, or run any other query.</p></li>
</ol>
</section>
</section>
<section id="manually-scaling-a-running-sep-cluster">
<h2 id="manually-scaling-a-running-sep-cluster">Manually scaling a running SEP cluster<a class="headerlink" href="#manually-scaling-a-running-sep-cluster" title="Link to this heading">#</a></h2>
<p>Using the CloudFormation template, you can scale your cluster up and down to
match demand. Alternatively you can use auto_scaling.</p>
<section id="add-or-remove-workers-using-the-aws-cloudformation-console">
<h3 id="add-or-remove-workers-using-the-aws-cloudformation-console">Add or remove workers using the AWS CloudFormation console<a class="headerlink" href="#add-or-remove-workers-using-the-aws-cloudformation-console" title="Link to this heading">#</a></h3>
<p><strong>1. CloudFormation console</strong>
Navigate to the CloudFormation Console under “Management Tools” within the
Services menu.</p>
<p><strong>2. Choose a stack</strong>
Select the SEP cluster (CloudFormation stack) you wish to alter.</p>
<p><strong>3. Actions menu</strong>
Navigate to the Actions drop-down menu and click <strong>Update Stack</strong>.</p>
<p><strong>4. Select template</strong>
Once you have arrived at the Select Template page within your stack update,
you can find a pre-populated field under “Amazon S3 template URL”. Click
<strong>Next</strong>. Note, selecting “Use current template” achieves the same result.</p>
<figure class="align-default">
<img alt="AWS template settings with the Use current template option selected" class="imgborder" src="../../../_images/aws-cft-update-template.png"/>
</figure>
<p><strong>5. Specify details</strong>
Within the Specify Details page navigate to the “Workers Count” field and
increase and decrease the node count to meet your needs.</p>
<figure class="align-default">
<img alt="AWS WorkersCount field set to 10 worker nodes" class="imgborder" src="../../../_images/aws-cft-update-workers.png"/>
</figure>
<p><strong>6. Review and update</strong> Navigate through to the Review page and look over your
changes. When these are correct, click <strong>Update</strong> to conclude the
up-scale/down-scale of your cluster.</p>
</section>
<section id="add-and-remove-an-instance-using-the-aws-cli">
<h3 id="add-and-remove-an-instance-using-the-aws-cli">Add and remove an instance using the AWS CLI<a class="headerlink" href="#add-and-remove-an-instance-using-the-aws-cli" title="Link to this heading">#</a></h3>
<p><strong>1. Open a terminal window</strong>
Open a terminal window to begin a command line.</p>
<p><strong>2. Update stack</strong>
Use the update stack command to initiate the update of your cluster
(CloudFormation stack).</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>aws<span class="w"> </span>cloudformation<span class="w"> </span>update-stack
</pre></div>
</div>
<p><strong>3. Choose a stack</strong>
Specify the name or unique stack ID of the cluster to update.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="w">  </span>--stack-name<span class="w"> </span><span class="o">(</span>string<span class="o">)</span>
</pre></div>
</div>
<p><strong>4. Select template</strong>
Indicate the template you used to create your cluster.</p>
<p>Set Previous: Reuse the existing template that is associated with the cluster
that you are updating. Set UsePreviousTemplate to true.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="w">  </span>--use-previous-template
</pre></div>
</div>
<p><strong>5. Add or remove instances</strong>
Specify a new value for the <code class="docutils literal notranslate"><span class="pre">WorkersCount</span> <span class="pre">parameter</span></code> and indicate to the AWS CLI
that you do not want to change value of any other parameters.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nv">ParameterKey</span><span class="o">=</span>WorkersCount,ParameterValue<span class="o">=</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>Reference the Example section below for a complete example of what to enter
into the CLI.</p>
<p><strong>6. Review and update</strong> Finally, review the details of your cluster and your
commands. When these are correct, proceed by pressing enter to finish updating
your cluster.</p>
<p>See the following <code class="docutils literal notranslate"><span class="pre">update-stack</span></code> command as a reference for your cluster
update:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="w">  </span>$<span class="w"> </span>aws<span class="w"> </span>cloudformation<span class="w"> </span>update-stack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--stack-name<span class="w"> </span>teststack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--use-previous-template<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--parameters<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=VPC,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=Subnet,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=SecurityGroups,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=CoordinatorInstanceType,UsePreviousValue=true"</span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=WorkersInstanceType,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=KeyName,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=IamInstanceProfile,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=WorkersCount,ParameterValue=3"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=LaunchSuperset,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=MetastoreType,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=ExternalMetastoreHost,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=ExternalMetastorePort,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=ExternalRdbmsMetastoreUserName,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=ExternalRdbmsMetastorePassword,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=ExternalRdbmsMetastoreDatabaseName,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=AdditionalCoordinatorConfigurationURI,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=AdditionalWorkersConfigurationURI,UsePreviousValue=true"</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">"ParameterKey=BootstrapScriptURI,UsePreviousValue=true"</span>
</pre></div>
</div>
<p>The above command yields output like the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">"StackId"</span><span class="p">:</span><span class="s2">"arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="auto-scaling">
<span id="cft-auto-scaling"></span><h2 id="auto-scaling">Auto scaling<a class="headerlink" href="#auto-scaling" title="Link to this heading">#</a></h2>
<p>AWS Auto Scaling offers automatic control over the size of your
SEP cluster (CloudFormation stack).</p>
<section id="manage-auto-scaling-groups">
<h3 id="manage-auto-scaling-groups">Manage auto scaling groups<a class="headerlink" href="#manage-auto-scaling-groups" title="Link to this heading">#</a></h3>
<p>When you create a cluster, an auto scaling group (ASG) is automatically created
for all the workers. To view and manage this ASG, log into your AWS account, and
refer to the <a class="reference external" href="https://console.aws.amazon.com/ec2/autoscaling/home?#AutoScalingGroups">AWS
ASG</a>
page to see a list of ASGs for all workers across your running clusters.
Here, you can control how Amazon Auto Scaling manages your cluster.</p>
<p>It is important to know that auto scaling policies for your ASGs are not created
automatically. You can create auto scaling policies for each ASG manually or by customizing your CFT.</p>
<p>Once scale-down occurs in the <code class="docutils literal notranslate"><span class="pre">Workers</span></code> ASG, your worker’s EC2 instance remains
in a terminating state for 3600 seconds by default. To change the timeout value,
you can use one of the following methods:</p>
<ul class="simple">
<li><p>Customize your CFT with a <a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-autoscaling-lifecyclehook.html">lifecycle
hook</a>.</p></li>
</ul>
<p>The following example shows how to configure a <code class="docutils literal notranslate"><span class="pre">600</span></code> seconds termination delay
for the <code class="docutils literal notranslate"><span class="pre">Workers</span></code> ASG using a lifecycle hook and the <code class="docutils literal notranslate"><span class="pre">HeartbeatTimeout</span></code>
property:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>GracefulStarburstNodeShutdownHook:
    Type: "AWS::AutoScaling::LifecycleHook"
    #aws-permission @cft autoscaling:PutLifecycleHook
    #aws-permission @cft autoscaling:DeleteLifecycleHook
    #aws-permission @cft autoscaling:DescribeLifecycleHooks
    Properties:
      AutoScalingGroupName: !Ref Workers
      LifecycleTransition: 'autoscaling:EC2_INSTANCE_TERMINATING'
      NotificationTargetARN: !GetAtt GracefulNodeShutdownQueue.Arn
      RoleARN: !GetAtt StarburstAutoScalingIAMRole.Arn
      HeartbeatTimeout: 600
</pre></div>
</div>
<ul class="simple">
<li><p>Create a parameter.</p></li>
</ul>
<p>The following example creates and defines a new parameter, then refers to the
new parameter in three steps:</p>
<ol class="arabic">
<li><p>Create a new parameter in a parameter group. For example, <code class="docutils literal notranslate"><span class="pre">TerminationDelay</span></code>
parameter in the <code class="docutils literal notranslate"><span class="pre">EC2</span> <span class="pre">configuration</span></code> group:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>AWSTemplateFormatVersion: 2010-09-09
Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
    - ...
    - Label:
        default: "EC2 configuration"
      Parameters:
        ...
        TerminationDelay
</pre></div>
</div>
</li>
<li><p>Define a type, range, and description for the new parameter:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Parameters:
...
TerminationDelay
    Description: &gt;
      A delay (in seconds) before Worker Node would be fully terminated by auto-scaling group. Allows in-flight queries to finish. Max value is 2 hours.
    Type: Number
    MinValue: 30
    MaxValue: 7200
    Default: 3600
</pre></div>
</div>
</li>
<li><p>Refer to the new parameter in the <code class="docutils literal notranslate"><span class="pre">HeartbeatTimeout</span></code> property:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Conditions:
  ...
  GracefulStarburstNodeShutdownHook:
    Type: "AWS::AutoScaling::LifecycleHook"
    #aws-permission @cft autoscaling:PutLifecycleHook
    #aws-permission @cft autoscaling:DeleteLifecycleHook
    #aws-permission @cft autoscaling:DescribeLifecycleHooks
    Properties:
      ...
      HeartbeatTimeout: !Ref TerminationDelay
</pre></div>
</div>
</li>
</ol>
<section id="auto-scaling-models">
<h4 id="auto-scaling-models">Auto scaling models<a class="headerlink" href="#auto-scaling-models" title="Link to this heading">#</a></h4>
<p>There are three types of auto scaling models you can employ to manage your
cluster:</p>
<ul class="simple">
<li><p>Static/Manual</p></li>
<li><p>Static/Scheduled</p></li>
<li><p>Dynamic</p></li>
</ul>
<p><strong>Static or manual auto scaling</strong></p>
<p>The static or manual auto scaling model is managed from the “Details” tab. This
model is configured by default. In this tab, there are three main properties:
“Desired Capacity”, “Min” and “Max”. Click on the “Edit” button to change those
values to your desired values and when you hit “Save” the auto scaling mechanism
starts to satisfy your requirements – either spinning up new workers or
shutting down existing ones.</p>
<p>In the CloudFormation template, by default, all three properties are
set to the same value. As a result the number of workers remains constant. When
a worker is terminated (or is unavailable for whatever reason), auto scaling
starts a new one to satisfy the requirements.</p>
<p><strong>Static or scheduled auto scaling</strong></p>
<p>The static or scheduled auto scaling model is controlled from the “Scheduled
Actions” tab. There, you can create a number of scheduled actions that allow you
to change the size of the cluster based on the time of day. For example, you can
keep a small number of nodes during the night, and boost it during different
parts of the day.</p>
<p>The configuration of this model is a simple list of actions that are scheduled
to execute and change the static values of “Min”, “Max” and “Desired Capacity”
properties to some other arbitrary (static) values of your choosing. Such an
action is  executed with the configured schedule, either once or in a repetitive
manner (cron). Continuing on the previous example, you can configure a nightly
cooldown – one event to handle lowering the values in the evening and another
event every morning to bring them back up.</p>
<p><strong>Dynamic auto scaling</strong></p>
<p>Dynamic auto scaling uses policies which you define in the in the “Scaling
Policies” tab. Of the three types of policies, “scaling policy with steps” and
“target tracking scaling policy” (default policy), are the most useful. The
third is a special case of the “with steps” policy that contains a single step.
You can change the policy type by clicking a link at the bottom of the “Scaling
Policies” tab.</p>
<ul>
<li><p><strong>Dynamic target tracking:</strong></p>
<p>With the dynamic target tracking policy you: (1) choose a relevant metric
(for example, avg CPU utilization) and state the target value; and (2) indicate the
time buffer to wait before reassessing the metric to let the new nodes start
up and start contributing to the metric value. Additionally, you can disable
scale-in to have the mechanism be able to only increase the worker count,
not shrink the cluster.</p>
</li>
<li><p><strong>Dynamic “with steps”:</strong></p>
<p>The dynamic “with steps” policy is more complex, as it consists of an alarm
and a number of adjustments. To define an alarm, you must choose a metric
and define its breach criteria (for example, avg CPU utilization over a chosen
period of time higher than 70%). Additionally, the alarm can optionally send
an event to an SNS topic for other systems to observe. Once the alarm is
breached, a set of adjustments to the number of nodes are executed. Those
adjustments can be either arbitrary (setting the number of nodes to a
specific value) or increments. The increments can be a value (for example, add 2
nodes, or remove 1 node) or a percentage of the current number of workers
(for example, add 10%, or reduce by 20%).</p>
</li>
</ul>
</section>
<section id="auto-scaling-activity">
<h4 id="auto-scaling-activity">Auto scaling activity<a class="headerlink" href="#auto-scaling-activity" title="Link to this heading">#</a></h4>
<p>All events in the auto scaling mechanism can be observed in the Activity History
tab. This is very useful for debugging purposes. The current instances part of
the ASG are listed in the “Instances” tab. There you can observe which instances
are currently being started-up or decommissioned.</p>
</section>
<section id="manual">
<h4 id="manual">Manual<a class="headerlink" href="#manual" title="Link to this heading">#</a></h4>
<p>Auto scaling can also be used for clusters built manually using the Starburst
AMIs and not using the CloudFormation stack. The workers need to be manually put
into a single ASG, and configured as described above. Graceful scaledown of
workers, as described in the graceful scaledown section of this document, does
not work for manually setup auto scaling groups.</p>
</section>
</section>
<section id="graceful-scaledown-of-workers">
<span id="cft-graceful-scaledown"></span><h3 id="graceful-scaledown-of-workers">Graceful scaledown of workers<a class="headerlink" href="#graceful-scaledown-of-workers" title="Link to this heading">#</a></h3>
<p>When a CloudFormation stack is created using the CloudFormation template all the
workers are automatically organized within an AWS ASG.</p>
<p>When AWS auto scaling resizes the cluster it starts decommissioning workers. The
CloudFormation stack has features to make sure this process doesn’t disrupt the
usage of the cluster, most importantly that no queries fail because of that.</p>
<p>Without this feature if a worker is forcefully shut down, all queries currently
running fail and need to be restarted.</p>
<section id="how-it-works">
<h4 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Link to this heading">#</a></h4>
<p>With graceful scaledown, when the ASG stack is modified to shrink
the cluster (number of workers lowered, or the auto scaling group is configured
to do so automatically) then AWS auto scaling notifies the workers it intends to
shut down and let them prepare for this.</p>
<p>The worker enters a special state in which it (1) stops serving new requests,
(2) continues processing the current query tasks that are scheduled on it and
(3) shuts down after finishing that work. Next after a 2 minute quiet period the
worker process automatically exits, and notifies the auto scaling mechanism to
proceed with the termination of its EC2 node.</p>
<p>The maximum time a worker can postpone AWS auto scaling termination of its node
is 48hrs, this is an AWS limitation.</p>
</section>
<section id="aws-elements-on-the-stack">
<h4 id="aws-elements-on-the-stack">AWS elements on the stack<a class="headerlink" href="#aws-elements-on-the-stack" title="Link to this heading">#</a></h4>
<p>The CloudFormation Template creates a number of resources on the
stack:</p>
<ul class="simple">
<li><p>an <a class="reference external" href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/lifecycle-hooks.html">Auto Scaling Hook</a></p></li>
<li><p>an <a class="reference external" href="https://aws.amazon.com/documentation/sqs/">SQS Queue</a> that this hook
writes to</p></li>
<li><p>an <a class="reference external" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">IAM Role</a>
and an
<a class="reference external" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2_instance-profiles.html">InstanceProfile</a> wrapper to allow auto
scaling to write to SQS</p></li>
<li><p>an <a class="reference external" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">IAM Role</a>
to allow the workers to talk to SQS, Auto scaling and EC2 services. The role
is fine grained to allow only the necessary actions. It is discussed
in a section below.</p></li>
</ul>
<p>All the resources created on the stack are explicit, and you can find them and
view their settings/permissions. All resources are terminated once the stack is
deleted.</p>
</section>
<section id="sep-node-role-permissions">
<h4 id="sep-node-role-permissions">SEP node role permissions<a class="headerlink" href="#sep-node-role-permissions" title="Link to this heading">#</a></h4>
<p>The node role is created automatically by the CloudFormation template on the
stack (and deleted when the stack is deleted).</p>
<p>When using Starburst via our CloudFormation template, by default, you do not
need to provide anything. The template creates all necessary resources
automatically.</p>
<p>If you need to provide your own IAM Instance Profile for the SEP instances
(<code class="docutils literal notranslate"><span class="pre">IamInstanceProfile</span></code> field in the Stack creation form), consult the <a class="reference internal" href="../../../aws/requirements.html#aws-security-prereq-nodes"><span class="std std-ref">IAM role permissions for cluster nodes</span></a> section. Same
applies when launching the AMI manually. Make sure you choose an IAM Role that
satisfies the requirements.</p>
</section>
<section id="graceful-scaledown-limitations">
<h4 id="graceful-scaledown-limitations">Graceful scaledown limitations<a class="headerlink" href="#graceful-scaledown-limitations" title="Link to this heading">#</a></h4>
<p>SEP instances created manually from the AWS Marketplace AMIs and
manually setup in an ASG do not benefit from this mechanism without manual
setup. They are operating without graceful scaledown, so when auto scaling kicks
in, all queries that are currently running may fail. In that case, at boot time
a warning log is recorded in the graceful scaledown handler log saying it’s not
running - this is intended behavior.</p>
</section>
</section>
</section>
<section id="coordinator-high-availability">
<span id="cft-high-availability"></span><h2 id="coordinator-high-availability">Coordinator high availability<a class="headerlink" href="#coordinator-high-availability" title="Link to this heading">#</a></h2>
<p>SEP offers the ability to enable high availability (HA) of the coordinator.
In the event the coordinator becomes unavailable, the cluster automatically
switches over to a new coordinator and continues to accept new queries.</p>
<section id="configuring-ha">
<h3 id="configuring-ha">Configuring HA<a class="headerlink" href="#configuring-ha" title="Link to this heading">#</a></h3>
<p>Coordinator high availability (HA) is only supported via the Starburst
CloudFormation template in AWS. In order to fully utilize this capability set
the <code class="docutils literal notranslate"><span class="pre">HACoordinatorsCount</span></code> field of the Stack creation form (<code class="docutils literal notranslate"><span class="pre">EC2</span> <span class="pre">Configuration</span></code>
section) to a value greater than <code class="docutils literal notranslate"><span class="pre">1</span></code>. Setting it to <code class="docutils literal notranslate"><span class="pre">2</span></code> or <code class="docutils literal notranslate"><span class="pre">3</span></code> should suffice
most scenarios.</p>
<p>HA is ALWAYS enabled. However, when <code class="docutils literal notranslate"><span class="pre">HACoordinatorsCount</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code> there is
no hot standby. In that case SEP eventually creates a new coordinator. This
may take several minutes. If <code class="docutils literal notranslate"><span class="pre">HACoordinatorsCount</span></code> equals <code class="docutils literal notranslate"><span class="pre">2</span></code> or more, then
there are hot standby coordinators and the fail-over switch is faster.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to disable automatic failover of the coordinator by setting the
<code class="docutils literal notranslate"><span class="pre">KeepCoordinatorNode</span></code> CFT parameter to <code class="docutils literal notranslate"><span class="pre">yes</span></code>.</p>
</div>
</section>
<section id="coordinator-ip-address">
<h3 id="coordinator-ip-address">Coordinator IP address<a class="headerlink" href="#coordinator-ip-address" title="Link to this heading">#</a></h3>
<p>The Coordinator is accessible via attached Elastic Network Interface (ENI) which
has a static auto-assigned private IP address. After you launch the Starburst
CloudFormation cluster stack, note the <code class="docutils literal notranslate"><span class="pre">StarburstCoordinatorURL</span></code> and
<code class="docutils literal notranslate"><span class="pre">StarburstSSH</span></code> keys in the stack’s Outputs section/tab in the AWS CloudFormation
console.</p>
<p><code class="docutils literal notranslate"><span class="pre">StarburstCoordinatorURL</span></code> is the Starburst Enterprise Web UI and REST API endpoint
address, which you use to point your Trino CLI or JDBC/ODBC drivers or access
the Web UI from your browser. <code class="docutils literal notranslate"><span class="pre">StarburstSSH</span></code> notes the SSH connection details to
manually log onto the current coordinator.</p>
</section>
<section id="failover-scenarios">
<h3 id="failover-scenarios">Failover scenarios<a class="headerlink" href="#failover-scenarios" title="Link to this heading">#</a></h3>
<p>In general, in the event of a failure of the current coordinator, the HA
mechanism kicks in and performs the following steps:</p>
<ol class="arabic simple">
<li><p>Terminate the old/failed coordinator EC2 instance.</p></li>
<li><p>Attach Elastic Network Interface to the new coordinator.</p></li>
<li><p>Launch a new stand-by coordinator (within a couple minutes).</p></li>
</ol>
<p>The core failover process (steps 1 and 2) should complete in under a minute,
from the time when the coordinator started failing to respond. It is a matter of
seconds once the coordinator is identified to be in a failed state, but there is
some built-in time buffer so that we don’t act on a false alarm. When Elastic
Network Interface is attached to the new coordinator, it is almost immediately
available to clients.</p>
<p><strong>In practice, a coordinator may “die” in one of the following scenarios:</strong></p>
<ul class="simple">
<li><p>The node becomes unresponsive (e.g. hardware issues, OS level and network
issues).</p></li>
<li><p>The node disappears, might be terminated by some account admin or by AWS.</p></li>
<li><p>The SEP process may exit because of an fatal error.</p></li>
<li><p>The SEP process may become unresponsive, e.g. because of a long
full garbage collection taking place.</p></li>
</ul>
<p>In all those scenarios, after a short grace period, the failed coordinator is
terminated if it still exists. Then a new coordinator is chosen among the hot
standby instances and has coordinator ENI attached to it. Clients should
re-issue the failed queries when the new coordinator becomes accessible. A new
hot standby coordinator is launched in the background to take place of the one
that has just been assigned.</p>
</section>
<section id="ha-considerations">
<h3 id="ha-considerations">HA considerations<a class="headerlink" href="#ha-considerations" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>When SEP is deployed in a custom setup (e.g. with a bootstrap
script which sets up security) make sure the HTTP port (unsecured) is open and
accessible from localhost. You may want to restrict access to it by binding it
to localhost only or otherwise securing external access e.g. via the AWS
Security Group assigned to the cluster. See the <strong>HA with HTTPS enabled</strong>
section of this document for more information.</p></li>
<li><p>Coordinator ENI has private IP address which is accessible only within the
same VPC as the cluster stack. This means in order to connect to the
coordinator you need to initiate the connection from a client either on EC2
machine deployed in the same VPC or connected to the VPC via a VPN.</p></li>
<li><p>Note that all queries, that were running when the coordinator failed,
fail to complete. You need to restart these queries on the new coordinator.
Similarly the SSH connections to the old coordinator needs to be
re-established after the fail-over.</p></li>
<li><p>When connecting via SSH, depending on your SSH configuration you may see
login issues like <code class="docutils literal notranslate"><span class="pre">REMOTE</span> <span class="pre">HOST</span> <span class="pre">IDENTIFICATION</span> <span class="pre">HAS</span> <span class="pre">CHANGED</span></code> etc, due to the
fact that the underlying host has changed, and the key’s fingerprint that was
previously accepted has changed. You may want to not verify the host keys at
all, by adding <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">StrictHostKeyChecking=no</span></code> to the SSH command or deleting
the key from your <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code> file and accepting the new one.</p></li>
</ul>
</section>
<section id="ha-with-https-enabled">
<h3 id="ha-with-https-enabled">HA with HTTPS enabled<a class="headerlink" href="#ha-with-https-enabled" title="Link to this heading">#</a></h3>
<p>The coordinator’s health is checked by polling SEP locally via
HTTP. This is why you need to have the coordinator’s HTTP port open even if you
configured SEP to use HTTPS, regardless how many coordinators are
configured (even if only one). Workers do not need to have their HTTP port open,
although we recommend using HTTP for internal cluster communication (unless
HTTPS is explicitly required for internal communication as well). Note that
using HTTPS for internal communication may have substantial impact on overall
cluster performance, because all intermediate data needs to be encrypted and
decrypted. The overhead of HTTPS depends on the amount of data sent over network
and actual ciphers being used.</p>
<p>Example SEP <code class="docutils literal notranslate"><span class="pre">config.properties</span></code> fragment:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="na">http-server.http.enabled</span><span class="o">=</span><span class="s">true</span>
<span class="w">  </span><span class="na">http-server.https.enabled</span><span class="o">=</span><span class="s">true</span>
</pre></div>
</div>
<p>Additionally you should block non-local HTTP access to the coordinator by
configuring the AWS Security Group assigned to the cluster accordingly.</p>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
<div class="md-grid md-main__inner" style="height: auto;">
  <div class="md-content">
    <div class="feedback-container md-content__inner md-typeset">
      <div class="feedback-thumbs">
        <p>Is the information on this page helpful?</p>
        <p class="feedback-option" title="yes">Yes</p>
        <p class="feedback-option" title="no">No</p>
      </div>
      <div class="feedback-message">
        <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
        <button type="button" onclick="sendMessage()" class="feedback-button">Email</button>
        <a onclick="skip()" class="feedback-skip">Cancel</a>
      </div>
    </div>
  </div>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '');
</script>
<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="cft-connection-info.html" title="Connection parameters in CFT"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Connection parameters in CFT </span>
              </div>
            </a>
          
          
            <a href="../eks/index.html" title="Amazon EKS overview"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Amazon EKS overview </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
<!-- custom footer should go here in time -->
<div class="page-footer">
  <div class="container md-grid">
    <div class="row">
      <div class="col-md-3">
        <p style="font-weight:900">Resources</p>
        <ul>
          <li class="footer-item"><a href="https://docs.starburst.io/latest/index.html">Starburst Enterprise reference documentation</a></li>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/starburst-intro-and-demo/" target="_blank">Join our weekly demos</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#!" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">

        <a href="https://www.starburst.io/" target="_blank">
          <img src="../../../_static/img/Starburst_Logo_White+Blue.svg" height="34"
            alt="Starburst Enterprise 476-e STS logo">
        </a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2025<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
  </div>
</div>
<script src="https://docs.starburst.io/476-e/_static/algolia.js"></script>
<script src="https://docs.starburst.io/476-e/_static/searchbox.js" data-versions="{'Latest LTS (474-e)': '/474-e/', '468-e LTS': '/468-e/', '462-e LTS': '/462-e/', '453-e LTS': '/453-e/', 'Latest STS (475-e)': '/475-e/'}"></script>
<script src="https://docs.starburst.io/476-e/_static/searchresults.js" data-versions="{'Latest LTS (474-e)': '/474-e/', '468-e LTS': '/468-e/', '462-e LTS': '/462-e/', '453-e LTS': '/453-e/', 'Latest STS (475-e)': '/475-e/'}"></script>
  </body>
</html>