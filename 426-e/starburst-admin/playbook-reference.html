

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Playbook reference &#8212; Starburst Enterprise</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/algolia.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <link rel="stylesheet" type="text/css" href="../_static/search.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/main.js"></script>
    <script src="../_static/heap_analytics.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Release notes" href="release-notes.html" />
    <link rel="prev" title="Operation guide" href="operation-guide.html" />

  
   

<link href="https://fonts.googleapis.com/css2?family=Barlow&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">


<!-- Always link to the latest version, as canonical -->
<link rel="canonical" href="https://docs.starburst.io/latest/starburst-admin/playbook-reference.html">

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#starburst-admin/playbook-reference" tabindex="1" class="md-skip"> Skip to content </a>
  
<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://www.starburst.io" title="Starburst Enterprise"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/starburst_KO-T.png"
                   alt="Starburst Enterprise 426-e STS logo">
          
        </a>
      </div>
      <span class="header-divider"></span>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <a href="/starburst-enterprise/index.html"
          class="md-header-nav__topic">
          Documentation: Starburst Enterprise 426-e STS</a>
          <span class="md-header-nav__topic"> Playbook reference </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        <div id="algolia-search">
  <div id="searchbox"></div>
  <div id="product-list">
    <h6 class="filter-label">Product:</h6>
  </div>
  <div id="versionsRefinementList" id="version-list" style="display:none"></div>
  <div id="hits"></div>
  <div id="stats"></div>
</div>
      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (423-e)" href="/423-e/">Latest LTS (423-e)</a>
      
          <a title="413-e LTS" href="/413-e/">413-e LTS</a>
      
          <a title="407-e LTS" href="/407-e/">407-e LTS</a>
      
          <a title="402-e LTS" href="/402-e/">402-e LTS</a>
      
          <a title="Latest STS (426-e)" href="/426-e/">Latest STS (426-e)</a>
      
          <a title="422-e STS" href="/422-e/">422-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="/get-started/index.html" class="md-tabs__link">Get started</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-galaxy/index.html" class="md-tabs__link">Starburst Galaxy</a></li>
            
            <li class="md-tabs__item"><a href="/starburst-enterprise/index.html" class="md-tabs__link">Starburst Enterprise</a></li>
            
            <li class="md-tabs__item"><a href="/ecosystems/index.html" class="md-tabs__link">Ecosystems</a></li>
            
            <li class="md-tabs__item"><a href="/resources.html" class="md-tabs__link">Resources</a></li>
          <li class="md-tabs__item"><a href="../starburst-admin.html" class="md-tabs__link">Starburst Admin</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise" class="md-nav__button md-logo">
      
        <img src="../_static/starburst_KO-T.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise">Starburst Enterprise 426-e STS</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Overview</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Features, use cases, and support</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">For all users</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../overview/sep-ui.html" class="md-nav__link">Starburst Enterprise web UI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../data-products.html" class="md-nav__link">Data products</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../insights.html" class="md-nav__link">Insights</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">For data engineers</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">For platform administrators</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Manual installation and license</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../starburst-admin.html" class="md-nav__link">Starburst Admin</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="get-started.html" class="md-nav__link">Getting started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="installation-guide.html" class="md-nav__link">Installation guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="operation-guide.html" class="md-nav__link">Operation guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Playbook reference </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Playbook reference</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#starburst-admin-playbook-reference--page-root" class="md-nav__link">Playbook reference</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#install-cluster" class="md-nav__link">Install cluster</a>
        </li>
        <li class="md-nav__item"><a href="#push-configurations" class="md-nav__link">Push configurations</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#automated-memory-configuration" class="md-nav__link">Automated memory configuration</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#start-cluster" class="md-nav__link">Start cluster</a>
        </li>
        <li class="md-nav__item"><a href="#stop-cluster" class="md-nav__link">Stop cluster</a>
        </li>
        <li class="md-nav__item"><a href="#restart-cluster" class="md-nav__link">Restart cluster</a>
        </li>
        <li class="md-nav__item"><a href="#check-service-status" class="md-nav__link">Check service status</a>
        </li>
        <li class="md-nav__item"><a href="#graceful-worker-shutdown" class="md-nav__link">Graceful worker shutdown</a>
        </li>
        <li class="md-nav__item"><a href="#rolling-worker-restart" class="md-nav__link">Rolling worker restart</a>
        </li>
        <li class="md-nav__item"><a href="#collect-logs" class="md-nav__link">Collect logs</a>
        </li>
        <li class="md-nav__item"><a href="#collect-jstack-dump" class="md-nav__link">Collect Jstack Dump</a>
        </li>
        <li class="md-nav__item"><a href="#uninstall-cluster" class="md-nav__link">Uninstall cluster</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#install-cluster" class="md-nav__link">Install cluster</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#push-configurations" class="md-nav__link">Push configurations</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#automated-memory-configuration" class="md-nav__link">Automated memory configuration</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#start-cluster" class="md-nav__link">Start cluster</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#stop-cluster" class="md-nav__link">Stop cluster</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#restart-cluster" class="md-nav__link">Restart cluster</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#check-service-status" class="md-nav__link">Check service status</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#graceful-worker-shutdown" class="md-nav__link">Graceful worker shutdown</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#rolling-worker-restart" class="md-nav__link">Rolling worker restart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#collect-logs" class="md-nav__link">Collect logs</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#collect-jstack-dump" class="md-nav__link">Collect Jstack Dump</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#uninstall-cluster" class="md-nav__link">Uninstall cluster</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="release-notes.html" class="md-nav__link">Release notes</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Deploying with Kubernetes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Deploying with CFT on AWS</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Performance, logging, and governance features</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../starburst-rest-api.html" class="md-nav__link">Starburst Enterprise REST API</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Data sources</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connector overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../object-storage.html" class="md-nav__link">Object storage connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../non-object-storage.html" class="md-nav__link">Non-object storage connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../utilities.html" class="md-nav__link">Utilities</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector/starburst-connectors.html" class="md-nav__link">Starburst connectors feature matrix</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">SQL reference</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">426-e STS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Appendix</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../appendix.html" class="md-nav__link">Version-specific notices and information</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#starburst-admin-playbook-reference--page-root" class="md-nav__link">Playbook reference</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#install-cluster" class="md-nav__link">Install cluster</a>
        </li>
        <li class="md-nav__item"><a href="#push-configurations" class="md-nav__link">Push configurations</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#automated-memory-configuration" class="md-nav__link">Automated memory configuration</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#start-cluster" class="md-nav__link">Start cluster</a>
        </li>
        <li class="md-nav__item"><a href="#stop-cluster" class="md-nav__link">Stop cluster</a>
        </li>
        <li class="md-nav__item"><a href="#restart-cluster" class="md-nav__link">Restart cluster</a>
        </li>
        <li class="md-nav__item"><a href="#check-service-status" class="md-nav__link">Check service status</a>
        </li>
        <li class="md-nav__item"><a href="#graceful-worker-shutdown" class="md-nav__link">Graceful worker shutdown</a>
        </li>
        <li class="md-nav__item"><a href="#rolling-worker-restart" class="md-nav__link">Rolling worker restart</a>
        </li>
        <li class="md-nav__item"><a href="#collect-logs" class="md-nav__link">Collect logs</a>
        </li>
        <li class="md-nav__item"><a href="#collect-jstack-dump" class="md-nav__link">Collect Jstack Dump</a>
        </li>
        <li class="md-nav__item"><a href="#uninstall-cluster" class="md-nav__link">Uninstall cluster</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="playbook-reference">
<h1 id="starburst-admin-playbook-reference--page-root">Playbook reference<a class="headerlink" href="#starburst-admin-playbook-reference--page-root" title="Permalink to this heading">#</a></h1>
<p>Starburst Admin includes numerous playbooks to perform specific actions.
You can use them individually or in sequence to satisfy the needs of your
specific use case for <a class="reference internal" href="installation-guide.html"><span class="doc">installing</span></a> and
<a class="reference internal" href="operation-guide.html"><span class="doc">operating</span></a>.</p>
<p>The following playbooks are available:</p>
<!-- no toc -->
<ul class="simple">
<li><p><a class="reference internal" href="#pb-install"><span class="std std-ref">Install cluster</span></a></p></li>
<li><p><a class="reference internal" href="#pb-push-configs"><span class="std std-ref">Push configuration</span></a></p></li>
<li><p><a class="reference internal" href="#pb-start"><span class="std std-ref">Start cluster</span></a></p></li>
<li><p><a class="reference internal" href="#pb-stop"><span class="std std-ref">Stop cluster</span></a></p></li>
<li><p><a class="reference internal" href="#pb-restart"><span class="std std-ref">Restart cluster</span></a></p></li>
<li><p><a class="reference internal" href="#pb-check-status"><span class="std std-ref">Check service status</span></a></p></li>
<li><p><a class="reference internal" href="#pb-graceful-shutdown"><span class="std std-ref">Graceful worker shutdown</span></a></p></li>
<li><p><a class="reference internal" href="#pb-rolling-restart-workers"><span class="std std-ref">Rolling worker restart</span></a></p></li>
<li><p><a class="reference internal" href="#pb-collect-logs"><span class="std std-ref">Collect logs</span></a></p></li>
<li><p><a class="reference internal" href="#pb-collect-jstacks"><span class="std std-ref">Collect a Java thread dump</span></a></p></li>
<li><p><a class="reference internal" href="#pb-uninstall"><span class="std std-ref">Uninstall cluster</span></a></p></li>
</ul>
<section id="install-cluster">
<span id="pb-install"></span><h2 id="install-cluster">Install cluster<a class="headerlink" href="#install-cluster" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">install</span></code> playbook installs the RPM or tarball package on all defined hosts.
You are required to place the <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> or <code class="docutils literal notranslate"><span class="pre">rpm</span></code> file in the <code class="docutils literal notranslate"><span class="pre">files</span></code> directory
and specify the <code class="docutils literal notranslate"><span class="pre">version</span></code> in <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code> to run the playbook:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/install.yml
</pre></div>
</div>
<p>Errors occurs if RPM and tarball are found or if version values mismatch.</p>
<p>Alternatively to the archive in the <code class="docutils literal notranslate"><span class="pre">files</span></code> directory on the control machine,
you can set the <code class="docutils literal notranslate"><span class="pre">installer_url</span></code> in <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code> to point to HTTP or HTTPS URL of
the  <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> or <code class="docutils literal notranslate"><span class="pre">rpm</span></code>. Comment out the <code class="docutils literal notranslate"><span class="pre">installer_file</span></code> in <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code>. Ansible
then downloads the binary from the URL directly on the hosts. This approach is
more complex to set up, but scales better since all hosts can download from the
URL in parallel. The hosts need to be able to contact the specified URL.</p>
<p>The playbook verifies the availability of the required Java runtime on the host,
starting first at the value of <code class="docutils literal notranslate"><span class="pre">JAVA_HOME</span></code> and then looking at common
installation paths. It uses the script <code class="docutils literal notranslate"><span class="pre">files/find_java.sh</span></code> and fails if no
runtime is found.</p>
<p>The playbook installs the RPM or unpack the tarball and create the necessary
directories specified via <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code>.</p>
<p>Optionally, all playbooks read a custom <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code> file by passing a <code class="docutils literal notranslate"><span class="pre">vars_yml</span></code>
parameter as an extra variable (-e), as in this example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/install.yml -e <span class="s2">"vars_yml=/mypath/my-vars.yml"</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">local_files</span></code> variable in the <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code> file defines where the playbooks
reads the configuration files from before copying them to the target. A relative
path is assumed to be relative to the playbooks directory, or an absolute
path can be used to source the files from any directory.</p>
<p>Ansible can operate as root (default), or as a non-root user.
For root privileges, <code class="docutils literal notranslate"><span class="pre">sudo</span></code> commands are used to elevate privileges.
Since <code class="docutils literal notranslate"><span class="pre">sudo</span></code> prompts for the user password, run every <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> command
with the <code class="docutils literal notranslate"><span class="pre">--ask-become-pass</span></code> parameter as detailed in the <a class="external reference" href="https://docs.ansible.com/ansible/latest/user_guide/become.html#become-command-line-options">become command
documentation</a>.</p>
<p>The RPM installation automatically adds a dedicated system user to run SEP
as a service. This user owns all configuration files, which should not be
readable by other users on the hosts. The tarball installation uses the
<code class="docutils literal notranslate"><span class="pre">installation_owner</span></code> and <code class="docutils literal notranslate"><span class="pre">installation_group</span></code> defined in <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code>. The install
playbook create the user and group.</p>
<p>SEP depends on Linux’s limit of the <a class="external reference" href="https://docs.oracle.com/cd/E19623-01/820-6168/file-descriptor-requirements.html">number of open
files</a>.
For root installs, this playbook automatically sets the limit to an
appropriate value. Non-root installs cannot change the open file limit, so this
playbook instead displays a warning message at the end of the playbook
if the current limit is inadequate. Use the <code class="docutils literal notranslate"><span class="pre">ulimit_nofile_min</span></code> variable
<code class="docutils literal notranslate"><span class="pre">vars.yml</span></code> to define the minimum value. For root installs, this same variable
is used when automatically setting the value.</p>
</section>
<section id="push-configurations">
<span id="pb-push-configs"></span><h2 id="push-configurations">Push configurations<a class="headerlink" href="#push-configurations" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">push-configs</span></code> playbook generates the configuration files for the
coordinator and workers and distributes them to all hosts.</p>
<p>The following resources are used to create the set of configuration files:</p>
<!--(SEP Guides) INTERNAL LINK: catalogs.html (113/106)-->
<table>
<colgroup>
<col style="width: 38%"/>
<col style="width: 63%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>File name and relative path</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">files/vars.yml</span></code></p></td>
<td><p>Contains variable definitions to use in the configuration files that are
templatized with Jinja2. These files use the <code class="docutils literal notranslate"><span class="pre">.j2</span></code> extension. Ansible uses
the set values and replaces the variable placeholders. For example, the
placeholder <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">raw</span> <span class="pre">%}{{node_environment}}{%</span> <span class="pre">endraw</span> <span class="pre">%}</span></code> is replaced with the
value <code class="docutils literal notranslate"><span class="pre">production</span></code> from <code class="docutils literal notranslate"><span class="pre">node_environment:</span> <span class="pre">production</span></code> <a class="external reference" href="../../data-engineer/catalogs.html">catalog properties
files</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">files/coordinator</span></code></p></td>
<td><p>Contains the configuration files for the coordinator.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">files/worker</span></code></p></td>
<td><p>Contains the configuration files used for all workers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">files/catalog</span></code></p></td>
<td><p>Contains the <a class="external reference" href="../../data-engineer/catalogs.html">catalog properties
files</a>, which define data
source connections.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">files/extra/etc</span></code></p></td>
<td><p>Includes additional files such as the <a class="reference internal" href="../installation/license-requirements.html"><span class="doc">license file</span></a>, as
well as other configuration files.  These files are placed in the directory
specified by the <code class="docutils literal notranslate"><span class="pre">etc_directory</span></code> Ansible playbook variable on all nodes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">files/extra/lib</span></code></p></td>
<td><p>Additional files that are placed in the <code class="docutils literal notranslate"><span class="pre">lib</span></code> directory on all nodes.
Typically, these are binary files or configuration files that are added to
the <code class="docutils literal notranslate"><span class="pre">classpath</span></code>, such as user-defined functions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">files/extra/plugin</span></code></p></td>
<td><p>Additional files that are placed in the <code class="docutils literal notranslate"><span class="pre">plugin</span></code> directory on all nodes.
Typically, these are complete directories with binaries, used for
custom-developed plugins, such as a security extension or a custom
connector.</p></td>
</tr>
</tbody>
</table>
<p>Any changes, including deletion of catalog files is synchronized to the hosts.</p>
<p>Starburst Admin automatically uses the folder name <code class="docutils literal notranslate"><span class="pre">starburst</span></code> for
SEP deployments and uses <code class="docutils literal notranslate"><span class="pre">trino</span></code> for Trino
deployments.</p>
<p>Other file deletions are not synchronized but can be performed with the <a class="external reference" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html">Ansible
file
module</a>.
For example, if you made a file <code class="docutils literal notranslate"><span class="pre">files/extra/etc/foo.sh</span></code>, the file is copied
into <code class="docutils literal notranslate"><span class="pre">/etc/starburst/foo.sh</span></code> on the hosts. You can use the following
command to delete it:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible all -m file -a <span class="s2">"path=/etc/starburst/foo.sh state=absent"</span>
</pre></div>
</div>
<p>The supported files and configuration methods are <a class="reference internal" href="../index.html"><span class="doc">identical to the general configuration files and properties from SEP</span></a> for the identical
version you
deploy with Starburst Admin.</p>
<p>After you created or updated all the configuration as desired, you can run the
playbook with the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/push-configs.yml
</pre></div>
</div>
<p>Keep in mind that most of the configuration files need to be distributed to all
nodes in the cluster and that they need to be identical for all workers.</p>
<p>The best approach to apply any new configuration involves the following steps:</p>
<ul class="simple">
<li><p>Ensure no users are active and <a class="reference internal" href="#pb-stop"><span class="std std-ref">stop</span></a> the cluster.</p></li>
<li><p>Alternatively <a class="reference internal" href="#pb-graceful-shutdown"><span class="std std-ref">shut it down gracefully</span></a>.</p></li>
<li><p>Update the configuration files.</p></li>
<li><p>Push the configuration.</p></li>
<li><p><a class="reference internal" href="#pb-start"><span class="std std-ref">Start</span></a> the cluster.</p></li>
<li><p>Verify the changes work.</p></li>
</ul>
<section id="automated-memory-configuration">
<span id="pb-auto-mem-config"></span><h3 id="automated-memory-configuration">Automated memory configuration<a class="headerlink" href="#automated-memory-configuration" title="Permalink to this heading">#</a></h3>
<p>For SEP versions 370-e and above, the <code class="docutils literal notranslate"><span class="pre">push-configs</span></code> playbook
optionally sets up SEP’s memory configuration properties for you
using the <code class="docutils literal notranslate"><span class="pre">memory_auto_config</span></code> section of the <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code> file. The values you
set are dependent upon the resources available in your cluster nodes:</p>
<p>In this example which assumes instances with 256GB of memory, automated memory
configuration is enabled, and the <code class="docutils literal notranslate"><span class="pre">total_memory</span></code> set at 245GB:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Memory Auto Configuration parameters</span>
<span class="nt">memory_auto_config</span><span class="p">:</span>
  <span class="nt">use_auto_config</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yes</span>
  <span class="nt">max_concurrent_queries</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
  <span class="nt">coordinator</span><span class="p">:</span>
    <span class="nt">total_memory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">245GB</span>
    <span class="nt">node_memory_headroom</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2GB</span>
    <span class="nt">heap_size_percentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">90</span>
    <span class="nt">heap_headroom_percentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
  <span class="nt">worker</span><span class="p">:</span>
    <span class="nt">total_memory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">245GB</span>
    <span class="nt">node_memory_headroom</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2GB</span>
    <span class="nt">heap_size_percentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">90</span>
    <span class="nt">heap_headroom_percentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We suggest using the default values provided in
the <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code> file for <code class="docutils literal notranslate"><span class="pre">heap_size_percentage</span></code> and <code class="docutils literal notranslate"><span class="pre">heap_headroom_percentage</span></code>.</p>
</div>
<p>The following table describes the available parameters in the
<code class="docutils literal notranslate"><span class="pre">memory_auto_config</span></code> YAML section:</p>
<table>
<colgroup>
<col style="width: 23%"/>
<col style="width: 38%"/>
<col style="width: 38%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Required?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_auto_config</span></code></p></td>
<td><p>Disabled by default. When set to <code class="docutils literal notranslate"><span class="pre">yes</span></code>, the <code class="docutils literal notranslate"><span class="pre">push-configs</span></code> playbook is
enabled, and requires valid settings for all memory configuration
parameters.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">max_concurrent_queries</span></code></p></td>
<td><p>Defines the maximum number of queries allowed to run simultaneously.</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">use_auto_config</span></code> is set to <code class="docutils literal notranslate"><span class="pre">yes</span></code>, this must be set.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">total_memory</span></code></p></td>
<td><p>Defines the amount of memory available on your cluster nodes nodes for
SEP to use. This must be expressed in a human-readable quantity such as
<code class="docutils literal notranslate"><span class="pre">30GB</span></code> or <code class="docutils literal notranslate"><span class="pre">100MB</span></code>.</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">use_auto_config</span></code> is set to <code class="docutils literal notranslate"><span class="pre">yes</span></code>, this must be set for both the
<code class="docutils literal notranslate"><span class="pre">coordinator</span></code> and <code class="docutils literal notranslate"><span class="pre">worker</span></code> YAML nodes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">node_memory_headroom</span></code></p></td>
<td><p>Defines the amount of memory to keep open beyond what SEP can use. This
must be expressed in a human-readable quantity such as <code class="docutils literal notranslate"><span class="pre">30GB</span></code> or <code class="docutils literal notranslate"><span class="pre">100MB</span></code>.</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">use_auto_config</span></code> is set to <code class="docutils literal notranslate"><span class="pre">yes</span></code>, this must be set for both the
<code class="docutils literal notranslate"><span class="pre">coordinator</span></code> and <code class="docutils literal notranslate"><span class="pre">worker</span></code> YAML nodes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">heap_size_percentage</span></code></p></td>
<td><p>Defines the percentage of the node’s memory to assign to the Java heap. This
must be expressed as an integer between 0 and 100.</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">use_auto_config</span></code> is set to <code class="docutils literal notranslate"><span class="pre">yes</span></code>, this must be set for both the
<code class="docutils literal notranslate"><span class="pre">coordinator</span></code> and <code class="docutils literal notranslate"><span class="pre">worker</span></code> YAML nodes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">heap_headroom_percentage</span></code></p></td>
<td><p>Defines the percentage of the Java heap to not be tracked by SEP. This
must be expressed as an integer between 0 and 100.</p></td>
<td><p>When <code class="docutils literal notranslate"><span class="pre">use_auto_config</span></code> is set to <code class="docutils literal notranslate"><span class="pre">yes</span></code>, this must be set for both the
<code class="docutils literal notranslate"><span class="pre">coordinator</span></code> and <code class="docutils literal notranslate"><span class="pre">worker</span></code> YAML nodes.</p></td>
</tr>
</tbody>
</table>
<p>When <code class="docutils literal notranslate"><span class="pre">use_auto_config</span></code> is set to “yes”, <code class="docutils literal notranslate"><span class="pre">push-configs</span></code> uses the memory
parameters to automatically calculate the following values:</p>
<table>
<colgroup>
<col style="width: 27%"/>
<col style="width: 27%"/>
<col style="width: 45%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Configuration file</p></th>
<th class="head"><p>Calculation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-Xmx</span></code></p></td>
<td><p><a class="reference internal" href="../admin/cache-service.html#cache-service-jvm-config"><span class="std std-ref">jvm.config</span></a></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">total_memory</span></code> * <code class="docutils literal notranslate"><span class="pre">heap_size_percentage</span></code> / 100 -
<code class="docutils literal notranslate"><span class="pre">node_memory_headroom</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-Xms</span></code></p></td>
<td><p><a class="reference internal" href="../admin/cache-service.html#cache-service-jvm-config"><span class="std std-ref">jvm.config</span></a></p></td>
<td><p>Set to the same value as <code class="docutils literal notranslate"><span class="pre">-Xmx</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">memory.heap-headroom-per-node</span></code></p></td>
<td><p><a class="reference internal" href="../admin/properties-resource-management.html"><span class="doc">config.properties</span></a></p></td>
<td><p>Set to (<code class="docutils literal notranslate"><span class="pre">-Xmx</span> </code> * <code class="docutils literal notranslate"><span class="pre">heap_headroom_percentage</span></code>) / 100.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">query.max-memory-per-node</span></code></p></td>
<td><p><a class="reference internal" href="../admin/properties-resource-management.html"><span class="doc">config.properties</span></a></p></td>
<td><p>Set to (<code class="docutils literal notranslate"><span class="pre">-Xmx</span></code> \ - <code class="docutils literal notranslate"><span class="pre">memory.heap-headroom-per-node</span></code>) /
<code class="docutils literal notranslate"><span class="pre">max_concurrent_queries</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">query.max-memory</span></code></p></td>
<td><p><a class="reference internal" href="../admin/properties-resource-management.html"><span class="doc">config.properties</span></a></p></td>
<td><p>Automatically set to <code class="docutils literal notranslate"><span class="pre">1PB</span></code> to limit the total memory consumed on very large
clusters.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="start-cluster">
<span id="pb-start"></span><h2 id="start-cluster">Start cluster<a class="headerlink" href="#start-cluster" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">start</span></code> playbook start the coordinator and all worker processes on the
hosts. It starts SEP the <code class="docutils literal notranslate"><span class="pre">service</span></code> command for RPM-based
installations or with the <code class="docutils literal notranslate"><span class="pre">launcher</span></code> script for tarball installation.</p>
<p>You need to <a class="reference internal" href="#pb-install"><span class="std std-ref">install the cluster</span></a> and <a class="reference internal" href="#pb-push-configs"><span class="std std-ref">push the configuration</span></a> before starting the cluster the first time.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/start.yml
</pre></div>
</div>
<p>The playbook relies on the hosts to be up and running and available to Ansible.
When restarting the hosts on the operating system or hardware level, the
RPM-based installation automatically starts the SEP processes.
The tarball installation does not start automatically. You can however configure
it to perform the start by using the <code class="docutils literal notranslate"><span class="pre">launcher</span></code> script as daemon script. Refer
to the documentation of your used Linux distribution for details.</p>
</section>
<section id="stop-cluster">
<span id="pb-stop"></span><h2 id="stop-cluster">Stop cluster<a class="headerlink" href="#stop-cluster" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">stop</span></code> playbook stops the coordinator and all worker processes on the hosts.
It does not take into account if SEP actively processes any
workload, and simply terminates.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/stop.yml
</pre></div>
</div>
<p>You can use the <a class="reference internal" href="#pb-graceful-shutdown"><span class="std std-ref">graceful shutdown</span></a> as an
alternative.</p>
</section>
<section id="restart-cluster">
<span id="pb-restart"></span><h2 id="restart-cluster">Restart cluster<a class="headerlink" href="#restart-cluster" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">restart</span></code> playbook stops and then starts the coordinator and all worker
processes on the hosts.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/restart.yml
</pre></div>
</div>
<p>It is equivalent to running the <code class="docutils literal notranslate"><span class="pre">stop</span></code> and the <code class="docutils literal notranslate"><span class="pre">start</span></code> playbook sequentially.</p>
</section>
<section id="check-service-status">
<span id="pb-check-status"></span><h2 id="check-service-status">Check service status<a class="headerlink" href="#check-service-status" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">check-status</span></code> playbook checks the status of the the coordinator and all
worker processes and displays the results.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/check-status.yml
</pre></div>
</div>
<p>The playbook uses the <code class="docutils literal notranslate"><span class="pre">init.d</span></code> script for the RPM-based installation or the
<code class="docutils literal notranslate"><span class="pre">launcher</span></code> script for a tarball installation to get the status of each service.
If the service is running, you see a log for each address in your inventory file
stating <code class="docutils literal notranslate"><span class="pre">Running</span> <span class="pre">as</span> <span class="pre">&lt;pid&gt;</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>TASK <span class="o">[</span>Print status<span class="o">]</span> ********
ok: <span class="o">[</span><span class="m">172</span>.28.0.2<span class="o">]</span> <span class="o">=</span>&gt; <span class="o">{</span>
    <span class="s2">"msg"</span>: <span class="s2">"Running as 1965"</span>
<span class="o">}</span>
ok: <span class="o">[</span><span class="m">172</span>.28.0.3<span class="o">]</span> <span class="o">=</span>&gt; <span class="o">{</span>
    <span class="s2">"msg"</span>: <span class="s2">"Running as 1901"</span>
<span class="o">}</span>
ok: <span class="o">[</span><span class="m">172</span>.28.0.4<span class="o">]</span> <span class="o">=</span>&gt; <span class="o">{</span>
    <span class="s2">"msg"</span>: <span class="s2">"Running as 1976"</span>
<span class="o">}</span>
</pre></div>
</div>
<p>If a service is not active, you see <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">running</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>TASK <span class="o">[</span>Print status<span class="o">]</span> ****
ok: <span class="o">[</span><span class="m">172</span>.28.0.2<span class="o">]</span> <span class="o">=</span>&gt; <span class="o">{</span>
    <span class="s2">"msg"</span>: <span class="s2">"Not running"</span>
<span class="o">}</span>
ok: <span class="o">[</span><span class="m">172</span>.28.0.3<span class="o">]</span> <span class="o">=</span>&gt; <span class="o">{</span>
    <span class="s2">"msg"</span>: <span class="s2">"Not running"</span>
<span class="o">}</span>
ok: <span class="o">[</span><span class="m">172</span>.28.0.4<span class="o">]</span> <span class="o">=</span>&gt; <span class="o">{</span>
    <span class="s2">"msg"</span>: <span class="s2">"Not running"</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="graceful-worker-shutdown">
<span id="pb-graceful-shutdown"></span><h2 id="graceful-worker-shutdown">Graceful worker shutdown<a class="headerlink" href="#graceful-worker-shutdown" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">graceful-shutdown</span></code> playbook stops the worker processes after all tasks are
completed.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/graceful-shutdown.yml
</pre></div>
</div>
<p>Using <a class="reference internal" href="../admin/graceful-shutdown.html"><span class="doc">graceful shutdown</span></a> takes
longer than using the <code class="docutils literal notranslate"><span class="pre">stop</span></code> playbook, because it allows workers to complete any
assigned work. If all workers are shut down, no further query processing is
performed by the cluster. The coordinator remains running at all times, until
manually shut down.</p>
</section>
<section id="rolling-worker-restart">
<span id="pb-rolling-restart-workers"></span><h2 id="rolling-worker-restart">Rolling worker restart<a class="headerlink" href="#rolling-worker-restart" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">rolling-restart-workers</span></code> playbook stops and starts all worker processes
sequentially one after the other using a <a class="reference internal" href="#pb-graceful-shutdown"><span class="std std-ref">graceful shutdown</span></a> and a new start.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/rolling-restart-workers.yml
</pre></div>
</div>
<p>You can configure the following variables in <code class="docutils literal notranslate"><span class="pre">files/vars.yml</span></code> to manage
graceful shutdowns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">graceful_shutdown_user</span></code> - user name to pass to the <code class="docutils literal notranslate"><span class="pre">X-Presto-User</span></code> or
<code class="docutils literal notranslate"><span class="pre">X-Trino-User</span></code> header when issuing the graceful shutdown request via the HTTP
API</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">graceful_shutdown_retries</span></code> -  number of times to check for successful
shutdown before failing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">graceful_shutdown_delay</span></code>- inactive duration between shutdown status checks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rolling_restart_concurrency</span></code> - number of workers to restart at the same time</p></li>
</ul>
<p>By default, the playbook waits up to 10 minutes for any individual worker to
stop and start. Each operation has a 10 minute timeout. If this timeout is
reached, then the playbook execution fails. If you have a longer shutdown
grace period configured, you may want to extend this timeout.</p>
<p>Keep in mind that this playbook does not change any configuration of the
workers. If you push configuration changes to the cluster before a rolling
restart, the cluster can be in an inconsistent state until the restart is
completed. This can lead to query failures and other issues. A simple addition
of a catalog file is possible. The new catalog only becomes usable after all
workers are restarted. Updates to catalog and other configuration files
typically result in problems.</p>
</section>
<section id="collect-logs">
<span id="pb-collect-logs"></span><h2 id="collect-logs">Collect logs<a class="headerlink" href="#collect-logs" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">collect-logs</span></code> playbook downloads the log files from all hosts to the
control machine.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/collect-logs.yml
</pre></div>
</div>
<p>The server, HTTP request, and launcher logs files from each host are copied into
<code class="docutils literal notranslate"><span class="pre">logs/coordinator-&lt;hostname&gt;</span></code> for the coordinator or <code class="docutils literal notranslate"><span class="pre">logs/worker-&lt;hostname&gt;</span></code>
for the workers in the current directory.</p>
</section>
<section id="collect-jstack-dump">
<span id="pb-collect-jstacks"></span><h2 id="collect-jstack-dump">Collect Jstack Dump<a class="headerlink" href="#collect-jstack-dump" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">collect-jstacks</span></code> playbook runs the
<a class="external reference" href="https://docs.oracle.com/en/java/javase/11/tools/jstack.html"><code class="docutils literal notranslate"><span class="pre">jstack</span></code></a>
command to capture the Java thread dump of the <code class="docutils literal notranslate"><span class="pre">StarburstTrinoServer</span></code> process on
all hosts, and download each dump to a local file on the control machine. The
playbook displays the local file name at the end of the play.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/collect-jstacks.yml
</pre></div>
</div>
</section>
<section id="uninstall-cluster">
<span id="pb-uninstall"></span><h2 id="uninstall-cluster">Uninstall cluster<a class="headerlink" href="#uninstall-cluster" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">uninstall</span></code> playbook removes all modifications made on the hosts by other
playbooks. <a class="reference internal" href="#pb-stop"><span class="std std-ref">Stop the cluster</span></a> before running the playbook.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ansible-playbook playbooks/uninstall.yml
</pre></div>
</div>
<p>The playbook deletes all data, configuration and log files. It also removes the
deployed binary packages and the created user accounts and groups.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
<div class="md-grid md-main__inner" style="height: auto;">
  <div class="md-content">
    <div class="feedback-container md-content__inner md-typeset">
      <div class="feedback-thumbs">
        <p>Is the information on this page helpful?</p>
        <p class="feedback-option" title="yes">Yes</p>
        <p class="feedback-option" title="no">No</p>
      </div>
      <div class="feedback-message">
        <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
        <button type="button" onclick="sendMessage()" class="feedback-button">Submit</button>
        <a onclick="skip()" class="feedback-skip">Skip</a>
      </div>
    </div>
  </div>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '');
</script>
<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="operation-guide.html" title="Operation guide"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Operation guide </span>
              </div>
            </a>
          
          
            <a href="release-notes.html" title="Release notes"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Release notes </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
<!-- custom footer should go here in time -->
<div class="page-footer">
  <div class="container md-grid">
    <div class="row">
      <div class="col-md-3">
        <p style="font-weight:900">Resources</p>
        <ul>
          <li class="footer-item"><a href="https://docs.starburst.io/latest/index.html">Starburst Enterprise reference documentation</a></li>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/starburst-intro-and-demo/" target="_blank">Join our weekly demos</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#!" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">

        <a href="https://www.starburst.io/" target="_blank">
          
            <img src="../_static/starburst_KO-T.png" height="26"
                  alt="Starburst Enterprise 426-e STS logo">
        
        </a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2023<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
  </div>
</div>
<script src="https://docs.starburst.io/latest/_static/algolia.js"></script>
<script src="https://docs.starburst.io/latest/_static/searchbox.js" data-versions="{'Latest LTS (423-e)': '/423-e/', '413-e LTS': '/413-e/', '407-e LTS': '/407-e/', '402-e LTS': '/402-e/', 'Latest STS (426-e)': '/426-e/', '422-e STS': '/422-e/'}"></script>
<script src="https://docs.starburst.io/latest/_static/searchresults.js" data-versions="{'Latest LTS (423-e)': '/423-e/', '413-e LTS': '/413-e/', '407-e LTS': '/407-e/', '402-e LTS': '/402-e/', 'Latest STS (426-e)': '/426-e/', '422-e STS': '/422-e/'}"></script>
  </body>
</html>