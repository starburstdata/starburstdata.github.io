

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9.9. Starburst Delta Lake Connector &mdash; Starburst Enterprise Presto</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Enterprise Presto" href="../index.html"/>
        <link rel="up" title="9. Connectors" href="../connector.html"/>
        <link rel="next" title="9.10. Starburst Kafka Connector" href="starburst-kafka.html"/>
        <link rel="prev" title="9.8. Starburst Hive MapR Connector" href="starburst-hive-mapr.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Enterprise Presto
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mission-control.html">3. Mission Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">4. Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">5. Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">6. Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">7. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">8. Query Optimizer</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../connector.html">9. Connectors</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="starburst-connectors.html">9.1. Starburst Connectors Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-db2.html">9.2. Starburst DB2 Connector (license required)</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-generic-jdbc.html">9.3. Starburst Generic JDBC Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-hive.html">9.4. Starburst Hive Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-hive-security.html">9.5. Starburst Hive Connector Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-hive-azurestorage.html">9.6. Azure Storage Support for the Hive Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-hive-ibm-cos.html">9.7. IBM Cloud Object Storage Support for the Hive Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-hive-mapr.html">9.8. Starburst Hive MapR Connector (license required)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9.9. Starburst Delta Lake Connector (license required)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authorization">Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delta-lake-specific-configuration-properties">Delta Lake-specific Configuration Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-tables">Creating Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#statistics">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-columns">Special Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="starburst-kafka.html">9.10. Starburst Kafka Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-mysql.html">9.11. Starburst MySQL Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-oracle.html">9.12. Starburst Oracle Connector (license required)</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-postgresql.html">9.13. Starburst PostgreSQL Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-snowflake.html">9.14. Starburst Snowflake Connector (license required)</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-sqlserver.html">9.15. Starburst SQL Server Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-teradata.html">9.16. Starburst Teradata Connector (license required)</a></li>
<li class="toctree-l2"><a class="reference internal" href="starburst-teradata-parallel-direct.html">9.17. Starburst Teradata Parallel Direct Connector (license required)</a></li>
<li class="toctree-l2"><a class="reference internal" href="accumulo.html">9.18. Accumulo Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="bigquery.html">9.19. BigQuery Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="blackhole.html">9.20. Black Hole Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra.html">9.21. Cassandra Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticsearch.html">9.22. Elasticsearch Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="googlesheets.html">9.23. Google Sheets Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="hive.html">9.24. Hive Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="hive-cache.html">9.25. Caching for Distributed Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="hive-gcs-tutorial.html">9.26. Hive Connector GCS Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="hive-security.html">9.27. Hive Security Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="jmx.html">9.28. JMX Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka.html">9.29. Kafka Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="kafka-tutorial.html">9.30. Kafka Connector Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="kinesis.html">9.31. Kinesis Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="kudu.html">9.32. Kudu Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="localfile.html">9.33. Local File Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">9.34. Memory Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodb.html">9.35. MongoDB Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="memsql.html">9.36. MemSQL Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="mysql.html">9.37. MySQL Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="oracle.html">9.38. Oracle Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="phoenix.html">9.39. Phoenix Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="pinot.html">9.40. Pinot Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="postgresql.html">9.41. PostgreSQL Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="prometheus.html">9.42. Prometheus Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="redis.html">9.43. Redis Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="redshift.html">9.44. Redshift Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqlserver.html">9.45. SQL Server Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="system.html">9.46. System Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="thrift.html">9.47. Thrift Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="tpcds.html">9.48. TPCDS Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="tpch.html">9.49. TPCH Connector</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">10. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">11. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">12. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">13. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">14. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">15. Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">16. Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../404.html">404 - Nothing to See Here</a></li>
</ul>

            
          

        </div>
        <div style="margin-top: 1em; margin-left: 2em;">
          Version <a href="../versions.html">334-e.0 STS and others</a>
          <br><br>
        <span>
  <select name="versions" id="versions" onChange="window.location.href=this.value">
    <option value="./">Choose another version</option>
    <option value="/332-e/">Latest LTS (332-e)</option>
    <option value="/334-e/">Latest STS (334-e)</option>
    <option value="/323-e/">323-e LTS</option>
    <option value="/312-e/">312-e LTS</option>
  </select>
</span>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://www.starburstdata.com/">
          <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px;"
          src="../_static/img/starburst-darkbg.png"/></a>
        <span class="optional">
          <a href="../index.html">Starburst Enterprise Presto</a>
          <a href="../versions.html" style="font-size: small;margin-left: 0.5em;">334-e.0 STS and others</a>
          <a href="https://www.starburstdata.com/oreilly-presto-guide-download/?utm_campaign=O%27Reilly%20Presto%20Book&utm_source=starburst&utm_medium=docs">
            <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px; margin-left: 0.5em;"
          src="../_static/img/ptdg-banner.png"/></a>
          </span>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../connector.html">9. Connectors</a> &raquo;</li>
      
    <li>9.9. Starburst Delta Lake Connector</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="starburst-delta-lake-connector">
<h1>9.9. Starburst Delta Lake Connector<a class="headerlink" href="#starburst-delta-lake-connector" title="Permalink to this headline">#</a></h1>
<p>The Delta Lake connector allows querying data stored in <a class="reference external" href="https://delta.io">Delta Lake</a> format, including <a class="reference external" href="https://docs.databricks.com/delta/index.html">Databricks Delta Lake</a>. It can natively read the Delta
transaction log and thus detect when external systems change data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This connector is currently available as beta release for usage on Azure
Storage. Google Cloud Storage is not yet supported. Deployments using AWS or
HDFS are fully supported. Work with the Starburst support team, if you are
planning to use this connector in production.</p>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#configuration" id="id2">Configuration</a></li>
<li><a class="reference internal" href="#authorization" id="id3">Authorization</a></li>
<li><a class="reference internal" href="#delta-lake-specific-configuration-properties" id="id4">Delta Lake-specific Configuration Properties</a></li>
<li><a class="reference internal" href="#creating-tables" id="id5">Creating Tables</a></li>
<li><a class="reference internal" href="#statistics" id="id6">Statistics</a></li>
<li><a class="reference internal" href="#special-columns" id="id7">Special Columns</a></li>
<li><a class="reference internal" href="#limitations" id="id8">Limitations</a></li>
</ul>
</div>
<div class="section" id="configuration">
<h2><a class="toc-backref" href="#id2">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this headline">#</a></h2>
<p>The connector requires a Hive metastore for table metadata and supports the same
metastore configuration properties as the <a class="reference internal" href="hive.html"><span class="doc">Hive connector</span></a>. At a minimum, <code class="docutils literal"><span class="pre">hive.metastore.uri</span></code> must be configured.</p>
<p>The connector recognizes Delta tables created in the metastore by the Databricks
runtime. If non-Delta tables are present in the metastore, as well, they will
not be visible to the connector.</p>
<p>To configure the Delta Lake connector, create a catalog file, for example
<code class="docutils literal"><span class="pre">etc/catalog/delta.properties</span></code>, that references the <code class="docutils literal"><span class="pre">delta-lake</span></code> connector.
Update the <code class="docutils literal"><span class="pre">hive.metastore.uri</span></code> with the URI of your Hive metastore Thrift
service:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">connector.name</span><span class="o">=</span><span class="s">delta-lake</span>
<span class="na">hive.metastore.uri</span><span class="o">=</span><span class="s">thrift://example.net:9083</span>
</pre></div>
</div>
<p>If you are using AWS Glue as Hive metastore, you can simply set the metastore to
<code class="docutils literal"><span class="pre">glue</span></code>:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">connector.name</span><span class="o">=</span><span class="s">delta-lake</span>
<span class="na">hive.metastore</span><span class="o">=</span><span class="s">glue</span>
</pre></div>
</div>
<p>The Delta Lake connector reuses certain functionalities from the Hive connector,
including the metastore thrift and glue configuration, detailed in the
<a class="reference internal" href="hive.html"><span class="doc">Hive connector documentation</span></a>.</p>
<p>To configure access to S3, S3-compatible storage, Azure storage, and others,
consult the Amazon S3 section of <a class="reference internal" href="hive.html"><span class="doc">Hive connector documentation</span></a> or <a class="reference internal" href="starburst-hive-azurestorage.html"><span class="doc">the Azure storage documentation</span></a>, respectively.</p>
</div>
<div class="section" id="authorization">
<h2><a class="toc-backref" href="#id3">Authorization</a><a class="headerlink" href="#authorization" title="Permalink to this headline">#</a></h2>
<p>The connector supports standard Hive security for authorization. For
configuration properties, see the ‘Authorization’ section in
<a class="reference internal" href="hive-security.html"><span class="doc">Hive Security Configuration</span></a>.</p>
</div>
<div class="section" id="delta-lake-specific-configuration-properties">
<h2><a class="toc-backref" href="#id4">Delta Lake-specific Configuration Properties</a><a class="headerlink" href="#delta-lake-specific-configuration-properties" title="Permalink to this headline">#</a></h2>
<table border="1" class="colwidths-given docutils" id="id1">
<caption><span class="caption-text">Configuration Properties</span><a class="headerlink" href="#id1" title="Permalink to this table">#</a></caption>
<colgroup>
<col width="15%" />
<col width="60%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property name</th>
<th class="head">Description</th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">delta.metadata.cache-ttl</span></code></td>
<td>How frequently the connector checks for new Delta transactions.</td>
<td>5 min</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">delta.metadata.live-files.cache-size</span></code></td>
<td>Amount of memory allocated for caching information about Delta files.</td>
<td>10% of the maximum memory allocated to the master node JVM</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="creating-tables">
<h2><a class="toc-backref" href="#id5">Creating Tables</a><a class="headerlink" href="#creating-tables" title="Permalink to this headline">#</a></h2>
<p>When Delta tables exist in storage, but not in the metastore, Presto can be used
to register them:</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">delta</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">my_table</span> <span class="p">(</span>
   <span class="n">dummy</span> <span class="nb">bigint</span>
 <span class="p">)</span>
<span class="k">WITH</span> <span class="p">(</span>
   <span class="k">location</span> <span class="o">=</span> <span class="s1">&#39;...&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that the columns listed in the DDL, such as <code class="docutils literal"><span class="pre">dummy</span></code> in the above example,
are ignored. The table schema is read from the transaction log, instead. If the
schema is changed by an external system, Presto automatically uses the new
schema.</p>
</div>
<div class="section" id="statistics">
<h2><a class="toc-backref" href="#id6">Statistics</a><a class="headerlink" href="#statistics" title="Permalink to this headline">#</a></h2>
<p>The Delta Lake specification defines a number of per file statistics that can be
included in the transaction log. When they are present, the connector uses them
to expose table and column level statistics, as documented in
<a class="reference internal" href="../optimizer/statistics.html"><span class="doc">Table Statistics</span></a>. Only the number of distinct values for a column is
not provided by the transaction log, and can therefore not be used for
<a class="reference internal" href="../optimizer/cost-based-optimizations.html"><span class="doc">cost based optimizations</span></a>. This
results in less efficient optimization.</p>
<p>The Databricks runtime automatically collects and records statistics, while they
are missing for tables created by the open source Delta Lake implementation.</p>
</div>
<div class="section" id="special-columns">
<h2><a class="toc-backref" href="#id7">Special Columns</a><a class="headerlink" href="#special-columns" title="Permalink to this headline">#</a></h2>
<p>In addition to the defined columns, the Delta Lake connector automatically exposes
metadata in a number of hidden columns in each table. You can use these columns
in your SQL statements like any other column, e.g., they can be selected
directly or used in conditional statements.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">$path</span></code></dt>
<dd>Full file system path name of the file for this row.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">$file_modified_time</span></code></dt>
<dd>Date and time of the last modification of the file for this row.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">$file_size</span></code></dt>
<dd>Size of the file for this row.</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="limitations">
<h2><a class="toc-backref" href="#id8">Limitations</a><a class="headerlink" href="#limitations" title="Permalink to this headline">#</a></h2>
<p>Inserting, removing and updating data is not supported. The connector does not
support DDL statements, with the exception of <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code>, as described
above, and <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">SCHEMA</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The column type <code class="docutils literal"><span class="pre">TIMESTAMP</span></code> in Delta Lake is currently mapped to
<code class="docutils literal"><span class="pre">TIMESTAMP</span></code> in Presto. In Delta Lake this type includes timezone
information, which is currently lost. An upcoming release changes the mapping
to the correct <code class="docutils literal"><span class="pre">TIMESTAMP</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code> type in Presto.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="starburst-kafka.html" style="box-shadow: none; border: none;" class="btn btn-neutral float-right" title="9.10. Starburst Kafka Connector" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="starburst-hive-mapr.html" style="box-shadow: none; border: none;" class="btn btn-neutral" title="9.8. Starburst Hive MapR Connector" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'334',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>