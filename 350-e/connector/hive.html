

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Hive Connector &#8212; Starburst Enterprise Presto</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/presto.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hive Connector Security Configuration" href="hive-security.html" />
    <link rel="prev" title="Google Sheets Connector" href="googlesheets.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#connector/hive" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Starburst Enterprise Presto"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise Presto logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise Presto</span>
          <span class="md-header-nav__topic"> Hive Connector </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (350-e)" href="/350-e/">Latest LTS (350-e)</a>
      
          <a title="345-e LTS" href="/345-e/">345-e LTS</a>
      
          <a title="338-e LTS" href="/338-e/">338-e LTS</a>
      
          <a title="332-e LTS" href="/332-e/">332-e LTS</a>
      
          <a title="Latest STS (348-e)" href="/348-e/">Latest STS (348-e)</a>
      
          <a title="347-e STS" href="/347-e/">347-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../connector.html" class="md-tabs__link">Connectors</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise Presto" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise Presto">Starburst Enterprise Presto</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Kubernetes with Helm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../kubernetes.html" class="md-nav__link">Kubernetes operator</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../insights.html" class="md-nav__link">Insights</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="starburst-connectors.html" class="md-nav__link">SEP connectors overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-db2.html" class="md-nav__link">Starburst IBM DB2 connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-generic-jdbc.html" class="md-nav__link">Starburst Generic JDBC connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-greenplum.html" class="md-nav__link">Starburst Greenplum connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-hive.html" class="md-nav__link">Starburst Hive connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-hive-ibm-cos.html" class="md-nav__link">IBM Cloud Object Storage support for the Hive connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-hive-mapr.html" class="md-nav__link">MapR Hive support</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-hive-cdp.html" class="md-nav__link">Cloudera Data Platform support</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-delta-lake.html" class="md-nav__link">Starburst Delta Lake connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-kafka.html" class="md-nav__link">Starburst Kafka connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-memsql.html" class="md-nav__link">Starburst MemSQL connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-mysql.html" class="md-nav__link">Starburst MySQL connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-oracle.html" class="md-nav__link">Starburst Oracle connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-postgresql.html" class="md-nav__link">Starburst PostgreSQL connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-sap-hana.html" class="md-nav__link">Starburst SAP HANA connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-snowflake.html" class="md-nav__link">Starburst Snowflake connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-sqlserver.html" class="md-nav__link">Starburst SQL Server connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-redshift.html" class="md-nav__link">Starburst Redshift connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-teradata.html" class="md-nav__link">Starburst Teradata connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="starburst-base-jdbc.html" class="md-nav__link">Starburst JDBC connector base</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="accumulo.html" class="md-nav__link">Accumulo connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="bigquery.html" class="md-nav__link">BigQuery connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="blackhole.html" class="md-nav__link">Black hole connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cassandra.html" class="md-nav__link">Cassandra connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="druid.html" class="md-nav__link">Druid connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="elasticsearch.html" class="md-nav__link">Elasticsearch connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="googlesheets.html" class="md-nav__link">Google Sheets connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Hive connector </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Hive connector</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#connector-hive--page-root" class="md-nav__link">Hive Connector</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#overview" class="md-nav__link">Overview</a>
        </li>
        <li class="md-nav__item"><a href="#requirements" class="md-nav__link">Requirements</a>
        </li>
        <li class="md-nav__item"><a href="#supported-file-types" class="md-nav__link">Supported File Types</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#metastore-configuration-for-avro" class="md-nav__link">Metastore Configuration for Avro</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#supported-table-types" class="md-nav__link">Supported Table Types</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#transactional-and-acid-tables" class="md-nav__link">Transactional and ACID Tables</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#materialized-views" class="md-nav__link">Materialized Views</a>
        </li>
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#multiple-hive-clusters" class="md-nav__link">Multiple Hive Clusters</a>
        </li>
        <li class="md-nav__item"><a href="#hdfs-configuration" class="md-nav__link">HDFS Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#hdfs-username-and-permissions" class="md-nav__link">HDFS Username and Permissions</a>
        </li>
        <li class="md-nav__item"><a href="#accessing-hadoop-clusters-protected-with-kerberos-authentication" class="md-nav__link">Accessing Hadoop clusters protected with Kerberos authentication</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#hive-configuration-properties" class="md-nav__link">Hive Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#metastore-configuration-properties" class="md-nav__link">Metastore Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#thrift-metastore-configuration-properties" class="md-nav__link">Thrift Metastore Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#aws-glue-catalog-configuration-properties" class="md-nav__link">AWS Glue Catalog Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#google-cloud-storage-configuration" class="md-nav__link">Google Cloud Storage Configuration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#gcs-configuration-properties" class="md-nav__link">GCS Configuration properties</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#table-statistics" class="md-nav__link">Table Statistics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#updating-table-and-partition-statistics" class="md-nav__link">Updating table and partition statistics</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#dynamic-filtering" class="md-nav__link">Dynamic Filtering</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#delaying-execution-for-dynamic-filters" class="md-nav__link">Delaying execution for dynamic filters</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#schema-evolution" class="md-nav__link">Schema Evolution</a>
        </li>
        <li class="md-nav__item"><a href="#avro-schema-evolution" class="md-nav__link">Avro Schema Evolution</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#limitations" class="md-nav__link">Limitations</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#procedures" class="md-nav__link">Procedures</a>
        </li>
        <li class="md-nav__item"><a href="#special-columns" class="md-nav__link">Special Columns</a>
        </li>
        <li class="md-nav__item"><a href="#special-tables" class="md-nav__link">Special Tables</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#table-properties" class="md-nav__link">Table Properties</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#examples" class="md-nav__link">Examples</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#cleaning-up" class="md-nav__link">Cleaning up</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#hive-connector-limitations" class="md-nav__link">Hive Connector Limitations</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hive-3-related-limitations" class="md-nav__link">Hive 3 Related Limitations</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="hive-security.html" class="md-nav__link">Security</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-s3.html" class="md-nav__link">Amazon S3</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-azure.html" class="md-nav__link">Azure Storage</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-gcs-tutorial.html" class="md-nav__link">GCS Tutorial</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-caching.html" class="md-nav__link">Storage Caching</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-alluxio.html" class="md-nav__link">Alluxio</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="jmx.html" class="md-nav__link">JMX connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="iceberg.html" class="md-nav__link">Iceberg connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kafka.html" class="md-nav__link">Kafka connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kinesis.html" class="md-nav__link">Kinesis connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kudu.html" class="md-nav__link">Kudu connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="localfile.html" class="md-nav__link">Local file connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="memory.html" class="md-nav__link">Memory connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mongodb.html" class="md-nav__link">MongoDB connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="memsql.html" class="md-nav__link">MemSQL connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mysql.html" class="md-nav__link">MySQL connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="oracle.html" class="md-nav__link">Oracle connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="phoenix.html" class="md-nav__link">Phoenix connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pinot.html" class="md-nav__link">Pinot connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="postgresql.html" class="md-nav__link">PostgreSQL connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="prometheus.html" class="md-nav__link">Prometheus connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="redis.html" class="md-nav__link">Redis connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="redshift.html" class="md-nav__link">Redshift connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sqlserver.html" class="md-nav__link">SQL Server connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="system.html" class="md-nav__link">System connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="thrift.html" class="md-nav__link">Thrift connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tpcds.html" class="md-nav__link">TPCDS connector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tpch.html" class="md-nav__link">TPCH connector</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../migration.html" class="md-nav__link">Migration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">350-e LTS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">&nbsp;</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#connector-hive--page-root" class="md-nav__link">Hive Connector</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#overview" class="md-nav__link">Overview</a>
        </li>
        <li class="md-nav__item"><a href="#requirements" class="md-nav__link">Requirements</a>
        </li>
        <li class="md-nav__item"><a href="#supported-file-types" class="md-nav__link">Supported File Types</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#metastore-configuration-for-avro" class="md-nav__link">Metastore Configuration for Avro</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#supported-table-types" class="md-nav__link">Supported Table Types</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#transactional-and-acid-tables" class="md-nav__link">Transactional and ACID Tables</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#materialized-views" class="md-nav__link">Materialized Views</a>
        </li>
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#multiple-hive-clusters" class="md-nav__link">Multiple Hive Clusters</a>
        </li>
        <li class="md-nav__item"><a href="#hdfs-configuration" class="md-nav__link">HDFS Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#hdfs-username-and-permissions" class="md-nav__link">HDFS Username and Permissions</a>
        </li>
        <li class="md-nav__item"><a href="#accessing-hadoop-clusters-protected-with-kerberos-authentication" class="md-nav__link">Accessing Hadoop clusters protected with Kerberos authentication</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#hive-configuration-properties" class="md-nav__link">Hive Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#metastore-configuration-properties" class="md-nav__link">Metastore Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#thrift-metastore-configuration-properties" class="md-nav__link">Thrift Metastore Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#aws-glue-catalog-configuration-properties" class="md-nav__link">AWS Glue Catalog Configuration Properties</a>
        </li>
        <li class="md-nav__item"><a href="#google-cloud-storage-configuration" class="md-nav__link">Google Cloud Storage Configuration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#gcs-configuration-properties" class="md-nav__link">GCS Configuration properties</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#table-statistics" class="md-nav__link">Table Statistics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#updating-table-and-partition-statistics" class="md-nav__link">Updating table and partition statistics</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#dynamic-filtering" class="md-nav__link">Dynamic Filtering</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#delaying-execution-for-dynamic-filters" class="md-nav__link">Delaying execution for dynamic filters</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#schema-evolution" class="md-nav__link">Schema Evolution</a>
        </li>
        <li class="md-nav__item"><a href="#avro-schema-evolution" class="md-nav__link">Avro Schema Evolution</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#limitations" class="md-nav__link">Limitations</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#procedures" class="md-nav__link">Procedures</a>
        </li>
        <li class="md-nav__item"><a href="#special-columns" class="md-nav__link">Special Columns</a>
        </li>
        <li class="md-nav__item"><a href="#special-tables" class="md-nav__link">Special Tables</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#table-properties" class="md-nav__link">Table Properties</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#examples" class="md-nav__link">Examples</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#cleaning-up" class="md-nav__link">Cleaning up</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#hive-connector-limitations" class="md-nav__link">Hive Connector Limitations</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hive-3-related-limitations" class="md-nav__link">Hive 3 Related Limitations</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="connector-hive--page-root">Hive Connector<a class="headerlink" href="#connector-hive--page-root" title="Permalink to this headline">#</a></h1>
<div class="toctree-wrapper compound">
</div>

<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permalink to this headline">#</a></h2>
<p>The Hive connector allows querying data stored in an
<a class="reference external" href="https://hive.apache.org/">Apache Hive</a>
data warehouse. Hive is a combination of three components:</p>
<ul class="simple">
<li><p>Data files in varying formats, that are typically stored in the
Hadoop Distributed File System (HDFS) or in object storage systems
such as Amazon S3.</p></li>
<li><p>Metadata about how the data files are mapped to schemas and tables.
This metadata is stored in a database, such as MySQL, and is accessed
via the Hive metastore service.</p></li>
<li><p>A query language called HiveQL. This query language is executed
on a distributed computing framework such as MapReduce or Tez.</p></li>
</ul>
<p>Presto only uses the first two components: the data and the metadata.
It does not use HiveQL or any part of Hiveâ€™s execution environment.</p>


<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">#</a></h2>
<p>The Hive connector requires a Hive metastore service (HMS), or a compatible
implementation of the Hive metastore, such as
<a class="reference external" href="https://aws.amazon.com/glue/">AWS Glue Data Catalog</a>.</p>
<p>Apache Hadoop 2.x and 3.x are supported, along with derivative distributions,
including Cloudera CDH 5 and Hortonworks Data Platform (HDP).</p>
<p>Many distributed storage systems including HDFS,
<a class="reference internal" href="hive-s3.html"><span class="doc">Amazon S3</span></a> or S3-compatible systems,
<a class="reference external" href="#google-cloud-storage-configuration">Google Cloud Storage</a>,
and <a class="reference internal" href="hive-azure.html"><span class="doc">Azure Storage</span></a>.</p>
<p>The coordinator and all workers must have network access to the Hive metastore
and the storage system.</p>


<h2 id="supported-file-types">Supported File Types<a class="headerlink" href="#supported-file-types" title="Permalink to this headline">#</a></h2>
<p>The following file types are supported for the Hive connector:</p>
<ul class="simple">
<li><p>ORC</p></li>
<li><p>Parquet</p></li>
<li><p>Avro</p></li>
<li><p>RCText (RCFile using <code class="docutils literal notranslate"><span class="pre">ColumnarSerDe</span></code>)</p></li>
<li><p>RCBinary (RCFile using <code class="docutils literal notranslate"><span class="pre">LazyBinaryColumnarSerDe</span></code>)</p></li>
<li><p>SequenceFile</p></li>
<li><p>JSON (using <code class="docutils literal notranslate"><span class="pre">org.apache.hive.hcatalog.data.JsonSerDe</span></code>)</p></li>
<li><p>CSV (using <code class="docutils literal notranslate"><span class="pre">org.apache.hadoop.hive.serde2.OpenCSVSerde</span></code>)</p></li>
<li><p>TextFile</p></li>
</ul>

<h3 id="metastore-configuration-for-avro">Metastore Configuration for Avro<a class="headerlink" href="#metastore-configuration-for-avro" title="Permalink to this headline">#</a></h3>
<p>In order to enable first-class support for Avro tables when using
Hive 3.x, you need to add the following property definition to the Hive metastore
configuration file <code class="docutils literal notranslate"><span class="pre">hive-site.xml</span></code> (and restart the metastore service):</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;property&gt;</span>
     <span class="c">&lt;!-- https://community.hortonworks.com/content/supportkb/247055/errorjavalangunsupportedoperationexception-storage.html --&gt;</span>
     <span class="nt">&lt;name&gt;</span>metastore.storage.schema.reader.impl<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;value&gt;</span>org.apache.hadoop.hive.metastore.SerDeStorageSchemaReader<span class="nt">&lt;/value&gt;</span>
 <span class="nt">&lt;/property&gt;</span>
</pre></div>
</div>



<h2 id="supported-table-types">Supported Table Types<a class="headerlink" href="#supported-table-types" title="Permalink to this headline">#</a></h2>

<h3 id="transactional-and-acid-tables">Transactional and ACID Tables<a class="headerlink" href="#transactional-and-acid-tables" title="Permalink to this headline">#</a></h3>
<p>When connecting to a Hive metastore version 3.x, the Hive connector supports
reading from and writing to insert-only and ACID tables, with full support for
partitioning and bucketing. Row-level deletes are supported for ACID tables.</p>
<p>ACID tables created with <a class="reference external" href="https://cwiki.apache.org/confluence/display/Hive/Streaming+Data+Ingest">Hive Streaming Ingest</a>
are not supported.</p>



<h2 id="materialized-views">Materialized Views<a class="headerlink" href="#materialized-views" title="Permalink to this headline">#</a></h2>
<p>The Hive connector supports reading from Hive materialized views.
In Presto, these views are presented as regular, read-only tables.</p>


<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">#</a></h2>
<p>Create <code class="docutils literal notranslate"><span class="pre">etc/catalog/hive.properties</span></code> with the following contents
to mount the <code class="docutils literal notranslate"><span class="pre">hive-hadoop2</span></code> connector as the <code class="docutils literal notranslate"><span class="pre">hive</span></code> catalog,
replacing <code class="docutils literal notranslate"><span class="pre">example.net:9083</span></code> with the correct host and port
for your Hive metastore Thrift service:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>connector.name=hive-hadoop2
hive.metastore.uri=thrift://example.net:9083
</pre></div>
</div>

<h3 id="multiple-hive-clusters">Multiple Hive Clusters<a class="headerlink" href="#multiple-hive-clusters" title="Permalink to this headline">#</a></h3>
<p>You can have as many catalogs as you need, so if you have additional
Hive clusters, simply add another properties file to <code class="docutils literal notranslate"><span class="pre">etc/catalog</span></code>
with a different name, making sure it ends in <code class="docutils literal notranslate"><span class="pre">.properties</span></code>. For
example, if you name the property file <code class="docutils literal notranslate"><span class="pre">sales.properties</span></code>, Presto
creates a catalog named <code class="docutils literal notranslate"><span class="pre">sales</span></code> using the configured connector.</p>


<h3 id="hdfs-configuration">HDFS Configuration<a class="headerlink" href="#hdfs-configuration" title="Permalink to this headline">#</a></h3>
<p>For basic setups, Presto configures the HDFS client automatically and
does not require any configuration files. In some cases, such as when using
federated HDFS or NameNode high availability, it is necessary to specify
additional HDFS client options in order to access your HDFS cluster. To do so,
add the <code class="docutils literal notranslate"><span class="pre">hive.config.resources</span></code> property to reference your HDFS config files:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>hive.config.resources=/etc/hadoop/conf/core-site.xml,/etc/hadoop/conf/hdfs-site.xml
</pre></div>
</div>
<p>Only specify additional configuration files if necessary for your setup.
We recommend reducing the configuration files to have the minimum
set of required properties, as additional properties may cause problems.</p>
<p>The configuration files must exist on all Presto nodes. If you are
referencing existing Hadoop config files, make sure to copy them to
any Presto nodes that are not running Hadoop.</p>


<h3 id="hdfs-username-and-permissions">HDFS Username and Permissions<a class="headerlink" href="#hdfs-username-and-permissions" title="Permalink to this headline">#</a></h3>
<p>Before running any <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> or <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span> <span class="pre">AS</span></code> statements
for Hive tables in Presto, you need to check that the user Presto is
using to access HDFS has access to the Hive warehouse directory. The Hive
warehouse directory is specified by the configuration variable
<code class="docutils literal notranslate"><span class="pre">hive.metastore.warehouse.dir</span></code> in <code class="docutils literal notranslate"><span class="pre">hive-site.xml</span></code>, and the default
value is <code class="docutils literal notranslate"><span class="pre">/user/hive/warehouse</span></code>.</p>
<p>When not using Kerberos with HDFS, Presto accesses HDFS using the
OS user of the Presto process. For example, if Presto is running as
<code class="docutils literal notranslate"><span class="pre">nobody</span></code>, it accesses HDFS as <code class="docutils literal notranslate"><span class="pre">nobody</span></code>. You can override this
username by setting the <code class="docutils literal notranslate"><span class="pre">HADOOP_USER_NAME</span></code> system property in the
Presto <a class="reference internal" href="../installation/deployment.html#presto-jvm-config"><span class="std std-ref">JVM Config</span></a>, replacing <code class="docutils literal notranslate"><span class="pre">hdfs_user</span></code> with the
appropriate username:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-DHADOOP_USER_NAME=hdfs_user
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">hive</span></code> user generally works, since Hive is often started with
the <code class="docutils literal notranslate"><span class="pre">hive</span></code> user and this user has access to the Hive warehouse.</p>
<p>Whenever you change the user Presto is using to access HDFS, remove
<code class="docutils literal notranslate"><span class="pre">/tmp/presto-*</span></code> on HDFS, as the new user may not have access to
the existing temporary directories.</p>


<h3 id="accessing-hadoop-clusters-protected-with-kerberos-authentication">Accessing Hadoop clusters protected with Kerberos authentication<a class="headerlink" href="#accessing-hadoop-clusters-protected-with-kerberos-authentication" title="Permalink to this headline">#</a></h3>
<p>Kerberos authentication is supported for both HDFS and the Hive metastore.
However, Kerberos authentication by ticket cache is not yet supported.</p>
<p>The properties that apply to Hive connector security are listed in the
<a class="reference internal" href="#id1">Hive Configuration Properties</a> table. Please see the
<a class="reference internal" href="hive-security.html"><span class="doc">Hive Connector Security Configuration</span></a> section for a more detailed discussion of the
security options in the Hive connector.</p>



<span id="id1"></span><h2 id="hive-configuration-properties">Hive Configuration Properties<a class="headerlink" href="#hive-configuration-properties" title="Permalink to this headline">#</a></h2>
<table>
<colgroup>
<col style="width: 40%"/>
<col style="width: 48%"/>
<col style="width: 13%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.config.resources</span></code></p></td>
<td><p>An optional comma-separated list of HDFS
configuration files. These files must exist on the
machines running Presto. Only specify this if
absolutely necessary to access HDFS.
Example: <code class="docutils literal notranslate"><span class="pre">/etc/hdfs-site.xml</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.recursive-directories</span></code></p></td>
<td><p>Enable reading data from subdirectories of table or
partition locations. If disabled, subdirectories are
ignored. This is equivalent to the
<code class="docutils literal notranslate"><span class="pre">hive.mapred.supports.subdirectories</span></code> property in Hive.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.ignore-absent-partitions</span></code></p></td>
<td><p>Ignore partitions when the file system location does not
exist rather than failing the query. This skips data that
may be expected to be part of the table.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.storage-format</span></code></p></td>
<td><p>The default file format used when creating new tables.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ORC</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.compression-codec</span></code></p></td>
<td><p>The compression codec to use when writing files.
Possible values are <code class="docutils literal notranslate"><span class="pre">NONE</span></code>, <code class="docutils literal notranslate"><span class="pre">SNAPPY</span></code>, <code class="docutils literal notranslate"><span class="pre">LZ4</span></code>,
<code class="docutils literal notranslate"><span class="pre">ZSTD</span></code>, or <code class="docutils literal notranslate"><span class="pre">GZIP</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GZIP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.force-local-scheduling</span></code></p></td>
<td><p>Force splits to be scheduled on the same node as the Hadoop
DataNode process serving the split data.  This is useful for
installations where Presto is collocated with every
DataNode.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.respect-table-format</span></code></p></td>
<td><p>Should new partitions be written using the existing table
format or the default Presto format?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.immutable-partitions</span></code></p></td>
<td><p>Can new data be inserted into existing partitions?
If <code class="docutils literal notranslate"><span class="pre">true</span></code> then setting
<code class="docutils literal notranslate"><span class="pre">hive.insert-existing-partitions-behavior</span></code> to <code class="docutils literal notranslate"><span class="pre">APPEND</span></code>
is not allowed.
This also affects the
<code class="docutils literal notranslate"><span class="pre">insert_existing_partitions_behavior</span></code>
session property in the same way.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.insert-existing-partitions-behavior</span></code></p></td>
<td><p>What happens when data is inserted into an existing
partition?
Possible values are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">APPEND</span></code> - appends data to existing partitions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code> - overwrites existing partitions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ERROR</span></code> - modifying existing partitions is not allowed</p></li>
</ul>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">APPEND</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.create-empty-bucket-files</span></code></p></td>
<td><p>Should empty files be created for buckets that have no data?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.max-partitions-per-writers</span></code></p></td>
<td><p>Maximum number of partitions per writer.</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.max-partitions-per-scan</span></code></p></td>
<td><p>Maximum number of partitions for a single table scan.</p></td>
<td><p>100,000</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.hdfs.authentication.type</span></code></p></td>
<td><p>HDFS authentication type.
Possible values are <code class="docutils literal notranslate"><span class="pre">NONE</span></code> or <code class="docutils literal notranslate"><span class="pre">KERBEROS</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NONE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.hdfs.impersonation.enabled</span></code></p></td>
<td><p>Enable HDFS end user impersonation.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.hdfs.presto.principal</span></code></p></td>
<td><p>The Kerberos principal that Presto will use when connecting
to HDFS.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.hdfs.presto.keytab</span></code></p></td>
<td><p>HDFS client keytab location.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.dfs.replication</span></code></p></td>
<td><p>Hadoop file system replication factor.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.security</span></code></p></td>
<td><p>See <a class="reference internal" href="hive-security.html"><span class="doc">Hive Connector Security Configuration</span></a>.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">security.config-file</span></code></p></td>
<td><p>Path of config file to use when <code class="docutils literal notranslate"><span class="pre">hive.security=file</span></code>.
See <a class="reference internal" href="hive-security.html#hive-file-based-authorization"><span class="std std-ref">File Based Authorization</span></a> for details.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.non-managed-table-writes-enabled</span></code></p></td>
<td><p>Enable writes to non-managed (external) Hive tables.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.non-managed-table-creates-enabled</span></code></p></td>
<td><p>Enable creating non-managed (external) Hive tables.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.collect-column-statistics-on-write</span></code></p></td>
<td><p>Enables automatic column level statistics collection
on write. See <a class="reference external" href="#table-statistics">Table Statistics</a> for
details.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3select-pushdown.enabled</span></code></p></td>
<td><p>Enable query pushdown to AWS S3 Select service.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.s3select-pushdown.max-connections</span></code></p></td>
<td><p>Maximum number of simultaneously open connections to S3 for
<a class="reference internal" href="hive-s3.html#s3selectpushdown"><span class="std std-ref">S3 Select Pushdown</span></a>.</p></td>
<td><p>500</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.file-status-cache-tables</span></code></p></td>
<td><p>Cache directory listing for specific tables. Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fruit.apple,fruit.orange</span></code> to cache listings only for
tables <code class="docutils literal notranslate"><span class="pre">apple</span></code> and <code class="docutils literal notranslate"><span class="pre">orange</span></code> in schema <code class="docutils literal notranslate"><span class="pre">fruit</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fruit.*,vegetable.*</span></code> to cache listings for all tables
in schemas <code class="docutils literal notranslate"><span class="pre">fruit</span></code> and <code class="docutils literal notranslate"><span class="pre">vegetable</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*</span></code> to cache listings for all tables in all schemas</p></li>
</ul>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.file-status-cache-size</span></code></p></td>
<td><p>Maximum total number of cached file status entries.</p></td>
<td><p>1,000,000</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.file-status-cache-expire-time</span></code></p></td>
<td><p>How long a cached directory listing should be considered
valid.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1m</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.parquet.time-zone</span></code></p></td>
<td><p>Adjusts timestamp values to a specific time zone.
For Hive 3.1+, this should be set to UTC.</p></td>
<td><p>JVM default</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.rcfile.time-zone</span></code></p></td>
<td><p>Adjusts binary encoded timestamp values to a specific
time zone. For Hive 3.1+, this should be set to UTC.</p></td>
<td><p>JVM default</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.orc.time-zone</span></code></p></td>
<td><p>Sets the default time zone for legacy ORC files that did
not declare a time zone.</p></td>
<td><p>JVM default</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.timestamp-precision</span></code></p></td>
<td><p>Specifies the precision to use for columns of type
<code class="docutils literal notranslate"><span class="pre">timestamp</span></code>. Possible values are <code class="docutils literal notranslate"><span class="pre">MILLISECONDS</span></code>,
<code class="docutils literal notranslate"><span class="pre">MICROSECONDS</span></code> and <code class="docutils literal notranslate"><span class="pre">NANOSECONDS</span></code>. Write operations
are only supported for <code class="docutils literal notranslate"><span class="pre">MILLISECONDS</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MILLISECONDS</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.temporary-staging-directory-enabled</span></code></p></td>
<td><p>Controls whether the temporary staging directory configured
at <code class="docutils literal notranslate"><span class="pre">hive.temporary-staging-directory-path</span></code> should be
used for write operations. Temporary staging directory is
never used for writes to non-sorted tables on S3,
encrypted HDFS or external location. Writes to sorted tables
will utilize this path for staging temporary files
during sorting operation. When disabled, the target storage
will be used for staging while writing sorted tables which
can be inefficient when writing to object stores like S3.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.temporary-staging-directory-path</span></code></p></td>
<td><p>Controls the location of temporary staging directory that
is used for write operations. The <code class="docutils literal notranslate"><span class="pre">${USER}</span></code> placeholder
can be used to use a different location for each user.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/tmp/${USER}</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.translate-hive-views</span></code></p></td>
<td><p>Enable translation for Hive views. (experimental)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.legacy-hive-view-translation</span></code></p></td>
<td><p>Use the legacy algorithm to translate Hive views. You can
alternatively set the <code class="docutils literal notranslate"><span class="pre">legacy_hive_view_translation</span></code>
session property to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
</tbody>
</table>


<h2 id="metastore-configuration-properties">Metastore Configuration Properties<a class="headerlink" href="#metastore-configuration-properties" title="Permalink to this headline">#</a></h2>
<p>The required Hive metastore can be configured with a number of properties.
Specific properties can be used to further configure the
<a class="reference external" href="#thrift-metastore-configuration-properties">Thrift</a> or
<a class="reference external" href="#aws-glue-catalog-configuration-properties">Glue</a> metastore.</p>
<table>
<colgroup>
<col style="width: 35%"/>
<col style="width: 54%"/>
<col style="width: 11%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore</span></code></p></td>
<td><p>The type of Hive metastore to use. Presto currently supports
the default Hive Thrift metastore (<code class="docutils literal notranslate"><span class="pre">thrift</span></code>), and the AWS
Glue Catalog (<code class="docutils literal notranslate"><span class="pre">glue</span></code>) as metadata sources.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">thrift</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore-cache-ttl</span></code></p></td>
<td><p>Duration how long cached metastore data should be considered
valid.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0s</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore-cache-maximum-size</span></code></p></td>
<td><p>Hive metastore cache maximum size.</p></td>
<td><p>10000</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore-refresh-interval</span></code></p></td>
<td><p>Asynchronously refresh cached metastore data after access
if it is older than this but is not yet expired, allowing
subsequent accesses to see fresh data.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore-refresh-max-threads</span></code></p></td>
<td><p>Maximum threads used to refresh cached metastore data.</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore-timeout</span></code></p></td>
<td><p>Timeout for Hive metastore requests.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10s</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.hide-delta-lake-tables</span></code></p></td>
<td><p>Controls whether to hide Delta Lake tables in table
listings. Currently applies only when using the AWS Glue
metastore.</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>


<h2 id="thrift-metastore-configuration-properties">Thrift Metastore Configuration Properties<a class="headerlink" href="#thrift-metastore-configuration-properties" title="Permalink to this headline">#</a></h2>
<table>
<colgroup>
<col style="width: 47%"/>
<col style="width: 44%"/>
<col style="width: 9%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.uri</span></code></p></td>
<td><p>The URI(s) of the Hive metastore to connect to using the
Thrift protocol. If multiple URIs are provided, the first
URI is used by default, and the rest of the URIs are
fallback metastores. This property is required.
Example: <code class="docutils literal notranslate"><span class="pre">thrift://192.0.2.3:9083</span></code> or
<code class="docutils literal notranslate"><span class="pre">thrift://192.0.2.3:9083,thrift://192.0.2.4:9083</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.username</span></code></p></td>
<td><p>The username Presto uses to access the Hive metastore.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.authentication.type</span></code></p></td>
<td><p>Hive metastore authentication type.
Possible values are <code class="docutils literal notranslate"><span class="pre">NONE</span></code> or <code class="docutils literal notranslate"><span class="pre">KERBEROS</span></code>
(defaults to <code class="docutils literal notranslate"><span class="pre">NONE</span></code>).</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.impersonation.enabled</span></code></p></td>
<td><p>Enable Hive metastore end user impersonation.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.delegation-token.cache-ttl</span></code></p></td>
<td><p>Time to live delegation token cache for metastore.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1h</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.delegation-token.cache-maximum-size</span></code></p></td>
<td><p>Delegation token cache maximum size.</p></td>
<td><p>1,000</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.client.ssl.enabled</span></code></p></td>
<td><p>Use SSL when connecting to metastore.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.client.ssl.key</span></code></p></td>
<td><p>Path to private key and client certificate (key store).</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.client.ssl.key-password</span></code></p></td>
<td><p>Password for the private key.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.client.ssl.trust-certificate</span></code></p></td>
<td><p>Path to the server certificate chain (trust store).
Required when SSL is enabled.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.thrift.client.ssl.trust-certificate-password</span></code></p></td>
<td><p>Password for the trust store</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.service.principal</span></code></p></td>
<td><p>The Kerberos principal of the Hive metastore service.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.client.principal</span></code></p></td>
<td><p>The Kerberos principal that Presto uses when connecting
to the Hive metastore service.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.client.keytab</span></code></p></td>
<td><p>Hive metastore client keytab location.</p></td>
<td></td>
</tr>
</tbody>
</table>


<h2 id="aws-glue-catalog-configuration-properties">AWS Glue Catalog Configuration Properties<a class="headerlink" href="#aws-glue-catalog-configuration-properties" title="Permalink to this headline">#</a></h2>
<p>In order to use a Glue catalog, ensure to configure the metastore with
<code class="docutils literal notranslate"><span class="pre">hive.metastore=glue</span></code> and provide further details with the following
properties:</p>
<table>
<colgroup>
<col style="width: 46%"/>
<col style="width: 54%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.region</span></code></p></td>
<td><p>AWS region of the Glue Catalog. This is required when not
running in EC2, or when the catalog is in a different region.
Example: <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.endpoint-url</span></code></p></td>
<td><p>Glue API endpoint URL (optional).
Example: <code class="docutils literal notranslate"><span class="pre">https://glue.us-east-1.amazonaws.com</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.pin-client-to-current-region</span></code></p></td>
<td><p>Pin Glue requests to the same region as the EC2 instance
where Presto is running, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.max-connections</span></code></p></td>
<td><p>Max number of concurrent connections to Glue,
defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.max-error-retries</span></code></p></td>
<td><p>Maximum number of error retries for the Glue client,
defaults to <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.default-warehouse-dir</span></code></p></td>
<td><p>Default warehouse directory for schemas created without an
explicit <code class="docutils literal notranslate"><span class="pre">location</span></code> property.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.aws-credentials-provider</span></code></p></td>
<td><p>Fully qualified name of the Java class to use for obtaining
AWS credentials. Can be used to supply a custom credentials
provider.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.aws-access-key</span></code></p></td>
<td><p>AWS access key to use to connect to the Glue Catalog. If
specified along with <code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.aws-secret-key</span></code>,
this parameter takes precedence over
<code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.iam-role</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.aws-secret-key</span></code></p></td>
<td><p>AWS secret key to use to connect to the Glue Catalog. If
specified along with <code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.aws-access-key</span></code>,
this parameter takes precedence over
<code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.iam-role</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.catalogid</span></code></p></td>
<td><p>The ID of the Glue Catalog in which the metadata database
resides.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.iam-role</span></code></p></td>
<td><p>ARN of an IAM role to assume when connecting to the Glue
Catalog.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.external-id</span></code></p></td>
<td><p>External ID for the IAM role trust policy when connecting
to the Glue Catalog.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.partitions-segments</span></code></p></td>
<td><p>Number of segments for partitioned Glue tables, defaults
to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.get-partition-threads</span></code></p></td>
<td><p>Number of threads for parallel partition fetches from Glue,
defaults to <code class="docutils literal notranslate"><span class="pre">20</span></code>.</p></td>
</tr>
</tbody>
</table>


<h2 id="google-cloud-storage-configuration">Google Cloud Storage Configuration<a class="headerlink" href="#google-cloud-storage-configuration" title="Permalink to this headline">#</a></h2>
<p>The Hive connector can access data stored in GCS, using the <code class="docutils literal notranslate"><span class="pre">gs://</span></code> URI prefix.
Please refer to the <a class="reference internal" href="hive-gcs-tutorial.html"><span class="doc">Hive Connector GCS Tutorial</span></a> for step-by-step instructions.</p>

<h3 id="gcs-configuration-properties">GCS Configuration properties<a class="headerlink" href="#gcs-configuration-properties" title="Permalink to this headline">#</a></h3>
<table>
<colgroup>
<col style="width: 40%"/>
<col style="width: 60%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.gcs.json-key-file-path</span></code></p></td>
<td><p>JSON key file used to authenticate with Google Cloud Storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.gcs.use-access-token</span></code></p></td>
<td><p>Use client-provided OAuth token to access Google Cloud Storage.
This is mutually exclusive with a global JSON key file.</p></td>
</tr>
</tbody>
</table>



<h2 id="table-statistics">Table Statistics<a class="headerlink" href="#table-statistics" title="Permalink to this headline">#</a></h2>
<p>The Hive connector supports collecting and managing <a class="reference internal" href="../optimizer/statistics.html"><span class="doc">table statistics</span></a> to improve query processing performance.</p>
<p>When writing data, the Hive connector always collects basic statistics
(<code class="docutils literal notranslate"><span class="pre">numFiles</span></code>, <code class="docutils literal notranslate"><span class="pre">numRows</span></code>, <code class="docutils literal notranslate"><span class="pre">rawDataSize</span></code>, <code class="docutils literal notranslate"><span class="pre">totalSize</span></code>)
and by default will also collect column level statistics:</p>
<table>
<colgroup>
<col style="width: 16%"/>
<col style="width: 84%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Type</p></th>
<th class="head"><p>Collectible Statistics</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TINYINT</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
<td><p>number of nulls, number of distinct values, min/max values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p>number of nulls, number of distinct values</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CHAR</span></code></p></td>
<td><p>number of nulls, number of distinct values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">VARBINARY</span></code></p></td>
<td><p>number of nulls</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p>number of nulls, number of true/false values</p></td>
</tr>
</tbody>
</table>

<span id="hive-analyze"></span><h3 id="updating-table-and-partition-statistics">Updating table and partition statistics<a class="headerlink" href="#updating-table-and-partition-statistics" title="Permalink to this headline">#</a></h3>
<p>If your queries are complex and include joining large data sets,
running <a class="reference internal" href="../sql/analyze.html"><span class="doc">ANALYZE</span></a> on tables/partitions may improve query performance
by collecting statistical information about the data.</p>
<p>When analyzing a partitioned table, the partitions to analyze can be specified
via the optional <code class="docutils literal notranslate"><span class="pre">partitions</span></code> property, which is an array containing
the values of the partition keys in the order they are declared in the table schema:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ANALYZE</span> <span class="k">table_name</span> <span class="k">WITH</span> <span class="p">(</span>
    <span class="n">partitions</span> <span class="o">=</span> <span class="nb">ARRAY</span><span class="p">[</span>
        <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'p1_value1'</span><span class="p">,</span> <span class="s1">'p1_value2'</span><span class="p">],</span>
        <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'p2_value1'</span><span class="p">,</span> <span class="s1">'p2_value2'</span><span class="p">]])</span>
</pre></div>
</div>
<p>This query will collect statistics for two partitions with keys
<code class="docutils literal notranslate"><span class="pre">p1_value1,</span> <span class="pre">p1_value2</span></code> and <code class="docutils literal notranslate"><span class="pre">p2_value1,</span> <span class="pre">p2_value2</span></code>.</p>
<p>On wide tables, collecting statistics for all columns can be expensive and can have a
detrimental effect on query planning. It is also typically unnecessary - statistics are
only useful on specific columns, like join keys, predicates, grouping keys. One can
specify a subset of columns to be analyzed via the optional <code class="docutils literal notranslate"><span class="pre">columns</span></code> property:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ANALYZE</span> <span class="k">table_name</span> <span class="k">WITH</span> <span class="p">(</span>
    <span class="n">partitions</span> <span class="o">=</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'p2_value1'</span><span class="p">,</span> <span class="s1">'p2_value2'</span><span class="p">]],</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'col_1'</span><span class="p">,</span> <span class="s1">'col_2'</span><span class="p">])</span>
</pre></div>
</div>
<p>This query collects statistics for columns <code class="docutils literal notranslate"><span class="pre">col_1</span></code> and <code class="docutils literal notranslate"><span class="pre">col_2</span></code> for the partition
with keys <code class="docutils literal notranslate"><span class="pre">p2_value1,</span> <span class="pre">p2_value2</span></code>.</p>
<p>Note that if statistics were previously collected for all columns, they need to be dropped
before re-analyzing just a subset:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span> <span class="k">system</span><span class="p">.</span><span class="n">drop_stats</span><span class="p">(</span><span class="k">schema_name</span><span class="p">,</span> <span class="k">table_name</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also drop statistics for selected partitions only:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span> <span class="k">system</span><span class="p">.</span><span class="n">drop_stats</span><span class="p">(</span><span class="k">schema_name</span><span class="p">,</span> <span class="k">table_name</span><span class="p">,</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'p2_value1'</span><span class="p">,</span> <span class="s1">'p2_value2'</span><span class="p">]])</span>
</pre></div>
</div>



<h2 id="dynamic-filtering">Dynamic Filtering<a class="headerlink" href="#dynamic-filtering" title="Permalink to this headline">#</a></h2>
<p>The Hive connector supports the <a class="reference internal" href="../admin/dynamic-filtering.html"><span class="doc">dynamic filtering</span></a> optimization.
Dynamic partition pruning is supported for partitioned tables stored in any file format
for broadcast as well as partitioned joins.
Dynamic bucket pruning is supported for bucketed tables stored in any file format for
broadcast joins only.</p>
<p>For tables stored in ORC or Parquet file format, dynamic filters are also pushed into
local table scan on worker nodes for broadcast joins. Dynamic filter predicates
pushed into the ORC and Parquet readers are used to perform stripe or row-group pruning
and save on disk I/O. Sorting the data within ORC or Parquet files by the columns used in
join criteria significantly improves the effectiveness of stripe or row-group pruning.
This is because grouping similar data within the same stripe or row-group
greatly improves the selectivity of the min/max indexes maintained at stripe or
row-group level.</p>

<h3 id="delaying-execution-for-dynamic-filters">Delaying execution for dynamic filters<a class="headerlink" href="#delaying-execution-for-dynamic-filters" title="Permalink to this headline">#</a></h3>
<p>It can often be beneficial to wait for the collection of dynamic filters before starting
a table scan. This extra wait time can potentially result in significant overall savings
in query and CPU time, if dynamic filtering is able to reduce the amount of scanned data.</p>
<p>For the Hive connector, a table scan can be delayed for a configured amount of
time until the collection of dynamic filters by using the configuration property
<code class="docutils literal notranslate"><span class="pre">hive.dynamic-filtering-probe-blocking-timeout</span></code> in the catalog file or the catalog
session property <code class="docutils literal notranslate"><span class="pre">&lt;hive-catalog&gt;.dynamic_filtering_probe_blocking_timeout</span></code>.</p>



<h2 id="schema-evolution">Schema Evolution<a class="headerlink" href="#schema-evolution" title="Permalink to this headline">#</a></h2>
<p>Hive allows the partitions in a table to have a different schema than the
table. This occurs when the column types of a table are changed after
partitions already exist (that use the original column types). The Hive
connector supports this by allowing the same conversions as Hive:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">varchar</span></code> to and from <code class="docutils literal notranslate"><span class="pre">tinyint</span></code>, <code class="docutils literal notranslate"><span class="pre">smallint</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code> and <code class="docutils literal notranslate"><span class="pre">bigint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">real</span></code> to <code class="docutils literal notranslate"><span class="pre">double</span></code></p></li>
<li><p>Widening conversions for integers, such as <code class="docutils literal notranslate"><span class="pre">tinyint</span></code> to <code class="docutils literal notranslate"><span class="pre">smallint</span></code></p></li>
</ul>
<p>Any conversion failure results in null, which is the same behavior
as Hive. For example, converting the string <code class="docutils literal notranslate"><span class="pre">'foo'</span></code> to a number,
or converting the string <code class="docutils literal notranslate"><span class="pre">'1234'</span></code> to a <code class="docutils literal notranslate"><span class="pre">tinyint</span></code> (which has a
maximum value of <code class="docutils literal notranslate"><span class="pre">127</span></code>).</p>


<h2 id="avro-schema-evolution">Avro Schema Evolution<a class="headerlink" href="#avro-schema-evolution" title="Permalink to this headline">#</a></h2>
<p>Presto supports querying and manipulating Hive tables with the Avro storage
format, which has the schema set based on an Avro schema file/literal. Presto is
also capable of creating the tables in Presto by infering the schema from a
valid Avro schema file located locally, or remotely in HDFS/Web server.</p>
<p>To specify that the Avro schema should be used for interpreting tableâ€™s data one must use <code class="docutils literal notranslate"><span class="pre">avro_schema_url</span></code> table property.
The schema can be placed remotely in
HDFS (e.g. <code class="docutils literal notranslate"><span class="pre">avro_schema_url</span> <span class="pre">=</span> <span class="pre">'hdfs://user/avro/schema/avro_data.avsc'</span></code>),
S3 (e.g. <code class="docutils literal notranslate"><span class="pre">avro_schema_url</span> <span class="pre">=</span> <span class="pre">'s3n:///schema_bucket/schema/avro_data.avsc'</span></code>),
a web server (e.g. <code class="docutils literal notranslate"><span class="pre">avro_schema_url</span> <span class="pre">=</span> <span class="pre">'http://example.org/schema/avro_data.avsc'</span></code>)
as well as local file system. This URL, where the schema is located, must be accessible from the
Hive metastore and Presto coordinator/worker nodes.</p>
<p>The table created in Presto using <code class="docutils literal notranslate"><span class="pre">avro_schema_url</span></code> behaves the same way as a Hive table with <code class="docutils literal notranslate"><span class="pre">avro.schema.url</span></code> or <code class="docutils literal notranslate"><span class="pre">avro.schema.literal</span></code> set.</p>
<p>Example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">hive</span><span class="p">.</span><span class="n">avro</span><span class="p">.</span><span class="n">avro_data</span> <span class="p">(</span>
   <span class="n">id</span> <span class="nb">bigint</span>
 <span class="p">)</span>
<span class="k">WITH</span> <span class="p">(</span>
   <span class="n">format</span> <span class="o">=</span> <span class="s1">'AVRO'</span><span class="p">,</span>
   <span class="n">avro_schema_url</span> <span class="o">=</span> <span class="s1">'/usr/local/avro_data.avsc'</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The columns listed in the DDL (<code class="docutils literal notranslate"><span class="pre">id</span></code> in the above example) is ignored if <code class="docutils literal notranslate"><span class="pre">avro_schema_url</span></code> is specified.
The table schema matches the schema in the Avro schema file. Before any read operation, the Avro schema is
accessed so the query result reflects any changes in schema. Thus Presto takes advantage of Avroâ€™s backward compatibility abilities.</p>
<p>If the schema of the table changes in the Avro schema file, the new schema can still be used to read old data.
Newly added/renamed fields <em>must</em> have a default value in the Avro schema file.</p>
<p>The schema evolution behavior is as follows:</p>
<ul class="simple">
<li><p>Column added in new schema:
Data created with an older schema produces a <em>default</em> value when table is using the new schema.</p></li>
<li><p>Column removed in new schema:
Data created with an older schema no longer outputs the data from the column that was removed.</p></li>
<li><p>Column is renamed in the new schema:
This is equivalent to removing the column and adding a new one, and data created with an older schema
produces a <em>default</em> value when table is using the new schema.</p></li>
<li><p>Changing type of column in the new schema:
If the type coercion is supported by Avro or the Hive connector, then the conversion happens.
An error is thrown for incompatible types.</p></li>
</ul>

<h3 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">#</a></h3>
<p>The following operations are not supported when <code class="docutils literal notranslate"><span class="pre">avro_schema_url</span></code> is set:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span> <span class="pre">AS</span></code> is not supported.</p></li>
<li><p>Using partitioning(<code class="docutils literal notranslate"><span class="pre">partitioned_by</span></code>) or bucketing(<code class="docutils literal notranslate"><span class="pre">bucketed_by</span></code>) columns are not supported in <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code> commands modifying columns are not supported.</p></li>
</ul>



<span id="hive-procedures"></span><h2 id="procedures">Procedures<a class="headerlink" href="#procedures" title="Permalink to this headline">#</a></h2>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">system.create_empty_partition(schema_name,</span> <span class="pre">table_name,</span> <span class="pre">partition_columns,</span> <span class="pre">partition_values)</span></code></p>
<p>Create an empty partition in the specified table.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">system.sync_partition_metadata(schema_name,</span> <span class="pre">table_name,</span> <span class="pre">mode,</span> <span class="pre">case_sensitive)</span></code></p>
<p>Check and update partitions list in metastore. There are three modes available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ADD</span></code> : add any partitions that exist on the file system, but not in the metastore.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DROP</span></code>: drop any partitions that exist in the metastore, but not on the file system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FULL</span></code>: perform both <code class="docutils literal notranslate"><span class="pre">ADD</span></code> and <code class="docutils literal notranslate"><span class="pre">DROP</span></code>.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">case_sensitive</span></code> argument is optional. The default value is <code class="docutils literal notranslate"><span class="pre">true</span></code> for compatibility
with Hiveâ€™s <code class="docutils literal notranslate"><span class="pre">MSCK</span> <span class="pre">REPAIR</span> <span class="pre">TABLE</span></code> behavior, which expects the partition column names in
file system paths to use lowercase (e.g. <code class="docutils literal notranslate"><span class="pre">col_x=SomeValue</span></code>). Partitions on the file system
not conforming to this convention are ignored, unless the argument is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">system.drop_stats(schema_name,</span> <span class="pre">table_name,</span> <span class="pre">partition_values)</span></code></p>
<p>Drops statistics for a subset of partitions or the entire table. The partitions are specified as an
array whose elements are arrays of partition values (similar to the <code class="docutils literal notranslate"><span class="pre">partition_values</span></code> argument in
<code class="docutils literal notranslate"><span class="pre">create_empty_partition</span></code>). If <code class="docutils literal notranslate"><span class="pre">partition_values</span></code> argument is omitted, stats are dropped for the
entire table.</p>
</li>
</ul>
<ul id="register-partition">
<li><p><code class="docutils literal notranslate"><span class="pre">system.register_partition(schema_name,</span> <span class="pre">table_name,</span> <span class="pre">partition_columns,</span> <span class="pre">partition_values,</span> <span class="pre">location)</span></code></p>
<p>Registers existing location as a new partition in the metastore for the specified table.</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">location</span></code> argument is omitted, the partition location is
constructed using <code class="docutils literal notranslate"><span class="pre">partition_columns</span></code> and <code class="docutils literal notranslate"><span class="pre">partition_values</span></code>.</p>
<p>Due to security reasons, the procedure is enabled only when <code class="docutils literal notranslate"><span class="pre">hive.allow-register-partition-procedure</span></code>
is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</li>
</ul>
<ul id="unregister-partition">
<li><p><code class="docutils literal notranslate"><span class="pre">system.unregister_partition(schema_name,</span> <span class="pre">table_name,</span> <span class="pre">partition_columns,</span> <span class="pre">partition_values)</span></code></p>
<p>Unregisters given, existing partition in the metastore for the specified table.
The partition data is not deleted.</p>
</li>
</ul>


<h2 id="special-columns">Special Columns<a class="headerlink" href="#special-columns" title="Permalink to this headline">#</a></h2>
<p>In addition to the defined columns, the Hive connector automatically exposes
metadata in a number of hidden columns in each table. You can use these columns
in your SQL statements like any other column, e.g., they can be selected
directly or used in conditional statements.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$bucket</span></code>: Bucket number for this row</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$path</span></code>: Full file system path name of the file for this row</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$file_modified_time</span></code>: Date and time of the last modification of the file for this row</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$file_size</span></code>: Size of the file for this row</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$partition</span></code>: Partition name for this row</p></li>
</ul>


<h2 id="special-tables">Special Tables<a class="headerlink" href="#special-tables" title="Permalink to this headline">#</a></h2>

<h3 id="table-properties">Table Properties<a class="headerlink" href="#table-properties" title="Permalink to this headline">#</a></h3>
<p>The raw Hive table properties are available as a hidden table, containing a
separate column per table property, with a single row containing the property
values. The properties table name is the same as the table name with
<code class="docutils literal notranslate"><span class="pre">$properties</span></code> appended.</p>
<p>You can inspect the property names and values with a simple query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="ss">"page_views$properties"</span><span class="p">;</span>
</pre></div>
</div>



<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h2>
<p>The Hive connector supports querying and manipulating Hive tables and schemas
(databases). While some uncommon operations need to be performed using
Hive directly, most operations can be performed using Presto.</p>
<p>Create a new Hive schema named <code class="docutils literal notranslate"><span class="pre">web</span></code> that stores tables in an
S3 bucket named <code class="docutils literal notranslate"><span class="pre">my-bucket</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span>
<span class="k">WITH</span> <span class="p">(</span><span class="k">location</span> <span class="o">=</span> <span class="s1">'s3://my-bucket/'</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a new Hive table named <code class="docutils literal notranslate"><span class="pre">page_views</span></code> in the <code class="docutils literal notranslate"><span class="pre">web</span></code> schema
that is stored using the ORC file format, partitioned by date and
country, and bucketed by user into <code class="docutils literal notranslate"><span class="pre">50</span></code> buckets. Note that Hive
requires the partition columns to be the last columns in the table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span> <span class="p">(</span>
  <span class="n">view_time</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="n">user_id</span> <span class="nb">bigint</span><span class="p">,</span>
  <span class="n">page_url</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="n">ds</span> <span class="nb">date</span><span class="p">,</span>
  <span class="n">country</span> <span class="nb">varchar</span>
<span class="p">)</span>
<span class="k">WITH</span> <span class="p">(</span>
  <span class="n">format</span> <span class="o">=</span> <span class="s1">'ORC'</span><span class="p">,</span>
  <span class="n">partitioned_by</span> <span class="o">=</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'ds'</span><span class="p">,</span> <span class="s1">'country'</span><span class="p">],</span>
  <span class="n">bucketed_by</span> <span class="o">=</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">],</span>
  <span class="n">bucket_count</span> <span class="o">=</span> <span class="mi">50</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Drop a partition from the <code class="docutils literal notranslate"><span class="pre">page_views</span></code> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span>
<span class="k">WHERE</span> <span class="n">ds</span> <span class="o">=</span> <span class="nb">DATE</span> <span class="s1">'2016-08-09'</span>
  <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'US'</span>
</pre></div>
</div>
<p>Add an empty partition to the <code class="docutils literal notranslate"><span class="pre">page_views</span></code> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span> <span class="k">system</span><span class="p">.</span><span class="n">create_empty_partition</span><span class="p">(</span>
    <span class="k">schema_name</span> <span class="o">=&gt;</span> <span class="s1">'web'</span><span class="p">,</span>
    <span class="k">table_name</span> <span class="o">=&gt;</span> <span class="s1">'page_views'</span><span class="p">,</span>
    <span class="n">partition_columns</span> <span class="o">=&gt;</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'ds'</span><span class="p">,</span> <span class="s1">'country'</span><span class="p">],</span>
    <span class="n">partition_values</span> <span class="o">=&gt;</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'2016-08-09'</span><span class="p">,</span> <span class="s1">'US'</span><span class="p">]);</span>
</pre></div>
</div>
<p>Drop stats for a partition of the <code class="docutils literal notranslate"><span class="pre">page_views</span></code> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CALL</span> <span class="k">system</span><span class="p">.</span><span class="n">drop_stats</span><span class="p">(</span>
    <span class="k">schema_name</span> <span class="o">=&gt;</span> <span class="s1">'web'</span><span class="p">,</span>
    <span class="k">table_name</span> <span class="o">=&gt;</span> <span class="s1">'page_views'</span><span class="p">,</span>
    <span class="n">partition_values</span> <span class="o">=&gt;</span> <span class="nb">ARRAY</span><span class="p">[</span><span class="s1">'2016-08-09'</span><span class="p">,</span> <span class="s1">'US'</span><span class="p">]);</span>
</pre></div>
</div>
<p>Query the <code class="docutils literal notranslate"><span class="pre">page_views</span></code> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span>
</pre></div>
</div>
<p>List the partitions of the <code class="docutils literal notranslate"><span class="pre">page_views</span></code> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="ss">"page_views$partitions"</span>
</pre></div>
</div>
<p>Create an external Hive table named <code class="docutils literal notranslate"><span class="pre">request_logs</span></code> that points at
existing data in S3:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">request_logs</span> <span class="p">(</span>
  <span class="n">request_time</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="n">url</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="n">ip</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="n">user_agent</span> <span class="nb">varchar</span>
<span class="p">)</span>
<span class="k">WITH</span> <span class="p">(</span>
  <span class="n">format</span> <span class="o">=</span> <span class="s1">'TEXTFILE'</span><span class="p">,</span>
  <span class="n">external_location</span> <span class="o">=</span> <span class="s1">'s3://my-bucket/data/logs/'</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Collect statistics for the <code class="docutils literal notranslate"><span class="pre">request_logs</span></code> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ANALYZE</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">request_logs</span><span class="p">;</span>
</pre></div>
</div>
<p>The examples shown here should work on Google Cloud Storage after replacing <code class="docutils literal notranslate"><span class="pre">s3://</span></code> with <code class="docutils literal notranslate"><span class="pre">gs://</span></code>.</p>

<h3 id="cleaning-up">Cleaning up<a class="headerlink" href="#cleaning-up" title="Permalink to this headline">#</a></h3>
<p>Drop the external table <code class="docutils literal notranslate"><span class="pre">request_logs</span></code>. This only drops the metadata
for the table. The referenced data directory is not deleted:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">request_logs</span>
</pre></div>
</div>
<p>Drop a schema:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">SCHEMA</span> <span class="n">hive</span><span class="p">.</span><span class="n">web</span>
</pre></div>
</div>



<h2 id="hive-connector-limitations">Hive Connector Limitations<a class="headerlink" href="#hive-connector-limitations" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../sql/delete.html"><span class="doc">DELETE</span></a> is only supported if the <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause matches entire partitions.</p></li>
<li><p><a class="reference internal" href="../sql/alter-schema.html"><span class="doc">ALTER SCHEMA</span></a> usage fails, since the Hive metastore does not support renaming schemas.</p></li>
</ul>

<h3 id="hive-3-related-limitations">Hive 3 Related Limitations<a class="headerlink" href="#hive-3-related-limitations" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>For security reasons, the <code class="docutils literal notranslate"><span class="pre">sys</span></code> system catalog is not accessible.</p></li>
<li><p>Hiveâ€™s <code class="docutils literal notranslate"><span class="pre">timestamp</span> <span class="pre">with</span> <span class="pre">local</span> <span class="pre">zone</span></code> data type is not supported.
It is possible to read from a table with a column of this type, but the column
data is not accessible. Writing to such a table is not supported.</p></li>
<li><p>Due to Hive issues <a class="reference external" href="https://issues.apache.org/jira/browse/HIVE-21002">HIVE-21002</a>
and <a class="reference external" href="https://issues.apache.org/jira/browse/HIVE-22167">HIVE-22167</a>, Presto does
not correctly read <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> values from Parquet, RCBinary, or Avro
file formats created by Hive 3.1 or later. When reading from these file formats,
Presto returns different results than Hive.</p></li>
<li><p><a class="reference internal" href="../sql/create-table-as.html"><span class="doc">CREATE TABLE AS</span></a> can be used to create transactional tables in ORC format like this:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
<span class="k">WITH</span> <span class="p">(</span>
    <span class="n">format</span><span class="o">=</span><span class="s1">'ORC'</span><span class="p">,</span>
    <span class="n">transactional</span><span class="o">=</span><span class="k">true</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">AS</span> <span class="o">&lt;</span><span class="n">query</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Presto does not support gathering table statistics for Hive transactional tables.
You need to use Hive to gather table statistics with <code class="docutils literal notranslate"><span class="pre">ANALYZE</span> <span class="pre">TABLE</span> <span class="pre">COMPUTE</span> <span class="pre">STATISTICS</span></code> after table creation.</p>
</li>
</ul>





          </article>
        </div>
      </div>
    </main>
  </div>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="googlesheets.html" title="Google Sheets Connector"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Google Sheets Connector </span>
              </div>
            </a>
          
          
            <a href="hive-security.html" title="Hive Connector Security Configuration"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Hive Connector Security Configuration </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>

<!-- custom footer should go here in time -->

<div style="background: #000A2C; align-content: center; height: 5em;">

</div>
  </body>
</html>