

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>HTTPS and TLS &#8212; Starburst Enterprise</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/presto.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Keystores and truststores" href="tls.html" />
    <link rel="prev" title="Security overview" href="security-overview.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#security/https" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Starburst Enterprise"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise</span>
          <span class="md-header-nav__topic"> HTTPS and TLS </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (350-e)" href="/350-e/">Latest LTS (350-e)</a>
      
          <a title="345-e LTS" href="/345-e/">345-e LTS</a>
      
          <a title="338-e LTS" href="/338-e/">338-e LTS</a>
      
          <a title="Latest STS (355-e)" href="/355-e/">Latest STS (355-e)</a>
      
          <a title="354-e STS" href="/354-e/">354-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Reference documentation</a></li>
            
            <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">User guides</a></li>
          <li class="md-tabs__item"><a href="../security.html" class="md-tabs__link">Security</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise">Starburst Enterprise</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mission-control.html" class="md-nav__link">Mission Control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Kubernetes with Helm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="security-overview.html" class="md-nav__link">Security overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> HTTPS and TLS </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">HTTPS and TLS</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-https--page-root" class="md-nav__link">HTTPS and TLS</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#approaches" class="md-nav__link">Approaches</a>
        </li>
        <li class="md-nav__item"><a href="#use-a-load-balancer-to-terminate-https-tls" class="md-nav__link">Use a load balancer to terminate HTTPS/TLS</a>
        </li>
        <li class="md-nav__item"><a href="#secure-oss-directly" class="md-nav__link">Secure PrestoSQL directly</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#add-a-tls-certificate" class="md-nav__link">Add a TLS certificate</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#inspect-received-key-files" class="md-nav__link">Inspect received key files</a>
        </li>
        <li class="md-nav__item"><a href="#inspect-received-pem-certificates" class="md-nav__link">Inspect received PEM certificates</a>
        </li>
        <li class="md-nav__item"><a href="#validate-key" class="md-nav__link">Validate key</a>
        </li>
        <li class="md-nav__item"><a href="#validate-certificate" class="md-nav__link">Validate certificate</a>
        </li>
        <li class="md-nav__item"><a href="#invalid-certificates" class="md-nav__link">Invalid certificates</a>
        </li>
        <li class="md-nav__item"><a href="#inspect-jks-keystores" class="md-nav__link">Inspect JKS keystores</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#place-the-certificate-file" class="md-nav__link">Place the certificate file</a>
        </li>
        <li class="md-nav__item"><a href="#configure-the-coordinator" class="md-nav__link">Configure the coordinator</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tls.html" class="md-nav__link">Keystores and truststores</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-file.html" class="md-nav__link">Password File Authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap.html" class="md-nav__link">LDAP Authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="oauth2.html" class="md-nav__link">OAuth 2.0 authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="okta-authentication.html" class="md-nav__link">Okta authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="salesforce.html" class="md-nav__link">Salesforce Authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="server.html" class="md-nav__link">Kerberos authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cli.html" class="md-nav__link">Kerberos authentication with CLI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-mapping.html" class="md-nav__link">User mapping</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="group-file.html" class="md-nav__link">File-based group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap-group-provider.html" class="md-nav__link">LDAP group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="access-control.html" class="md-nav__link">Access control overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="built-in-system-access-control.html" class="md-nav__link">Built-in system access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="file-system-access-control.html" class="md-nav__link">File-based system access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="impersonation.html" class="md-nav__link">User impersonation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-passthrough.html" class="md-nav__link">Password credential pass-through</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kerberos-passthrough.html" class="md-nav__link">Kerberos credential pass-through</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ranger-overview.html" class="md-nav__link">Apache Ranger overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="global-ranger.html" class="md-nav__link">Global access control with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-ranger.html" class="md-nav__link">Hive and Delta Lake access control with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="global-privacera.html" class="md-nav__link">Global access control with the Privacera Platform</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-privacera.html" class="md-nav__link">Hive access control with the Privacera Platform</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-sentry.html" class="md-nav__link">Hive access control with Apache Sentry</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internal-communication.html" class="md-nav__link">Secure internal communication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="secrets.html" class="md-nav__link">Secrets management</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="audit.html" class="md-nav__link">Query audit</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="event-logger.html" class="md-nav__link">Event logger</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../insights.html" class="md-nav__link">Insights</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../migration.html" class="md-nav__link">Migration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">350-e.8 LTS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">&nbsp;</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-https--page-root" class="md-nav__link">HTTPS and TLS</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#approaches" class="md-nav__link">Approaches</a>
        </li>
        <li class="md-nav__item"><a href="#use-a-load-balancer-to-terminate-https-tls" class="md-nav__link">Use a load balancer to terminate HTTPS/TLS</a>
        </li>
        <li class="md-nav__item"><a href="#secure-oss-directly" class="md-nav__link">Secure PrestoSQL directly</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#add-a-tls-certificate" class="md-nav__link">Add a TLS certificate</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#inspect-received-key-files" class="md-nav__link">Inspect received key files</a>
        </li>
        <li class="md-nav__item"><a href="#inspect-received-pem-certificates" class="md-nav__link">Inspect received PEM certificates</a>
        </li>
        <li class="md-nav__item"><a href="#validate-key" class="md-nav__link">Validate key</a>
        </li>
        <li class="md-nav__item"><a href="#validate-certificate" class="md-nav__link">Validate certificate</a>
        </li>
        <li class="md-nav__item"><a href="#invalid-certificates" class="md-nav__link">Invalid certificates</a>
        </li>
        <li class="md-nav__item"><a href="#inspect-jks-keystores" class="md-nav__link">Inspect JKS keystores</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#place-the-certificate-file" class="md-nav__link">Place the certificate file</a>
        </li>
        <li class="md-nav__item"><a href="#configure-the-coordinator" class="md-nav__link">Configure the coordinator</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="security-https--page-root">HTTPS and TLS<a class="headerlink" href="#security-https--page-root" title="Permalink to this headline">#</a></h1>
<p>PrestoSQL runs with no security configuration in its default installation. This
allows you to connect to the server using URLs that specify the HTTP protocol
with the PrestoSQL <a class="reference internal" href="../installation/cli.html"><span class="doc">CLI</span></a>, the <a class="reference internal" href="../admin/web-interface.html"><span class="doc">Web UI</span></a>, or other clients.</p>
<p>This guide describes how to configure your PrestoSQL server to use <a class="reference external" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer
Security (TLS)</a>,
thereby requiring the HTTPS protocol from client connections. All authentication
and authorization technologies supported by PrestoSQL require configuring TLS as the
foundation.</p>
<p>When configured to use TLS, a PrestoSQL server responds to connections from TLS 1.2
and TLS 1.3 certificates. The server rejects TLS 1.1, TLS 1.0, and all SSL
format certificates.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This page discusses only how to prepare the PrestoSQL server for client
connections from outside of the PrestoSQL cluster to its coordinator.</p>
</div>
<p>Transport Layer Security (TLS) is the successor to its now-deprecated
predecessor, Secure Sockets Layer (SSL). This page uses the term TLS to refer
to TLS and SSL.</p>

<h2 id="approaches">Approaches<a class="headerlink" href="#approaches" title="Permalink to this headline">#</a></h2>
<p>To configure PrestoSQL with TLS support, there are two alternative paths to
consider:</p>
<ul class="simple">
<li><p>Use the <a class="reference internal" href="#https-load-balancer"><span class="std std-ref">load balancer or proxy</span></a> at your site
or cloud environment to terminate HTTPS/TLS. This approach is the simplest and
strongly preferred solution.</p></li>
<li><p>Secure the PrestoSQL <a class="reference internal" href="#https-coordinator"><span class="std std-ref">server directly</span></a>. This requires you
to obtain a valid certificate, and add it to the PrestoSQL coordinator’s
configuration.</p></li>
</ul>


<span id="https-load-balancer"></span><h2 id="use-a-load-balancer-to-terminate-https-tls">Use a load balancer to terminate HTTPS/TLS<a class="headerlink" href="#use-a-load-balancer-to-terminate-https-tls" title="Permalink to this headline">#</a></h2>
<p>Your site or cloud environment may already have a load balancer or proxy server
configured and running with a valid TLS certificate. In this case, you can work
with your network administration group to set up your PrestoSQL server behind the
load balancer. The load balancer or proxy server accepts TLS connections and
forwards them to the PrestoSQL coordinator, which typically runs with default HTTP
configuration on the default port, 8080.</p>
<p>When a load balancer accepts a TLS encrypted connection, it places the following
string in the HTML header of connection attempts:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>X-Forwarded-Proto: https
</pre></div>
</div>
<p>This tells the PrestoSQL coordinator to process the connection as if a TLS
connection has already been successfully negotiated for it. This is why you do
not need to configure <code class="docutils literal notranslate"><span class="pre">http-server.https.enabled=true</span></code> for a coordinator
behind a load balancer.</p>
<p>However, to enable processing of such forwarded headers, the server’s
<a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">config properties file</span></a> <em>must</em> include the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.process-forwarded=true
</pre></div>
</div>
<p>This completes any necessary configuration for using HTTPS with a load balancer.
Client tools can access PrestoSQL with the URL exposed by the load balancer.</p>


<span id="https-coordinator"></span><h2 id="secure-oss-directly">Secure PrestoSQL directly<a class="headerlink" href="#secure-oss-directly" title="Permalink to this headline">#</a></h2>
<p>Instead of the preferred mechanism of <a class="reference internal" href="#https-load-balancer"><span class="std std-ref">using an external load balancer</span></a>, you can secure the PrestoSQL coordinator itself. This
requires you to obtain and install a TLS certificate and configure PrestoSQL to use
it for any client connections.</p>

<h3 id="add-a-tls-certificate">Add a TLS certificate<a class="headerlink" href="#add-a-tls-certificate" title="Permalink to this headline">#</a></h3>
<p>Obtain a TLS certificate file for use with your PrestoSQL server. Consider the
following types of certificates:</p>
<ul class="simple">
<li><p><strong>Globally trusted certificates</strong>. A certificate that is automatically trusted
by browsers and clients such as <code class="docutils literal notranslate"><span class="pre">curl</span></code>. This is the easiest type to use
because you do not need to configure clients. Obtain a certificate of this
type from:</p>
<ul>
<li><p>A commercial certificate vendor</p></li>
<li><p>Your cloud infrastructure provider</p></li>
<li><p>A domain name registrar, such as Verisign or GoDaddy</p></li>
<li><p>A free certificate generator, such as
<a class="reference external" href="https://letsencrypt.org/">letsencrypt.org</a> or
<a class="reference external" href="https://www.sslforfree.com/">sslforfree.com</a></p></li>
</ul>
</li>
<li><p><strong>Corporate trusted certificates</strong>. A certificate trusted by browsers and
clients in your company. Typically, a site’s IT department runs a local
certificate authority and preconfigures clients and servers to trust this CA.</p></li>
<li><p><strong>Generated self-signed certificates</strong>. A certificate generated just for
PrestoSQL that is not automatically trusted by any client. However, see
<a class="reference internal" href="tls.html#self-signed-limits"><span class="std std-ref">Limitations of self-signed certificates</span></a>.</p></li>
</ul>
<p>PrestoSQL recognizes public and private keys as specified in the PKCS #1 standard,
and recognizes x.509 certificates. Both keys and certificates can be simple
PEM-encoded files or can be imported into legacy JKS containers. Directly using
PEM-encoded files, as specified in the PKCS #8 standard, is preferred and is
easier to work with. PrestoSQL also recognizes certifificates and keys in the binary
PKCS #12 keystore format, usually in a file with <code class="docutils literal notranslate"><span class="pre">.p12</span></code> or <code class="docutils literal notranslate"><span class="pre">.pfx</span></code>
extensions.</p>
<p>Make sure you obtain a certificate that is validated by a recognized
certification authority (CA).</p>

<span id="inspect-pems"></span><h4 id="inspect-received-key-files">Inspect received key files<a class="headerlink" href="#inspect-received-key-files" title="Permalink to this headline">#</a></h4>
<p>This section shows how to inspect and validate key and certificate files
received in PEM-encoded format. The <a class="reference internal" href="#troubleshooting-keystore"><span class="std std-ref">Inspect JKS keystores</span></a> section
below shows how to validate keys in the legacy JKS truststore format.</p>
<p>When you receive your PEM format key and certificate file or files, inspect them
to verify that they show the correct information for your PrestoSQL server. The file
name extensions shown on this page are examples only; there is no extension
naming standard.</p>
<p>You may receive a single file that includes a private key and its certificate,
or separate files. First, use the <code class="docutils literal notranslate"><span class="pre">cat</span></code> command to view these plain text
files. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cat clustercoord.key
cat clustercoord.cert
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cat clustercoord.pem
</pre></div>
</div>
<p>A key file looks something like the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-----BEGIN PRIVATE KEY-----
MIIEowIBAAKCAQEAwJL8CLeDFAHhZe3QOOF1vWt4Vuk9vyO38Y1y9SgBfB02b2jW
....
-----END PRIVATE KEY-----
</pre></div>
</div>
<p>If your key file reports <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">ENCRYPTED</span> <span class="pre">PRIVATE</span> <span class="pre">KEY</span></code> instead, you must
specify the key’s password to open or inspect the file. You specified the
password when requesting the key, or the password could be assigned by your
site’s network managers.</p>
<blockquote>
<div><p>If your key file reports <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">EC</span> <span class="pre">PRIVATE</span> <span class="pre">KEY</span></code> or
<code class="docutils literal notranslate"><span class="pre">BEGIN_DSA_PRIVATE_KEY</span></code>, this designates keys using Elliptical Curve or
DSA alternatives to RSA. In these cases, consult <code class="docutils literal notranslate"><span class="pre">openssl</span></code> references for
the appropriate versions of the commands below.</p>
</div></blockquote>


<h4 id="inspect-received-pem-certificates">Inspect received PEM certificates<a class="headerlink" href="#inspect-received-pem-certificates" title="Permalink to this headline">#</a></h4>
<p>A separate certificate file looks like the following with the <code class="docutils literal notranslate"><span class="pre">cat</span></code>
command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-----BEGIN CERTIFICATE-----
MIIDujCCAqICAQEwDQYJKoZIhvcNAQEFBQAwgaIxCzAJBgNVBAYTAlVTMRYwFAYD
....
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDwjCCAqoCCQCxyqwZ9GK50jANBgkqhkiG9w0BAQsFADCBojELMAkGA1UEBhMC
....
-----END CERTIFICATE-----
</pre></div>
</div>
<p>The file can show a single certificate section, or more than one to express a
chain of authorities, each certifying the previous.</p>
<p>If you received a single file, make sure it shows at least one KEY and
CERTIFICATE section. If you received separate files, concatenate them into one,
typically in order from key to certificate. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cat clustercoord.key clustercoord.cert &gt; clustercoord.pem
</pre></div>
</div>


<span id="validate-pems"></span><h4 id="validate-key">Validate key<a class="headerlink" href="#validate-key" title="Permalink to this headline">#</a></h4>
<p>This page presumes your system provides the <code class="docutils literal notranslate"><span class="pre">openssl</span></code> command from OpenSSL 1.1
or later.</p>
<p>Test an RSA-encoded private key’s validity with the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>openssl rsa -in clustercoord.pem -check -noout
</pre></div>
</div>
<p>Look for the following confirmation message:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>RSA key ok
</pre></div>
</div>


<h4 id="validate-certificate">Validate certificate<a class="headerlink" href="#validate-certificate" title="Permalink to this headline">#</a></h4>
<p>Analyze a certificate file, or the certificate portion of a concatenated file,
with a different <code class="docutils literal notranslate"><span class="pre">openssl</span></code> command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>openssl x509 -in server.pem -text -noout
</pre></div>
</div>
<p>If your certificate was generated with a password, <code class="docutils literal notranslate"><span class="pre">openssl</span></code> prompts for it.</p>
<p>In the output of the <code class="docutils literal notranslate"><span class="pre">openssl</span></code> command, look for the following
characteristics:</p>
<ul class="simple">
<li><p>Modern browsers now enforce 398 days as the maximum validity period for a
certificate. Look for <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">Before</span></code> and <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">After</span></code> dates in the
<code class="docutils literal notranslate"><span class="pre">Validity</span></code> section of the output, and make sure the time span does not
exceed 398 days.</p></li>
<li><p>Modern browsers and clients require the <strong>Subject Alternative Name</strong> (SAN)
field. Make sure this shows the DNS name of your server, such as
<code class="docutils literal notranslate"><span class="pre">DNS:clustercoord.example.com</span></code>. Certificates without SANs are not supported.</p></li>
</ul>


<h4 id="invalid-certificates">Invalid certificates<a class="headerlink" href="#invalid-certificates" title="Permalink to this headline">#</a></h4>
<p>If your certificate does not pass validation, or does not show the expected
information upon inspection, contact the group or vendor who provided it.</p>


<span id="troubleshooting-keystore"></span><h4 id="inspect-jks-keystores">Inspect JKS keystores<a class="headerlink" href="#inspect-jks-keystores" title="Permalink to this headline">#</a></h4>
<p>The Java KeyStore (JKS) system is provided by your Java installation. JKS keys
are stored in a JKS keystore file.</p>
<p>Inspect the JKS keystore file to make sure it contains the correct information
for your PrestoSQL server. Use the <code class="docutils literal notranslate"><span class="pre">keytool</span></code> command, which is installed as part
of Java, to retrieve information from your keystore container file:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>keytool -list -v -keystore yourKeystore.jks
</pre></div>
</div>
<p>Keystores always require a password. If not provided on the <code class="docutils literal notranslate"><span class="pre">keytool</span></code> command
line, <code class="docutils literal notranslate"><span class="pre">keytool</span></code> prompts for the password.</p>
<p>Independent of the keystore’s password, it is possible that the JKS key has its
own password. It is easiest to make sure these passwords are the same. If the
JKS key inside the keystore has a different password, you must specify it with
the <code class="docutils literal notranslate"><span class="pre">https-server.https.keymanager.password</span></code> configuration property described
below.</p>
<p>In the output of the <code class="docutils literal notranslate"><span class="pre">keytool</span> <span class="pre">-list</span></code> command, look for:</p>
<ul>
<li><p>The keystore must contain a private key, such as <code class="docutils literal notranslate"><span class="pre">Entry</span> <span class="pre">type:</span>
<span class="pre">PrivateKeyEntry</span></code></p></li>
<li><p>Depending on the origin of your keystore file, it <em>may</em> also contain a
certificate. Example: <code class="docutils literal notranslate"><span class="pre">Entry</span> <span class="pre">type:</span> <span class="pre">trustedCertEntry</span></code></p></li>
<li><p>Confirm that the <code class="docutils literal notranslate"><span class="pre">Valid</span> <span class="pre">from</span> <span class="pre">...</span> <span class="pre">until</span></code> entry shows no more than 398 days.</p></li>
<li><p>Verify that the subject alternative name, if present, matches your server’s
DNS name. Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>SubjectAlternativeName [
    DNSName:  cluster.example.com
]
</pre></div>
</div>
</li>
</ul>
<p>The JKS system works in conjunction with a truststore, described in
<a class="reference internal" href="tls.html#cli-java-truststore"><span class="std std-ref">Java truststore</span></a>.</p>



<span id="cert-placement"></span><h3 id="place-the-certificate-file">Place the certificate file<a class="headerlink" href="#place-the-certificate-file" title="Permalink to this headline">#</a></h3>
<p>There are no location requirements for the certificate file as long as the
following applies:</p>
<ul class="simple">
<li><p>The location is visible from the server’s configuration file location with a
relative path reference from the server’s root directory, or with an absolute
path reference.</p></li>
<li><p>The location is secure from copying or tampering by malicious actors.</p></li>
</ul>
<p>You can place your file in the PrestoSQL server’s <code class="docutils literal notranslate"><span class="pre">etc</span></code> directory, which allows
you to use a relative path reference in configuration files. However, this
location can require you to keep track of the certificate file, and move it to
a new <code class="docutils literal notranslate"><span class="pre">etc</span></code> directory when you upgrade your PrestoSQL version.</p>


<span id="configure-https"></span><h3 id="configure-the-coordinator">Configure the coordinator<a class="headerlink" href="#configure-the-coordinator" title="Permalink to this headline">#</a></h3>
<p>On the coordinator, add the following lines to <a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">the config properties file</span></a> to enable HTTPS support for the server.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Legacy <code class="docutils literal notranslate"><span class="pre">keystore</span></code> and <code class="docutils literal notranslate"><span class="pre">truststore</span></code> wording is used in property names,
even when using PEM format certificates. PEM certs generally do not require
truststore properties, because this format incorporates its chain of
authorizing certificates back to the originating CA (or possibly back to an
intermediate CA assigned by a large international CA).</p>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.enabled=true
http-server.https.port=8443
http-server.https.keystore.path=etc/clustercoord.pem
</pre></div>
</div>
<p>Possible alternatives for the third line include:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.keystore.path=etc/clustercoord.jks
http-server.https.keystore.path=/usr/local/certs/clustercoord.p12
</pre></div>
</div>
<p>Relative paths are relative to the PrestoSQL server’s root directory. In a
<code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> installation, the root directory is one level above <code class="docutils literal notranslate"><span class="pre">etc</span></code>.</p>
<p>JKS keystores always require a password, while PEM format certificates can
optionally require a password. For these cases, add the following line to
specify the password.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.keystore.key=&lt;keystore-password&gt;
</pre></div>
</div>
<p>It is possible for a key inside a keystore to have its own password,
independent of the keystore’s password. In this case, specify the key’s password
with the following property:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.keymanager.password=&lt;key-password&gt;
</pre></div>
</div>
<p>Restart the server and test connecting to it with a URL that begins with
<code class="docutils literal notranslate"><span class="pre">https://</span></code> using the PrestoSQL <a class="reference internal" href="../installation/cli.html"><span class="doc">CLI</span></a> or <a class="reference internal" href="../admin/web-interface.html"><span class="doc">Web UI</span></a>.</p>
<p>When your PrestoSQL coordinator has an authenticator enabled along with HTTPS
enabled, it disables HTTP access to the <a class="reference internal" href="../admin/web-interface.html"><span class="doc">Web UI</span></a>.
Although not recommended, you can re-enable it by setting:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.authentication.allow-insecure-over-http=true
</pre></div>
</div>
<p>When configured to provide HTTPS connections as shown above, the server
continues to allow HTTP connections to all clients except the Web UI. When
you are certain HTTPS connections are stable and reliable from the clients of
interest, you can disable HTTP access:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.http.enabled=false
</pre></div>
</div>
<p>However, there are configuration scenarios such as HA that requires HTTP to be
enabled, even with HTTPS enabled for client access. In these cases, configure
both server types as <code class="docutils literal notranslate"><span class="pre">enabled=true</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.http.enabled=true
http-server.https.enabled=true
</pre></div>
</div>





          </article>
        </div>
      </div>
    </main>
  </div>
<div class="md-grid md-main__inner" style="height: auto;">
  <div class="md-content">
    <div class="feedback-container md-content__inner md-typeset">
      <div class="feedback-thumbs">
        <p>Is the information on this page helpful?</p>
        <p class="feedback-option" title="yes">Yes</p>
        <p class="feedback-option" title="no">No</p>
      </div>
      <div class="feedback-message">
        <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
        <button type="button" onclick="sendMessage()" class="feedback-button">Submit</button>
        <a onclick="skip()" class="feedback-skip">Skip</a>
      </div>
    </div>
  </div>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '');
</script>
<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="security-overview.html" title="Security overview"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Security overview </span>
              </div>
            </a>
          
          
            <a href="tls.html" title="Keystores and truststores"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Keystores and truststores </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>

<!-- custom footer should go here in time -->

<div style="background: #000A2C; align-content: center; height: 5em;">

</div>
  </body>
</html>