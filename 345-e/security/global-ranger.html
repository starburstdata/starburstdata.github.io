

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Global access control with Apache Ranger &#8212; Starburst Enterprise Presto</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/algolia.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <link rel="stylesheet" type="text/css" href="../_static/search.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/main.js"></script>
    <script src="../_static/algolia.js"></script>
    <script src="../_static/searchbox.js"></script>
    <script src="../_static/searchresults.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hive access control with Apache Ranger" href="hive-ranger.html" />
    <link rel="prev" title="Apache Ranger overview" href="ranger-overview.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#security/global-ranger" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Starburst Enterprise Presto"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise Presto logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise Presto</span>
          <span class="md-header-nav__topic"> Global access control with Apache Ranger </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        <div id="algolia-search">
  <div id="searchbox"></div>
  <div id="refinement-list">
    <h6 class="filter-label">Filter:</h6>
  </div>
  <div id="hits"></div>
  <div id="stats"></div>
</div>
      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (360-e)" href="/360-e/">Latest LTS (360-e)</a>
      
          <a title="356-e LTS" href="/356-e/">356-e LTS</a>
      
          <a title="350-e LTS" href="/350-e/">350-e LTS</a>
      
          <a title="345-e LTS" href="/345-e/">345-e LTS</a>
      
          <a title="Latest STS (359-e)" href="/359-e/">Latest STS (359-e)</a>
      
          <a title="358-e STS" href="/358-e/">358-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../security.html" class="md-tabs__link">Security</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise Presto" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise Presto">Starburst Enterprise Presto</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mission-control.html" class="md-nav__link">Mission Control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Kubernetes with Helm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="security-overview.html" class="md-nav__link">Security overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https.html" class="md-nav__link">HTTPS and TLS</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tls.html" class="md-nav__link">PEM, keystore, and truststore files</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-file.html" class="md-nav__link">Password file authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap.html" class="md-nav__link">LDAP authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="salesforce.html" class="md-nav__link">Salesforce authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="okta-authentication.html" class="md-nav__link">Okta authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="server.html" class="md-nav__link">Kerberos authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cli.html" class="md-nav__link">Kerberos authentication with CLI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-mapping.html" class="md-nav__link">User mapping</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="group-file.html" class="md-nav__link">File-based group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap-group-provider.html" class="md-nav__link">LDAP group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="access-control.html" class="md-nav__link">Access control overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="built-in-system-access-control.html" class="md-nav__link">Built-in system access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="file-system-access-control.html" class="md-nav__link">File-based system access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="impersonation.html" class="md-nav__link">User impersonation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-passthrough.html" class="md-nav__link">Password credential passthrough</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kerberos-passthrough.html" class="md-nav__link">Kerberos credential passthrough</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ranger-overview.html" class="md-nav__link">Apache Ranger overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Global access control with Apache Ranger </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Global access control with Apache Ranger</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-global-ranger--page-root" class="md-nav__link">Global access control with Apache Ranger</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ranger-installation-and-configuration" class="md-nav__link">Ranger installation and configuration</a>
        </li>
        <li class="md-nav__item"><a href="#ranger-plugin-configuration" class="md-nav__link">Ranger plugin configuration</a>
        </li>
        <li class="md-nav__item"><a href="#resource-sets" class="md-nav__link">Resource sets</a>
        </li>
        <li class="md-nav__item"><a href="#privilege-sets" class="md-nav__link">Privilege sets</a>
        </li>
        <li class="md-nav__item"><a href="#denying-access-to-specific-tables-and-columns" class="md-nav__link">Denying access to specific tables and columns</a>
        </li>
        <li class="md-nav__item"><a href="#presto-ranger-plugin-upgrade" class="md-nav__link">Presto Ranger plugin upgrade</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-ranger.html" class="md-nav__link">Hive access control with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="global-privacera.html" class="md-nav__link">Global access control with Privacera Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-privacera.html" class="md-nav__link">Hive access control with Privacera Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-sentry.html" class="md-nav__link">Hive access control with Apache Sentry</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internal-communication.html" class="md-nav__link">Secure internal communication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="secrets.html" class="md-nav__link">Secrets management</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="audit.html" class="md-nav__link">Query audit</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="event-logger.html" class="md-nav__link">Event logger</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../migration.html" class="md-nav__link">Migration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">345-e.14 LTS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">-</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-global-ranger--page-root" class="md-nav__link">Global access control with Apache Ranger</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ranger-installation-and-configuration" class="md-nav__link">Ranger installation and configuration</a>
        </li>
        <li class="md-nav__item"><a href="#ranger-plugin-configuration" class="md-nav__link">Ranger plugin configuration</a>
        </li>
        <li class="md-nav__item"><a href="#resource-sets" class="md-nav__link">Resource sets</a>
        </li>
        <li class="md-nav__item"><a href="#privilege-sets" class="md-nav__link">Privilege sets</a>
        </li>
        <li class="md-nav__item"><a href="#denying-access-to-specific-tables-and-columns" class="md-nav__link">Denying access to specific tables and columns</a>
        </li>
        <li class="md-nav__item"><a href="#presto-ranger-plugin-upgrade" class="md-nav__link">Presto Ranger plugin upgrade</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="security-global-ranger--page-root">Global access control with Apache Ranger<a class="headerlink" href="#security-global-ranger--page-root" title="Permalink to this headline">#</a></h1>
<p>The integration of <a class="reference external" href="https://ranger.apache.org/">Apache Ranger</a> with Starburst
Enterprise Presto enables a <a class="reference internal" href="access-control.html"><span class="doc">global access control</span></a> for all configured catalogs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Global access control with Apache Ranger requires a valid
<a class="reference internal" href="../installation/license-requirements.html"><span class="doc">Starburst Enterprise Presto license</span></a>.</p>
</div>
<p>Policies in Ranger are created with the Ranger user interface and define access
and authorization. Each policy combines user and group information with a
resource and access rights to the resource. Ranger is configured to your
organization’s LDAP system for user and group information. Ranger usage requires
the installation of the Presto Ranger plugin. It creates the Starburst
Enterprise Presto <code class="docutils literal notranslate"><span class="pre">starburst-enterprise-presto</span></code> service type, or service
definition, in Ranger. This encompasses a Presto-specific set of resources that
include catalog, schema, table, column, and more, so access rules for there
resources can be configured in Ranger. Specific user interface elements with
drop down and auto-completion are available for all resources.</p>
<p>The Ranger Presto plugin is responsible for connecting to Ranger from Presto and
using the defined policies for Presto resources. Any user action in Presto, such
as submitting a query, is validated against the policies from Ranger and
potentially prevented.</p>
<p>For example, a query is parsed and analyzed to determine all involved resources
such as schemas and tables. Once a list is created, all policies are analyzed in
Presto to determine if the user initiating the query has all necessary access
rights. Processing only continues if all rights are granted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Contrary to the <a class="reference internal" href="hive-ranger.html"><span class="doc">Hive level security</span></a>, the global access
control with Ranger is suitable to define role-based access to catalogs using
any connector as well as a number of other system resources.</p>
</div>
<p>Using Ranger for role-based access control can be summarized in a few steps:</p>
<ul class="simple">
<li><p>Install Ranger and add the Presto Ranger plugin</p></li>
<li><p>Configure Ranger for user and group information from LDAP</p></li>
<li><p>Configure Presto to use Ranger</p></li>
<li><p>Define policies with the Ranger user interface</p></li>
<li><p>Enjoy the access control for catalogs, schema, tables and more for all users</p></li>
</ul>
<p>Details for all these steps and more are documented in the following sections.</p>

<h2 id="ranger-installation-and-configuration">Ranger installation and configuration<a class="headerlink" href="#ranger-installation-and-configuration" title="Permalink to this headline">#</a></h2>
<p>Your first important step is the installation and configuration of
Ranger, which can be summarized to the following steps:</p>
<ul class="simple">
<li><p>Install Ranger 2.0.0 or higher</p></li>
<li><p>Configure Ranger to access your LDAP system for user, group and role
information</p></li>
<li><p>Add Presto Ranger plugin to Ranger</p></li>
</ul>
<p><strong>Installation</strong></p>
<p>AWS CloudFoundation deployment</p>
<blockquote>
<div><p>The Starburst support for Amazon CFT-based installation includes installation
of Apache Ranger and all relevant configuration. Detailed information is
available in the <a class="reference internal" href="../aws/deploy.html#cft-ranger-configuration"><span class="std std-ref">AWS documentation</span></a>.</p>
</div></blockquote>
<p>K8s deployment</p>
<blockquote>
<div><p>The Starburst support for Kubernetes-based installation includes installation
of Apache Ranger and all relevant configuration. Detailed information is
available in the <a class="reference internal" href="../k8s.html"><span class="doc">Kubernetes documentation</span></a>.</p>
</div></blockquote>
<p>Connect existing Ranger</p>
<blockquote>
<div><p>Using an existing Ranger 2.0.0 or higher is supported. You just have to make
sure that the coordinator has network access to Ranger and LDAP is configured,
so that all relevant users, groups and roles are available. As a next step you
need install the Presto Ranger Plugin.</p>
</div></blockquote>
<p>Manual Ranger installation</p>
<blockquote>
<div><p>If you are running Presto on-premise or some other custom deployment, you need
to install Ranger 2.0.0 or higher following the documentation from the Ranger
project.</p>
</div></blockquote>
<p><strong>Connect Ranger to LDAP</strong></p>
<p>Ranger needs to access the information about your users, groups and roles in
your LDAP system. With the K8s and AWS installation methods, all details are
already configured. For existing Ranger usage or manual installation, you need
to ensure that Ranger is connected to your LDAP directory provider and a
synchronization process is in place. The process varies based on your LDAP
system and documented in the Ranger documentation.</p>
<p id="presto-ranger-plugin-manual-install"><strong>Presto Ranger plugin</strong></p>
<p>The Presto Ranger plugin is automatically installed with Ranger when using the
AWS CFT and Kubernetes installations. For existing Ranger instances or custom
Ranger installations, follow the steps below:</p>
<ul class="simple">
<li><p>Download JAR files <code class="docutils literal notranslate"><span class="pre">presto-ranger-plugin.jar</span></code> and <code class="docutils literal notranslate"><span class="pre">presto-jdbc.jar</span></code>.
Contact Starburst support if you do not have access to these files.</p></li>
<li><p>Place the JAR files in <code class="docutils literal notranslate"><span class="pre">${RANGER_HOME}/ews/webapp/WEB-INF/lib</span></code> directory on
the Ranger server.</p></li>
<li><p>Add the necessary <a class="reference internal" href="#ranger-system-plugin-configuration"><span class="std std-ref">Ranger plugin configuration</span></a> to connect Presto to Ranger.</p></li>
<li><p>Restart the Ranger server and the Presto cluster.</p></li>
<li><p>Execute a <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">SCHEMAS</span> <span class="pre">FROM</span> <span class="pre">&lt;CATALOG&gt;;</span></code> query from Presto, which creates
the Starburst Enterprise Presto service type in Ranger. An access denied
exception indicates the connection to Ranger is successful.</p></li>
<li><p>Access the Ranger user interface and confirm that you can find the
<em>Starburst Enterprise Presto</em> service type.</p></li>
<li><p>Add an SEP service type with a service name that matches Presto’s
<code class="docutils literal notranslate"><span class="pre">ranger.service-name</span></code> configuration property by clicking the “plus” icon
next to the SEP service type in the Ranger Service Manager.</p></li>
</ul>
<p>With the Presto Ranger plugin installed in Ranger, you can create one or
multiple services with the SEP. This allows you to have separate services for
different Presto clusters.</p>


<span id="ranger-system-plugin-configuration"></span><h2 id="ranger-plugin-configuration">Ranger plugin configuration<a class="headerlink" href="#ranger-plugin-configuration" title="Permalink to this headline">#</a></h2>
<p>With Ranger installed and configured you are now ready to configure Ranger as
the activated <a class="reference internal" href="built-in-system-access-control.html"><span class="doc">access control system</span></a>. Update <code class="docutils literal notranslate"><span class="pre">etc/config.properties</span></code>
and set the path to your Ranger access control configuration file:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">access-control.config-files</span><span class="o">=</span><span class="s">etc/access-control-ranger.properties</span>
</pre></div>
</div>
<p>Subsequently configure details in the file:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">access-control.name</span><span class="o">=</span><span class="s">ranger</span>
<span class="na">ranger.policy-rest-url</span><span class="o">=</span><span class="s">http://ranger.example.com:6080</span>
<span class="na">ranger.service-name</span><span class="o">=</span><span class="s">presto-production</span>
<span class="na">ranger.presto-plugin-username</span><span class="o">=</span><span class="s">&lt;username&gt;</span>
<span class="na">ranger.presto-plugin-password</span><span class="o">=</span><span class="s">&lt;password&gt;</span>
<span class="na">ranger.policy-refresh-interval</span><span class="o">=</span><span class="s">30s</span>
</pre></div>
</div>
<p>More details about the supported <a class="reference internal" href="ranger-overview.html#ranger-config-properties"><span class="std std-ref">configuration properties is available in
the Ranger overview</span></a>.</p>


<h2 id="resource-sets">Resource sets<a class="headerlink" href="#resource-sets" title="Permalink to this headline">#</a></h2>
<p>A resource set includes one or more resources of different resource types.
Wildcard characters are supported to select a number of resources based on a
pattern.</p>
<ul class="simple">
<li><p>catalog</p></li>
<li><p>catalog - schema</p></li>
<li><p>catalog - schema - table</p></li>
<li><p>catalog - schema - table - column</p></li>
<li><p>catalog - schema - procedure</p></li>
<li><p>catalog - session property</p></li>
<li><p>function</p></li>
<li><p>system session property</p></li>
<li><p>query</p></li>
</ul>
<p>As you can see from the list above, some resources are hierarchically organized
within a catalog and below. This allows you for example to restrict access to a
complete catalog, a specific schema, or table or even down to a column or a
procedure within a schema.</p>
<p>For example, if you can define a set of resources, that allows you to restrict
access to all the two tables <code class="docutils literal notranslate"><span class="pre">credit-info</span></code> and <code class="docutils literal notranslate"><span class="pre">cards-info</span></code> in all schemas
in the <code class="docutils literal notranslate"><span class="pre">hdfs</span></code> catalog.</p>
<ul class="simple">
<li><p>Catalog: hdfs</p></li>
<li><p>Schema: *</p></li>
<li><p>Table: credit-info, cards-info</p></li>
</ul>
<p>A set of resource works as a primary key for a policy. It needs to be unique.
Multiple policies however may cover a single resource because of the wildcard.</p>


<h2 id="privilege-sets">Privilege sets<a class="headerlink" href="#privilege-sets" title="Permalink to this headline">#</a></h2>
<p>A set of privileges consists of one or more user groups, roles and users, and a
set of access types for the specified resource set. Privileges can allow or deny operations.</p>
<p>The catalog, schema, table and column resources, which grant access to resources
for queries, have the following access types.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SELECT</span></code> to read data from the resource.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INSERT</span></code> to add data to the resource.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> to change data in the resource.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code> to remove data from the resource.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OWNERSHIP</span></code> to claim ownership of the resource, which provides complete
access.</p></li>
</ul>
<p>In addition there are privileges that determine access to queries and their
usage, and are therefore of a more general nature.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SELECT</span></code> to list queries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXECUTE</span></code> to initiate processing of any query. Without this privilege user
action is extremely limited.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">KILL</span></code> to stop processing of any query.</p></li>
</ul>


<span id="system-ranger-deny"></span><h2 id="denying-access-to-specific-tables-and-columns">Denying access to specific tables and columns<a class="headerlink" href="#denying-access-to-specific-tables-and-columns" title="Permalink to this headline">#</a></h2>
<p>You may need to restrict access for users to tables or columns for security or
other reasons.</p>
<p>The following example shows how to achieve that for any <code class="docutils literal notranslate"><span class="pre">$path</span></code> column and any
<code class="docutils literal notranslate"><span class="pre">$partitions</span></code> table exposed by a catalog called <code class="docutils literal notranslate"><span class="pre">hive</span></code>:</p>
<ul class="simple">
<li><p>Create a Ranger <code class="docutils literal notranslate"><span class="pre">ALLOW</span></code> policy with <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> access type and assign it to
the users, groups or roles you need.</p></li>
<li><p>Add a pattern to allow all resources in the the <code class="docutils literal notranslate"><span class="pre">hive</span></code> catalog:</p>
<ul>
<li><p>catalog: <code class="docutils literal notranslate"><span class="pre">hive</span></code></p></li>
<li><p>schema: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
<li><p>table: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
<li><p>column: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
</ul>
</li>
<li><p>Create a similar policy, this time with the <code class="docutils literal notranslate"><span class="pre">DENY</span></code> type.</p></li>
<li><p>Add a pattern to deny access to the <code class="docutils literal notranslate"><span class="pre">$path</span></code> column:</p>
<ul>
<li><p>catalog: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
<li><p>schema: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
<li><p>table: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
<li><p>column: <code class="docutils literal notranslate"><span class="pre">$path</span></code></p></li>
</ul>
</li>
<li><p>Create another <code class="docutils literal notranslate"><span class="pre">DENY</span></code> policy that restricts access to <code class="docutils literal notranslate"><span class="pre">$partitions</span></code>
tables:</p>
<ul>
<li><p>catalog: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
<li><p>schema: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
<li><p>table: <code class="docutils literal notranslate"><span class="pre">*$partitions</span></code></p></li>
<li><p>column: <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
</ul>
</li>
</ul>
<p>This method of restricting access works, because Ranger processes <code class="docutils literal notranslate"><span class="pre">DENY</span></code>
policies before <code class="docutils literal notranslate"><span class="pre">ALLOW</span></code> policies, when evaluating conditions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">$path</span></code> column is an artificial column in Hive.  It contains information
about the location of data file. The <code class="docutils literal notranslate"><span class="pre">table$partitions</span></code> table contains
internal information about the partitioning of the table. All this information
should typically not be available to normal users. The above examples shows
how you can implement this best practice for catalogs using the Hive
connector.</p>
</div>


<h2 id="presto-ranger-plugin-upgrade">Presto Ranger plugin upgrade<a class="headerlink" href="#presto-ranger-plugin-upgrade" title="Permalink to this headline">#</a></h2>
<p><strong>Typically</strong> you automatically get the latest version of the Presto Ranger
plugin, when updating and there is <strong>no necessary configuration changes</strong> you
need to apply.</p>
<p>One exception is if you use user impersonation in combination with Ranger. This
feature is new with version 345-e, and if you are upgrading to that
release you need to perform the following manual upgrade steps.</p>
<p>Before starting this upgrade, you need to gather the following information:</p>
<ul class="simple">
<li><p>the path to your current Presto Ranger plugin, for example
<code class="docutils literal notranslate"><span class="pre">${RANGER_HOME}/ews/webapp/WEB-INF/lib/presto-ranger-plugin-2.0.33.jar</span></code></p></li>
<li><p>your Ranger host information</p></li>
<li><p>the Ranger plugin download, version 2.0.34+</p></li>
</ul>
<p>The changes need to be performed while Presto is not running.</p>
<p>Remove the old plugin:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>rm <span class="si">${</span><span class="nv">RANGER_HOME</span><span class="si">}</span>/ews/webapp/WEB-INF/lib/presto-ranger-plugin-*.jar
</pre></div>
</div>
<p>Add the new plugin:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp presto-ranger-plugin-*.jar <span class="si">${</span><span class="nv">RANGER_HOME</span><span class="si">}</span>/ews/webapp/WEB-INF/lib
</pre></div>
</div>
<p>Copy the service definition and start Ranger.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp servicedef.json <span class="si">${</span><span class="nv">RANGER_BASE</span><span class="si">}</span>
<span class="si">${</span><span class="nv">RANGER_BASE</span><span class="si">}</span>/start.sh
</pre></div>
</div>
<p>Determine your <code class="docutils literal notranslate"><span class="pre">RANGERADMINSESSIONID</span></code> as per your Ranger documentation.</p>
<p><a class="reference download internal" download="" href="../_downloads/655215c25d920c52bd84f25678c1afd7/put_servicedef.http"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">service</span> <span class="pre">definition</span></code></a></p>
<p>Update the host and session id and submit it to Ranger.</p>
<p>After the service definitions have been updated, start Presto.</p>




          </article>
        </div>
      </div>
    </main>
  </div>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="ranger-overview.html" title="Apache Ranger overview"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Apache Ranger overview </span>
              </div>
            </a>
          
          
            <a href="hive-ranger.html" title="Hive access control with Apache Ranger"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Hive access control with Apache Ranger </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>

<!-- custom footer should go here in time -->

<div style="background: #000A2C; align-content: center; height: 5em;">

</div>
  </body>
</html>