

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>HTTPS and TLS &#8212; Starburst Enterprise Presto</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/presto.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PEM, keystore, and truststore files" href="tls.html" />
    <link rel="prev" title="Security overview" href="security-overview.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#security/https" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Starburst Enterprise Presto"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise Presto logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise Presto</span>
          <span class="md-header-nav__topic"> HTTPS and TLS </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (345-e)" href="/345-e/">Latest LTS (345-e)</a>
      
          <a title="338-e LTS" href="/338-e/">338-e LTS</a>
      
          <a title="332-e LTS" href="/332-e/">332-e LTS</a>
      
          <a title="323-e LTS" href="/323-e/">323-e LTS</a>
      
          <a title="Latest STS (344-e)" href="/344-e/">Latest STS (344-e)</a>
      
          <a title="343-e STS" href="/343-e/">343-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../security.html" class="md-tabs__link">Security</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise Presto" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise Presto">Starburst Enterprise Presto</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Kubernetes with Helm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../kubernetes.html" class="md-nav__link">Kubernetes operator</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="security-overview.html" class="md-nav__link">Security overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> HTTPS and TLS </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">HTTPS and TLS</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-https--page-root" class="md-nav__link">HTTPS and TLS</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#approaches" class="md-nav__link">Approaches</a>
        </li>
        <li class="md-nav__item"><a href="#use-a-load-balancer-to-terminate-https-tls" class="md-nav__link">Use a load balancer to terminate HTTPS/TLS</a>
        </li>
        <li class="md-nav__item"><a href="#secure-presto-directly" class="md-nav__link">Secure Presto directly</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#add-a-tls-certificate" class="md-nav__link">Add a TLS certificate</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#inspect-pem-certificates" class="md-nav__link">Inspect PEM certificates</a>
        </li>
        <li class="md-nav__item"><a href="#validate-pem-certificates" class="md-nav__link">Validate PEM certificates</a>
        </li>
        <li class="md-nav__item"><a href="#inspect-jks-keystores" class="md-nav__link">Inspect JKS keystores</a>
        </li>
        <li class="md-nav__item"><a href="#import-ca-certificate-into-jks-keystore" class="md-nav__link">Import CA certificate into JKS keystore</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#place-the-certificate-file" class="md-nav__link">Place the certificate file</a>
        </li>
        <li class="md-nav__item"><a href="#configure-the-coordinator" class="md-nav__link">Configure the coordinator</a>
        </li>
        <li class="md-nav__item"><a href="#additional-configuration-for-truststores" class="md-nav__link">Additional configuration for truststores</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tls.html" class="md-nav__link">PEM, keystore, and truststore files</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-file.html" class="md-nav__link">Password file authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap.html" class="md-nav__link">LDAP authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="salesforce.html" class="md-nav__link">Salesforce authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="okta-authentication.html" class="md-nav__link">Okta authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="server.html" class="md-nav__link">Kerberos authentication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cli.html" class="md-nav__link">Kerberos authentication with CLI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-mapping.html" class="md-nav__link">User mapping</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="group-file.html" class="md-nav__link">File-based group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ldap-group-provider.html" class="md-nav__link">LDAP group provider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="access-control.html" class="md-nav__link">Access control overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="built-in-system-access-control.html" class="md-nav__link">Built-in system access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="file-system-access-control.html" class="md-nav__link">File-based system access control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="impersonation.html" class="md-nav__link">User impersonation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="password-passthrough.html" class="md-nav__link">Password credential passthrough</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kerberos-passthrough.html" class="md-nav__link">Kerberos credential passthrough</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ranger-overview.html" class="md-nav__link">Apache Ranger overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="global-ranger.html" class="md-nav__link">Global access control with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-ranger.html" class="md-nav__link">Hive access control with Apache Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="global-privacera.html" class="md-nav__link">Global access control with Privacera Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-privacera.html" class="md-nav__link">Hive access control with Privacera Ranger</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-sentry.html" class="md-nav__link">Hive access control with Apache Sentry</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internal-communication.html" class="md-nav__link">Secure internal communication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="secrets.html" class="md-nav__link">Secrets management</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="audit.html" class="md-nav__link">Query audit</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="event-logger.html" class="md-nav__link">Event logger</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../migration.html" class="md-nav__link">Migration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">345-e.1 LTS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">-</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#security-https--page-root" class="md-nav__link">HTTPS and TLS</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#approaches" class="md-nav__link">Approaches</a>
        </li>
        <li class="md-nav__item"><a href="#use-a-load-balancer-to-terminate-https-tls" class="md-nav__link">Use a load balancer to terminate HTTPS/TLS</a>
        </li>
        <li class="md-nav__item"><a href="#secure-presto-directly" class="md-nav__link">Secure Presto directly</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#add-a-tls-certificate" class="md-nav__link">Add a TLS certificate</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#inspect-pem-certificates" class="md-nav__link">Inspect PEM certificates</a>
        </li>
        <li class="md-nav__item"><a href="#validate-pem-certificates" class="md-nav__link">Validate PEM certificates</a>
        </li>
        <li class="md-nav__item"><a href="#inspect-jks-keystores" class="md-nav__link">Inspect JKS keystores</a>
        </li>
        <li class="md-nav__item"><a href="#import-ca-certificate-into-jks-keystore" class="md-nav__link">Import CA certificate into JKS keystore</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#place-the-certificate-file" class="md-nav__link">Place the certificate file</a>
        </li>
        <li class="md-nav__item"><a href="#configure-the-coordinator" class="md-nav__link">Configure the coordinator</a>
        </li>
        <li class="md-nav__item"><a href="#additional-configuration-for-truststores" class="md-nav__link">Additional configuration for truststores</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="security-https--page-root">HTTPS and TLS<a class="headerlink" href="#security-https--page-root" title="Permalink to this headline">#</a></h1>
<p>Presto runs with no security configuration in its default installation. This
allows you to connect to the server using URLs that specify the HTTP protocol
with the Presto <a class="reference internal" href="../installation/cli.html"><span class="doc">CLI</span></a>, the <a class="reference internal" href="../admin/web-interface.html"><span class="doc">Web UI</span></a>, or other clients.</p>
<p>This guide describes how to configure Presto to use <a class="reference external" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security
(TLS)</a>, and require
the HTTPS protocol from client connections. This is a requirement to enable any
supported authentication and authorization.</p>
<p>Transport Layer Security (TLS) is the successor to its now-deprecated
predecessor, Secure Sockets Layer (SSL). This page uses the term TLS to refer
to TLS and SSL.</p>

<h2 id="approaches">Approaches<a class="headerlink" href="#approaches" title="Permalink to this headline">#</a></h2>
<p>To configure Presto with TLS support, there are two alternative paths to
consider:</p>
<ul class="simple">
<li><p>Use the <a class="reference internal" href="#https-load-balancer"><span class="std std-ref">load balancer or proxy</span></a> at your site or
cloud environment to terminate HTTPS/TLS. This approach is the simplest and
strongly preferred solution.</p></li>
<li><p>Secure the <a class="reference internal" href="#https-presto"><span class="std std-ref">Presto server directly</span></a>. This requires you to
obtain a valid certificate, and add it to the Presto coordinator’s
configuration.</p></li>
</ul>


<span id="https-load-balancer"></span><h2 id="use-a-load-balancer-to-terminate-https-tls">Use a load balancer to terminate HTTPS/TLS<a class="headerlink" href="#use-a-load-balancer-to-terminate-https-tls" title="Permalink to this headline">#</a></h2>
<p>Your site or cloud environment may already have a load balancer or proxy server
configured and running with a valid TLS certificate. In this case, you can work
with your network administration group to set up your Presto server behind the
load balancer. It accepts TLS connections and forwards them to Presto running
with default HTTP configuration. This includes changing the port to the default
<code class="docutils literal notranslate"><span class="pre">8080</span></code>.</p>
<p>In this case, the Presto cluster is contained in a virtual private network. The
load balancer adds request headers with the original client information:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>X-Forwarded-Proto: https
X-Forwarded-Host: presto.example.com
Forwarded:  for=10.0.16.42;proto=https;by=73.159.60.147
</pre></div>
</div>
<p>To enable processing of forwarded headers, <a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">the config properties file</span></a> must include the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.process-forwarded=true
</pre></div>
</div>
<p>This completes any necessary configuration for using HTTPS with a load balancer.
Client tools can access Presto with the URL exposed by the load balancer.</p>


<span id="https-presto"></span><h2 id="secure-presto-directly">Secure Presto directly<a class="headerlink" href="#secure-presto-directly" title="Permalink to this headline">#</a></h2>
<p>Instead of the preferred mechanism of <a class="reference internal" href="#https-load-balancer"><span class="std std-ref">using an external load balancer</span></a>, you can secure the Presto coordinator itself. This
requires you to use a certificate and configure Presto to use it for any client
connections.</p>

<h3 id="add-a-tls-certificate">Add a TLS certificate<a class="headerlink" href="#add-a-tls-certificate" title="Permalink to this headline">#</a></h3>
<p>Obtain a TLS certificate file (a cert) from one of the following sources:</p>
<ul class="simple">
<li><p>Your site’s network administration group</p></li>
<li><p>Your cloud environment provider</p></li>
<li><p>A domain name registrar, such as Verisign or GoDaddy</p></li>
<li><p>A certificate vendor</p></li>
<li><p>A free certificate generator, such as <a class="reference external" href="https://letsencrypt.org/">letsencrypt.org</a> or <a class="reference external" href="https://www.sslforfree.com/">sslforfree.com</a></p></li>
<li><p>A certificate generating command such as <code class="docutils literal notranslate"><span class="pre">openssl</span></code> or <code class="docutils literal notranslate"><span class="pre">keytool</span></code></p></li>
</ul>
<p>Presto supports certificate files in PEM (PKCS #8 and PKCS #1) or JKS format.
The PEM format is preferred, and is easier to use.</p>
<p>Make sure you obtain a certificate that is certified by a recognized
certification authority (CA), or that you submit a self-generated certificate
to a CA for validation.</p>

<span id="inspect-pems"></span><h4 id="inspect-pem-certificates">Inspect PEM certificates<a class="headerlink" href="#inspect-pem-certificates" title="Permalink to this headline">#</a></h4>
<p>When you receive your PEM format certificate, inspect it and verify that it
shows the correct information for your Presto server. Use this <code class="docutils literal notranslate"><span class="pre">openssl</span></code>
command to inspect the cert:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>openssl x509 -in your-cert-file -text -nout
</pre></div>
</div>
<p>If your PEM file was generated with a password, <code class="docutils literal notranslate"><span class="pre">openssl</span></code> prompts for it.</p>
<p>The PEM file should contain server certificate and private key sections. For
example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-----BEGIN CERTIFICATE-----
MIIFHjCCAwYCCQCmg7+WHUP8ADANBgkqhkiG9w0BAQsFADBRMQswCQYDVQQGEwJV
...
-----END CERTIFICATE-----
-----BEGIN PRIVATE KEY-----
MIIJQwIBADANBgkqhkiG9w0BAQEFAASCCS0wggkpAgEAAoICAQDTWPax1rfWIvK/
....
-----END PRIVATE KEY-----
</pre></div>
</div>
<p>If you received two separate files, one for each type, just concatenate the
files into one, in the order shown above.</p>
<p>If your PEM reports <code class="docutils literal notranslate"><span class="pre">ENCRYPTED</span> <span class="pre">PRIVATE</span> <span class="pre">KEY</span></code>, you must use a password when
invoking that key.</p>
<p>In your PEM file, look for the following characteristics:</p>
<ul class="simple">
<li><p>Modern browsers now enforce 398 days as the maximum validity length. Look for
<code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">Before</span></code> and <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">After</span></code> dates in the <code class="docutils literal notranslate"><span class="pre">Validity</span></code> section of the
output, and make sure the time between does not exceed 398 days.</p></li>
<li><p>If you received an x509 version 3 certificate, it has a <strong>Subject Alternative
Name</strong> field. Make sure this shows the DNS name of your server, such as
<code class="docutils literal notranslate"><span class="pre">DNS:presto.example.com</span></code></p></li>
<li><p>The legacy common name (CN) field is ignored by modern browsers, but is good
to have. Example: <code class="docutils literal notranslate"><span class="pre">CN=presto.example.com</span></code></p></li>
</ul>


<span id="validate-pems"></span><h4 id="validate-pem-certificates">Validate PEM certificates<a class="headerlink" href="#validate-pem-certificates" title="Permalink to this headline">#</a></h4>
<p>Validate your PEM cert with the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>openssl rsa -in your-cert-file -check -noout
</pre></div>
</div>
<p>If your PEM file was generated with a password, <code class="docutils literal notranslate"><span class="pre">openssl</span></code> prompts for it. Look
for the following confirmation message:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>RSA key ok
</pre></div>
</div>
<p>If your cert does not pass validation, or does not show the expected information
after inspection, contact the group or vendor who provided it.</p>


<span id="troubleshooting-keystore"></span><h4 id="inspect-jks-keystores">Inspect JKS keystores<a class="headerlink" href="#inspect-jks-keystores" title="Permalink to this headline">#</a></h4>
<p>The Java KeyStore (JKS) system is provided by your Java installation. JKS keys
are stored in a JKS keystore file.</p>
<p>Inspect the JKS keystore file to make sure it contains the correct information
for your Presto server. Use the <code class="docutils literal notranslate"><span class="pre">keytool</span></code> command, which is installed as part
of Java, to retrieve information from your keystore container file:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>keytool -list -v -keystore your-keystore.jks
</pre></div>
</div>
<p>Keystores always require a password. If not provided on the <code class="docutils literal notranslate"><span class="pre">keytool</span></code> command
line, <code class="docutils literal notranslate"><span class="pre">keytool</span></code> prompts for the password.</p>
<p>Independent of the keystore’s password, it is possible that the JKS key has its
own password. Make sure these passwords are the same, because <code class="docutils literal notranslate"><span class="pre">keytool</span></code> only
prompts for one password at a time.</p>
<p>In the output of the <code class="docutils literal notranslate"><span class="pre">keytool</span> <span class="pre">-list</span></code> command, look for:</p>
<ul>
<li><p>The keystore must contain a private key, such as <code class="docutils literal notranslate"><span class="pre">Entry</span> <span class="pre">type:</span>
<span class="pre">PrivateKeyEntry</span></code></p></li>
<li><p>Depending on the origin of your keystore file, it <em>may</em> also contain a
certificate. Example: <code class="docutils literal notranslate"><span class="pre">Entry</span> <span class="pre">type:</span> <span class="pre">trustedCertEntry</span></code></p></li>
<li><p>Confirm that the <code class="docutils literal notranslate"><span class="pre">Valid</span> <span class="pre">from</span> <span class="pre">...</span> <span class="pre">until</span></code> entry shows no more than 398 days.</p></li>
<li><p>Verify that the subject alternative name, if present, matches your server’s
DNS name. Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>SubjectAlternativeName [
    DNSName:  presto.example.com
]
</pre></div>
</div>
</li>
</ul>


<h4 id="import-ca-certificate-into-jks-keystore">Import CA certificate into JKS keystore<a class="headerlink" href="#import-ca-certificate-into-jks-keystore" title="Permalink to this headline">#</a></h4>
<p>If you generated a self-signed JKS keystore, you must send that with a
Certificate Signing Request to a Certificate Authority. In return, you receive a
certificate keystore, possibly with <code class="docutils literal notranslate"><span class="pre">.cer</span></code> extension. Depending on the CA, you
might receive a certificate self-signed only by the issuing CA, or one signed by
a chain of validating CAs.</p>
<p>To create a certified JKS keystore, you must import the certificate received
from the CA into the keystore, using the <code class="docutils literal notranslate"><span class="pre">keytool</span> <span class="pre">-import</span></code> command. The
<code class="docutils literal notranslate"><span class="pre">keytool</span></code> command is complex and covers many cases. Please study the
<strong>Certificate Chains</strong> and <strong>Importing Certificates</strong> sections of the
<code class="docutils literal notranslate"><span class="pre">keytool</span></code> man page before proceeding.</p>
<p>The JKS system works in conjunction with JKS truststore files, described in
<a class="reference internal" href="#config-truststore"><span class="std std-ref">Additional configuration for truststores</span></a>.</p>



<span id="cert-placement"></span><h3 id="place-the-certificate-file">Place the certificate file<a class="headerlink" href="#place-the-certificate-file" title="Permalink to this headline">#</a></h3>
<p>There are no location requirements for the PEM or JKS certificate file as long
as the following applies:</p>
<ul class="simple">
<li><p>The location is visible from the server’s configuration file location with a
relative path reference from the server’s root directory, or with an absolute
path reference.</p></li>
<li><p>The location is secure from copying or tampering by malicious actors.</p></li>
</ul>
<p>You can place your PEM file or JKS keystore file in the Presto server’s <code class="docutils literal notranslate"><span class="pre">etc</span></code>
directory, which allows you to use a relative path reference in configuration
files.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> style Presto installations, if you upgrade one Presto version to
another, remember to copy the cert file to the new installation’s <code class="docutils literal notranslate"><span class="pre">etc</span></code>
directory.</p>
<p>By contrast, an RPM installation generally uses the system <code class="docutils literal notranslate"><span class="pre">/etc/presto</span></code>
directory to hold server configuration files, which are re-used after a Presto
server version upgrade.</p>


<span id="configure-https"></span><h3 id="configure-the-coordinator">Configure the coordinator<a class="headerlink" href="#configure-the-coordinator" title="Permalink to this headline">#</a></h3>
<p>On the coordinator, add the following lines to <a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">the config properties file</span></a> to enable HTTPS support for the server:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.enabled=true
http-server.https.port=8443
http-server.https.keystore.path=etc/presto-example-com.pem
</pre></div>
</div>
<p>Alternatives for the third line include:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.keystore.path=etc/presto-example-com.jks
http-server.https.keystore.path=/usr/local/etc/presto-example-com.pem
</pre></div>
</div>
<p>Relative paths are relative to the Presto server’s root directory. In a
<code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> installation, the root directory is one level above <code class="docutils literal notranslate"><span class="pre">etc</span></code>.</p>
<p>JKS keystores always require a password, and PEM certs can optionally require
one. For these cases, add the following line to specify the JKS or PEM password.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.keystore.key=&lt;keystore-password&gt;
</pre></div>
</div>
<p>Restart the server and test connecting with a URL that begins with <code class="docutils literal notranslate"><span class="pre">https://</span></code>
using the Presto <a class="reference internal" href="../installation/cli.html"><span class="doc">CLI</span></a> or <a class="reference internal" href="../admin/web-interface.html"><span class="doc">Web UI</span></a>.</p>
<p>For the Web UI, if the server is not yet configured to use authentication, you
must still enter a username, which allows Presto to track user actions. Enter
your OS username or another string according to your site’s standards.</p>
<p>With the above configuration, your server continues to allow HTTP connections as
well as HTTPS. When you are certain HTTPS connections are stable and reliable
from all clients of interest, you can disable HTTP access:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.http.enabled=false
</pre></div>
</div>
<p>However, there are configuration scenarios that require the server to respond to
HTTP requests for inter-node communication with worker nodes even with HTTPS
enabled for client access. In these cases, configure both server types as
<code class="docutils literal notranslate"><span class="pre">enabled=true</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.http.enabled=true
http-server.https.enabled=true
</pre></div>
</div>


<span id="config-truststore"></span><h3 id="additional-configuration-for-truststores">Additional configuration for truststores<a class="headerlink" href="#additional-configuration-for-truststores" title="Permalink to this headline">#</a></h3>
<p>The JKS truststore file is a list of Certificate Authorities trusted by Java to
validate private keys. The truststore file, <code class="docutils literal notranslate"><span class="pre">cacerts</span></code>, is provided as part of
your Java installation.</p>
<p>A PEM format certificate usually contains a private key for your server plus a
validating certificate that is recognized by at least one Certificate
Authority. Thus, there is no need to identify a local truststore when using
a signed PEM certificate.</p>
<p>When using JKS keys, it is possible to copy the system <code class="docutils literal notranslate"><span class="pre">cacerts</span></code> file and use
the copy. In this case, identify the location of the copy with the following
configuration properties:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http-server.https.truststore.path=etc/prestoca
http-server.https.truststore.key=&lt;truststore-password&gt;
</pre></div>
</div>





          </article>
        </div>
      </div>
    </main>
  </div>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="security-overview.html" title="Security overview"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Security overview </span>
              </div>
            </a>
          
          
            <a href="tls.html" title="PEM, keystore, and truststore files"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> PEM, keystore, and truststore files </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>

<!-- custom footer should go here in time -->

<div style="background: #000A2C; align-content: center; height: 5em;">

</div>
  </body>
</html>