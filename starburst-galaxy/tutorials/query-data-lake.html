<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Starburst | Query the COVID-19 data lake</title>
    <meta name="viewport" content="width=device-width">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Starburst - Query the COVID-19 data lake">
    <meta property="og:description" content="Your hub to all knowledge about Starburst products.">
    <meta property="og:image" content="/assets/img/starburst-og-image.png">

    <link rel="stylesheet" href="/assets/fontawesome/css/all.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/mdb.min.css">
    <link rel="stylesheet" href="/assets/css/highlight.css">
    <link rel="stylesheet" href="/assets/css/fonts.css">
    <link rel="stylesheet" href="/assets/css/style.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114610397-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-114610397-1');
</script>

<script>
  var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights@2.2.1";

  !function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
  (e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
  i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
  }(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Query the COVID-19 data lake | Starburst</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Query the COVID-19 data lake" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Your hub to all knowledge about Starburst products." />
<meta property="og:description" content="Your hub to all knowledge about Starburst products." />
<link rel="canonical" href="https://docs.starburst.io/starburst-galaxy/tutorials/query-data-lake.html" />
<meta property="og:url" content="https://docs.starburst.io/starburst-galaxy/tutorials/query-data-lake.html" />
<meta property="og:site_name" content="Starburst" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Query the COVID-19 data lake" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Your hub to all knowledge about Starburst products.","headline":"Query the COVID-19 data lake","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.starburst.io/assets/img/logo/starburst-reverse.png"}},"url":"https://docs.starburst.io/starburst-galaxy/tutorials/query-data-lake.html"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>


<div class="wrap">
  

<header class="main-header navbar-expand-sm">
  <div class="navbar fixed-top navbar-dark">
    <div class="navbar-left-container">
      <a class="navbar-brand" href="https://www.starburst.io/">
        <img src="/assets/img/logo/starburst_KO-T.png" height="32" alt="Starburst">
      </a>
      <span class="navbar-divider"></span>
      <a href="/" class="header-text">Documentation</a>
    </div>
    
    <div class="nav-item dropdown" id="site-search">
  <div id="dropdownSearchDisplay" aria-labelledby="dropdownSearch">
    <div id="algolia-search">
      <div id="searchbox"></div>
      <div id="refinement-list">
        <h6>Filter:</h6>
      </div>
      <div id="hits"></div>
      <div id="stats"></div>
    </div>
  </div>
</div>

    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>
    <nav class="primary-nav">
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-layout navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a id="get-started"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Get started" data-is-click="false"
              href="/get-started/index.html">Get started</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/get-started/concepts.html">Concepts</a>
              <a class="dropdown-item" href="/get-started/architecture.html">Architecture</a>
              <a class="dropdown-item" href="/get-started/data-sources-catalogs.html">Data sources and catalogs</a>
              <a class="dropdown-item" href="/get-started/security.html">Security</a>
              <a class="dropdown-item" href="/get-started/choose-your-starburst-product.html">Choose your Starburst product</a>
              <a class="dropdown-item" href="/data-consumer/index.html">Data consumer</a>
              <a class="dropdown-item" href="/data-engineer/index.html">Data engineer</a>
              <a class="dropdown-item" href="/platform-administrator/index.html">Platform administrator</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="starburst-galaxy"
               class="nav-link dropdown-toggle active"
              
              aria-haspopup="true" aria-label="Starburst Galaxy" data-is-click="false"
              href="/starburst-galaxy/index.html">Starburst Galaxy</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/starburst-galaxy/query/index.html">Query</a>
              <a class="dropdown-item" href="/starburst-galaxy/catalogs/index.html">Catalogs</a>
              <a class="dropdown-item" href="/starburst-galaxy/clusters/index.html">Clusters</a>
              <a class="dropdown-item" href="/starburst-galaxy/sql/index.html">SQL</a>
              <a class="dropdown-item" href="/starburst-galaxy/admin/index.html">Admin</a>
              <a class="dropdown-item" href="/starburst-galaxy/access-control/index.html">Access control</a>
              <a class="dropdown-item" href="/starburst-galaxy/cloud-settings/index.html">Cloud settings</a>
              <a class="dropdown-item" href="/starburst-galaxy/security/index.html">Security</a>
              <a class="dropdown-item" href="/starburst-galaxy/sso/index.html">Single sign-on</a>
              <a class="dropdown-item" href="/starburst-galaxy/api.html">API</a>
              <a class="dropdown-item" href="/starburst-galaxy/tutorials/index.html">Tutorials</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="starburst-enterprise"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Get started" data-is-click="false"
              href="/starburst-enterprise/index.html">Starburst Enterprise</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/starburst-enterprise/try/index.html">Try Starburst Enterprise</a>
              <a class="dropdown-item" href="/starburst-enterprise/web-ui/index.html">Web UI</a>
              <a class="dropdown-item" href="/starburst-enterprise/sql.html">SQL</a>
              <a class="dropdown-item" href="/starburst-enterprise/admin-topics/index.html">Administration</a>
              <a class="dropdown-item" href="/starburst-enterprise/k8s/index.html">Kubernetes deployments</a>
              <a class="dropdown-item" href="/starburst-enterprise/starburst-admin/index.html">Starburst Admin</a>
              <a class="dropdown-item" href="/latest/index.html">Reference documentation</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="ecosystems"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Get started" data-is-click="false"
              href="/ecosystems/index.html">Ecosystems</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/ecosystems/amazon/index.html">Amazon AWS</a>
              <a class="dropdown-item" href="/ecosystems/google/index.html">Google Cloud</a>
              <a class="dropdown-item" href="/ecosystems/microsoft/index.html">Microsoft Azure</a>
              <a class="dropdown-item" href="/ecosystems/redhat/index.html">Red Hat OpenShift</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="resources"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="resources" data-is-click="false"
              href="/resources.html">Resources</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/support.html">Support</a>
              <a class="dropdown-item" href="/security/index.html">Security</a>
              <a class="dropdown-item" href="/blog/index.html">Developer blog</a>
              <a class="dropdown-item" href="/videos/index.html">Video library</a>
              <a class="dropdown-item" href="/glossary.html">Glossary</a>
              <a class="dropdown-item" href="https://www.trinoforum.org/">Trino forum</a>
            </div>
          </li>
        </ul>
      </div>
    </nav>
</header>

  
  <div class="content">
    <div class="row">
      <div class="col-md-3 side-navigation">
        <div class="spacer-60 toc-sticky left-nav">
          
          <div>
    <h6 class="overline product-nav-title">Starburst Galaxy</h6>
</div>
<hr />

 
  
    
    
<li >
  <a href="/starburst-galaxy/index.html" >Overview</a>
</li>
  



 
  
    
    
<li >
  <a href="/starburst-galaxy/get-started.html" >Get started</a>
</li>
  



 





<li 
    onclick="toggle_navigation_visibility('query');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Query
  </a>
</li>

<ul id="query" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/query/index.html" >Query overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/query/query-editor.html" >Query editor</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/query/saved-queries.html" >Saved queries</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/query/query-history.html" >Query history</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/query/query-details.html" >Query details</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/query/clients.html" >Clients</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('catalogs');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Catalogs
  </a>
</li>

<ul id="catalogs" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/s3.html" >Amazon S3</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/redshift.html" >Amazon Redshift</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/adls.html" >Azure Data Lake Storage</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/synapse.html" >Azure Synapse</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/elasticsearch.html" >Elasticsearch</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/gcs.html" >Google Cloud Storage</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/bigquery.html" >Google BiqQuery</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/mongodb.html" >MongoDB</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/mysql.html" >MySQL</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/postgresql.html" >PostgreSQL</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/snowflake.html" >Snowflake</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/sqlserver.html" >SQL Server</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/covid-19.html" >COVID-19 data lake</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/sample.html" >Sample dataset</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/tpch.html" >TPC-H dataset</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalogs/tpcds.html" >TPC-DS dataset</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('catalog-explorer');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Catalog explorer
  </a>
</li>

<ul id="catalog-explorer" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalog-explorer/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalog-explorer/catalogs.html" >Catalogs</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalog-explorer/schemas.html" >Schemas</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/catalog-explorer/tables.html" >Tables</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('clusters');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Clusters
  </a>
</li>

<ul id="clusters" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/clusters/index.html" >Overview</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('sql');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    SQL
  </a>
</li>

<ul id="sql" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sql/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sql/great-lakes.html" >Great Lakes connectivity</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sql/index.html" >SQL lessons now in Tutorials menu</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('admin');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Admin
  </a>
</li>

<ul id="admin" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/admin/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/admin/audit-log.html" >Audit log</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/admin/cluster-config.html" >Cluster configurations</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/admin/cluster-scheduling.html" >Cluster configurations - Cluster scheduling</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/admin/usage-billing.html" >Usage and billing</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('access-control');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Access control
  </a>
</li>

<ul id="access-control" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/access-control/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/access-control/users.html" >Users</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/access-control/roles-privileges.html" >Roles and privileges</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/access-control/groups.html" >Groups</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/access-control/sso-intro.html" >Single sign-on</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/access-control/api-auth-token.html" >API auth token</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('cloud-settings');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Cloud settings
  </a>
</li>

<ul id="cloud-settings" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/cloud-settings/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/cloud-settings/aws.html" >AWS</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/cloud-settings/azure.html" >Azure</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('security');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Security
  </a>
</li>

<ul id="security" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/access-control.html" >Access control</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/roles.html" >Roles</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/entities.html" >Entities</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/privileges.html" >Privileges</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/external-aws.html" >External security in AWS</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/external-azure.html" >External security in Azure</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/ip-allowlist.html" >IP Allowlist</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/security/ssh-tunnels.html" >SSH tunnels</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('sso');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Single sign-on
  </a>
</li>

<ul id="sso" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sso/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sso/okta-saml-setup.html" >Okta SAML setup</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sso/okta-scim-setup.html" >Okta SCIM setup</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sso/azure-saml-setup.html" >Azure SAML setup</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sso/azure-scim-setup.html" >Azure SCIM setup</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sso/google-saml-setup.html" >Google Workspace SAML setup</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/sso/sso-delete.html" >Delete an SSO provider</a>
  </li>
  
  
</ul>



 
  
    
    
<li >
  <a href="/starburst-galaxy/api.html" >API</a>
</li>
  



 





<li  class="active" 
    onclick="toggle_navigation_visibility('tutorials');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Tutorials
  </a>
</li>

<ul id="tutorials" class="doc-subnav ">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/tutorials/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li class="active"
      
    >
    <a href="/starburst-galaxy/tutorials/query-data-lake.html" >Query the COVID-19 data lake</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/tutorials/query-federation.html" >Federate multiple data sources</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/tutorials/learn-basics.html" >Learn SQL basics</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/tutorials/learn-decision-logic.html" >Learn SQL decision logic</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/tutorials/learn-window-functions.html" >Learn SQL window functions</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/tutorials/learn-complex-grouping.html" >Learn complex grouping with SQL</a>
  </li>
  
  
</ul>



 





<li 
    onclick="toggle_navigation_visibility('troubleshooting');">
  <a style="box-sizing: border-box;padding-right: 10px;">
    <i class="fa-solid fa-angle-right nav-icon"></i>&nbsp;
    Troubleshooting
  </a>
</li>

<ul id="troubleshooting" class="doc-subnav hidden">
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/troubleshooting/index.html" >Overview</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/troubleshooting/catalogs.html" >Catalogs</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/troubleshooting/clusters.html" >Clusters</a>
  </li>
  
  
  
    
    
    
  <li 
      
    >
    <a href="/starburst-galaxy/troubleshooting/sql.html" >SQL</a>
  </li>
  
  
</ul>



 
  
    
    
<li >
  <a href="/starburst-galaxy/release-notes.html" >Release notes</a>
</li>
  



 
  
    
    
<li >
  <a href="https://status.galaxy.starburst.io/" >Status</a>
</li>
  




          
        </div>
      </div>
      <div class="col-md-9 col-lg-6 spacer-30 docs-content">
        



<div class="breadcrumbs">
  <p>
  
  
    
      <a href="/starburst-galaxy/"
        style="text-transform: uppercase"
      > starburst galaxy</a> >
    
  
    
      <a href="/starburst-galaxy/tutorials/"
        style="text-transform: uppercase"
      > tutorials</a> >
    
  
    
      Query the COVID-19 data lake
    
  </p>
</div>

        <h1 id="query-the-covid-19-data-lake">
        
        
          Query the COVID-19 data lake <a href="#query-the-covid-19-data-lake" class="titleAnchor">#</a>
        
        
      </h1>
    

<p>One of Starburst Galaxy’s many uses is as an analytics engine on your data
lakehouse or data lake. Once data is landed in S3, GCP, or Azure, you can easily
capitalize on the “separation of storage and compute” principle and use
Starburst Galaxy as the engine behind your data lake analytics.</p>
      <h2 id="tutorial-architecture">
        
        
          Tutorial architecture <a href="#tutorial-architecture" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>For this tutorial, analyze two different datasets from the public
COVID-19 data lake on AWS.</p>
<ul>
  <li>The first dataset is the <a href="https://aws.amazon.com/marketplace/pp/prodview-vtnf3vvvheqzw?sr=0-1&amp;ref_=beagle&amp;applicationId=AWSMPContessa#offers">Global Coronavirus (COVID-19)
Data</a>
provided by Enigma. This dataset tracks COVID case counts.</li>
  <li>The second dataset shares information on <a href="https://aws.amazon.com/marketplace/pp/prodview-yivxd2owkloha?qid=1585241268884&amp;sr=0-8&amp;ref_=srh_res_product_title">US Hospital
Beds</a>,
provided by Rearc. With this hospital information, you are able to see the
capacity and occupancy of hospital beds for each state.</li>
</ul>

<p>This guide walks through:</p>
<ul>
  <li>Connecting Starburst Galaxy to AWS</li>
  <li>Running schema discovery</li>
  <li>Querying the COVID-19 data lake</li>
</ul>
      <h2 id="login-to-starburst-galaxy">
        
        
          Login to Starburst Galaxy <a href="#login-to-starburst-galaxy" class="titleAnchor">#</a>
        
        
      </h2>
    

<ol>
  <li>Navigate to the <a href="https://galaxy.starburst.io/login">Starburst Galaxy login
page</a>.</li>
  <li>If you don’t have an account, <a href="../get-started.html">create a new one</a>
and verify the account with your email.</li>
  <li>Switch to an account admin level role. If this is the first time you have
logged in, or you have never made any additional roles, you are automatically
assigned to the accountadmin role.</li>
</ol>

<p><img src="../../assets/img/galaxy/role-selector.png" alt="Role selector" class="img-fluid img-screenshot" description="" width="px" style="" /></p>
      <h2 id="connect-starburst-galaxy-to-aws">
        
        
          Connect Starburst Galaxy to AWS <a href="#connect-starburst-galaxy-to-aws" class="titleAnchor">#</a>
        
        
      </h2>
    
      <h3 id="create-a-catalog-in-starburst-galaxy">
        
        
          Create a catalog in Starburst Galaxy <a href="#create-a-catalog-in-starburst-galaxy" class="titleAnchor">#</a>
        
        
      </h3>
    

<p>Catalogs contain the configuration and connection information needed to
access a data source. To gain this access, configure a catalog and use it in a
cluster.</p>

<p>This tutorial utilizes the public COVID-19 data lake that lives on AWS, which
simplifies the setup process significantly. Instead of creating an S3 catalog,
where you are required to have access to an AWS account, the data for this
tutorial is accessible without charge and without AWS credentials by connecting
to the AWS <a href="../catalogs/covid-19.html">COVID-19 data lake</a> dataset catalog.</p>

<ol>
  <li>In the navigation menu, click <strong>Catalogs</strong>, then <strong>Configure a Catalog</strong>.</li>
  <li>Scroll down to <strong>Select a dataset</strong>.
    <ul>
      <li>Select <strong>AWS COVID-19 data lake</strong>.</li>
      <li>Enter a relevant catalog name such as <code class="language-plaintext highlighter-rouge">aws_covid</code>.</li>
      <li>Add a relevant description such as <code class="language-plaintext highlighter-rouge">COVID data from AWS public
dataset</code>.</li>
      <li>Add the <code class="language-plaintext highlighter-rouge">US East (Ohio) region</code> to the catalog as this is the only
region where the dataset lives.</li>
      <li>Select <strong>Connect catalog</strong>.</li>
    </ul>
  </li>
</ol>

<p><img src="../../assets/img/galaxy/catalog-covid.png" alt="Image displaying the actions to create a covid-19 catalog" class="img-fluid img-screenshot" description="" width="px" style="" /></p>

<p>Select <strong>Save access controls</strong> on the <strong>Set permissions</strong> page to add
the default access controls.</p>
      <h3 id="create-a-cluster-in-starburst-galaxy">
        
        
          Create a cluster in Starburst Galaxy <a href="#create-a-cluster-in-starburst-galaxy" class="titleAnchor">#</a>
        
        
      </h3>
    

<p>A Starburst Galaxy cluster provides the resources necessary to run queries
against your catalogs. Use the Starburst Galaxy <strong>Cluster explorer</strong> to access
the catalog data exposed by running clusters.</p>

<ol>
  <li>On the Add to cluster page, select <strong>+ Create a new cluster</strong>.</li>
</ol>

<p><img src="../../assets/img/galaxy/cluster-covid.png" alt="Image displaying the actions to create a covid-19 cluster" class="img-fluid img-screenshot" description="" width="px" style="" /></p>

<ul>
  <li>Enter cluster name: <code class="language-plaintext highlighter-rouge">aws-covid-cluster</code>.</li>
  <li>Cluster size: <em>Free</em>.</li>
  <li>Cluster type: <em>Standard</em>.</li>
  <li>Catalogs: <code class="language-plaintext highlighter-rouge">aws_covid</code>.</li>
  <li>Cloud provider region: <em>US East (Ohio)</em> aka <em>us-east-2</em>.
    <ol>
      <li>Select <strong>Create cluster</strong>.</li>
      <li>Select <strong>Add to cluster</strong>.</li>
      <li>Select <strong>Query my data</strong>.</li>
    </ol>
  </li>
</ul>

<p>After configuring the catalog and cluster, you are directed to the query editor
to continue the tutorial. Notice that the location drop-downs in the top right
corner have already selected the proper cluster and catalog for querying.</p>

<p><img src="../../assets/img/galaxy/queryedit-covid-example.png" alt="Image displaying the example query navigation after connecting to   the covid cluster and catalog" class="img-fluid img-screenshot" description="" width="px" style="" /></p>
      <h2 id="run-schema-discovery">
        
        
          Run schema discovery <a href="#run-schema-discovery" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>Schema discovery is the Starburst Galaxy feature that analyzes a root object in
an object storage location, and returns the schema structure of any tables
found. This tutorial uses schema discovery to analyze an individual table in the
COVID-19 data lake and generate the SQL command which upon execution creates the
corresponding table.</p>

<p>Navigate to your newly created catalog within the cluster explorer. Select the
vertical ellipsis menu for the <code class="language-plaintext highlighter-rouge">aws_covid</code> catalog and select <strong>Run
discovery</strong>.</p>

<p><img src="../../assets/img/galaxy/run-schema-discovery.png" alt="Image displaying the run discovery preview" class="img-fluid img-screenshot" description="" width="px" style="" /></p>

<p>Enter the URI to be discovered. Use the Global Coronavirus (COVID-19)
Data provided by Enigma.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s3://covid19-lake/enigma-jhu/json
</code></pre></div></div>

<p>Click <strong>Run Discovery</strong>.</p>

<p><img src="../../assets/img/galaxy/schema-discovery.png" alt="Image displaying the URI input to schema discovery" class="img-fluid img-screenshot" description="" width="px" style="" /></p>

<p>Click <strong>Save SQL</strong> to save the results in a new tab of the query editor. You now
have the schema discovery results which provide the SQL to create the first
table, without spending any time investigating yourself.</p>
      <h2 id="configure-role-based-access-control">
        
        
          Configure role-based access control <a href="#configure-role-based-access-control" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>The Starburst Galaxy access control system uses roles to provide users with
privileges for clusters, catalogs, schemas, tables and other types of entities,
such as object storage locations.</p>

<p>Configure the accountadmin role to access the COVID-19 data lake location. (But
if you have already gone through these steps at the direction of a different
Starburst Galaxy tutorial, there is no need to repeat them.)</p>

<ol>
  <li>In the navigation menu, select <strong>Roles and privileges</strong>.</li>
  <li>Click on the <code class="language-plaintext highlighter-rouge">accountadmin</code> role name.</li>
  <li>Select the <strong>Privileges</strong> tab.</li>
  <li>Select <strong>Add privilege</strong>.</li>
  <li>Add privilege to accountadmin role.
    <ul>
      <li>Choose <strong>location</strong> as the modify privileges destination.</li>
      <li>Add the storage location: <code class="language-plaintext highlighter-rouge">s3://covid19-lake/*</code>.</li>
      <li>Select <strong>Create SQL</strong>.</li>
      <li>Select <strong>Add privilege</strong>.</li>
    </ul>
  </li>
</ol>

<p><img src="../../assets/img/galaxy/role-location-privileges.png" alt="Image displaying the URI input to schema discovery" class="img-fluid img-screenshot" description="" width="px" style="" /></p>

<p>You now have access to all the data sources available in the COVID-19 data lake.</p>
      <h2 id="create-each-table">
        
        
          Create each table <a href="#create-each-table" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>Navigate to the <strong>Query editor</strong>. Validate the location drop-downs in the top
right hand corner match the cluster and catalog previously created.</p>

<p><img src="../../assets/img/galaxy/queryedit-covid-example.png" alt="Image displaying the example query navigation after connecting to   the covid cluster and catalog" class="img-fluid img-screenshot" description="" width="px" style="" /></p>

<p>Create a schema to contain your tables.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">covid_tutorial</span><span class="p">;</span>
</code></pre></div></div>

<p>Now, in the location drop-downs, select the <code class="language-plaintext highlighter-rouge">covid_tutorial</code> schema so that
you can easily run the tutorial queries.</p>
      <h3 id="create-the-enigma_jhu-table">
        
        
          Create the enigma_jhu table <a href="#create-the-enigma_jhu-table" class="titleAnchor">#</a>
        
        
      </h3>
    

<p>The enigma_jhu dataset provides the <em>Global Coronavirus Data</em> and is sourced
from John Hopkins and provided by Enigma. This data tracks confirmed COVID-19
cases in provinces, states, and countries across the world, while also providing
a county level breakdown in the United States.</p>

<p>Edit your saved query to match the following SQL command to create the table.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">enigma_jhu</span> <span class="p">(</span>
   <span class="n">fips</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">admin2</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">province_state</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">country_region</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">last_update</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">latitude</span> <span class="nb">DOUBLE</span><span class="p">,</span>
   <span class="n">longitude</span> <span class="nb">DOUBLE</span><span class="p">,</span>
   <span class="n">confirmed</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">deaths</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">recovered</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">active</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">combined_key</span> <span class="nb">VARCHAR</span>
<span class="p">)</span>
<span class="k">WITH</span> <span class="p">(</span>
   <span class="n">format</span> <span class="o">=</span> <span class="s1">'json'</span><span class="p">,</span>
   <span class="n">EXTERNAL_LOCATION</span> <span class="o">=</span> <span class="s1">'s3://covid19-lake/enigma-jhu/json/'</span><span class="p">)</span>
<span class="p">;</span>
</code></pre></div></div>

<p>Run a select all command to view your results. You can also use the table’s
vertical ellipsis menu to generate the command for you in the query editor.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">enigma_jhu</span> <span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div>

<p>Take notice that the <code class="language-plaintext highlighter-rouge">admin2</code> column is actually the county. However, it has
been improperly named. You can also see that the case information is aggregated
for each previously updated timestamp. We account for this as you query.</p>
      <h3 id="create-the-hospital_beds-table">
        
        
          Create the hospital_beds table <a href="#create-the-hospital_beds-table" class="titleAnchor">#</a>
        
        
      </h3>
    

<p>The second dataset is the <em>USA Hospital Beds</em> data sourced by
Definitive Healthcare and provided by Rearc. This data provides intelligence on
the number of licensed beds, staffed beds, and ICU beds for the hospitals in the
United States.</p>

<p>Run the following SQL command to create the table.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">hospital_beds</span> <span class="p">(</span>
   <span class="n">objectid</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">hospital_name</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">hospital_type</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">hq_address</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">hq_address1</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">hq_city</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">hq_state</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">hq_zip_code</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">county_name</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">state_name</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">state_fips</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">cnty_fips</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">fips</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">num_licensed_beds</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">num_staffed_beds</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">num_icu_beds</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">adult_icu_beds</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">pedi_icu_beds</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">bed_utilization</span> <span class="nb">DOUBLE</span><span class="p">,</span>
   <span class="n">avg_ventilator_usage</span> <span class="nb">VARCHAR</span><span class="p">,</span>
   <span class="n">potential_increase_in_bed_capac</span> <span class="nb">INTEGER</span><span class="p">,</span>
   <span class="n">latitude</span> <span class="nb">DOUBLE</span><span class="p">,</span>
   <span class="n">longtitude</span> <span class="nb">DOUBLE</span>
<span class="p">)</span>
<span class="k">WITH</span> <span class="p">(</span>
   <span class="n">format</span> <span class="o">=</span> <span class="s1">'json'</span><span class="p">,</span>
   <span class="n">EXTERNAL_LOCATION</span> <span class="o">=</span> <span class="s1">'s3://covid19-lake/rearc-usa-hospital-beds/json/'</span><span class="p">)</span>
<span class="p">;</span>
</code></pre></div></div>

<p>Run a select all command to view your results. You can also use the table’s
vertical ellipsis menu to generate the command for you in the query editor.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">hospital_beds</span> <span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div>
      <h2 id="query-each-table">
        
        
          Query each table <a href="#query-each-table" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>Now that the each table has been validated, query those tables for analytical
insights.</p>
      <h3 id="query-the-enigma_jhu-table">
        
        
          Query the enigma_jhu table <a href="#query-the-enigma_jhu-table" class="titleAnchor">#</a>
        
        
      </h3>
    

<p>Now that the table is created, run the query that will filter out rows
that are not within the US and do not have a value for any province or state.
Since the case information is aggregated for each previously updated timestamp,
only select the most recent timestamp on May 30, 2020.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">fips</span><span class="p">,</span>
    <span class="n">admin2</span><span class="p">,</span>
    <span class="n">province_state</span><span class="p">,</span>
    <span class="n">country_region</span><span class="p">,</span>
    <span class="n">confirmed</span>
<span class="k">FROM</span>
    <span class="n">enigma_jhu</span>
<span class="k">WHERE</span>
    <span class="n">country_region</span> <span class="o">=</span> <span class="s1">'US'</span>
    <span class="k">AND</span> <span class="n">province_state</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">''</span>
    <span class="k">AND</span> <span class="n">last_update</span> <span class="o">=</span> <span class="s1">'2020-05-30T02:32:48'</span><span class="p">;</span>
</code></pre></div></div>

<p>Run a query to aggregate the total confirmed cases for each state. Keep in mind
that this dataset includes US territories as well as states.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">province_state</span><span class="p">,</span>
    <span class="n">country_region</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">confirmed</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_confirmed</span>
<span class="k">FROM</span>
    <span class="n">enigma_jhu</span>
<span class="k">WHERE</span>
    <span class="n">country_region</span> <span class="o">=</span> <span class="s1">'US'</span>
    <span class="k">AND</span> <span class="n">province_state</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">''</span>
    <span class="k">AND</span> <span class="n">last_update</span> <span class="o">=</span> <span class="s1">'2020-05-30T02:32:48'</span>
<span class="k">GROUP</span> <span class="k">BY</span>
    <span class="n">province_state</span><span class="p">,</span>
    <span class="n">country_region</span><span class="p">;</span>
</code></pre></div></div>
      <h3 id="query-the-hospital_beds-table">
        
        
          Query the hospital_beds table <a href="#query-the-hospital_beds-table" class="titleAnchor">#</a>
        
        
      </h3>
    

<p>In the original table, there are additional columns that you do not need for
your analysis. Therefore, remove them from your query.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
   <span class="n">hospital_name</span><span class="p">,</span>
   <span class="n">county_name</span><span class="p">,</span>
   <span class="n">state_name</span><span class="p">,</span>
   <span class="n">fips</span><span class="p">,</span>
   <span class="n">num_licensed_beds</span><span class="p">,</span>
   <span class="n">num_staffed_beds</span><span class="p">,</span>
   <span class="n">num_icu_beds</span><span class="p">,</span>
   <span class="n">potential_increase_in_bed_capac</span>
<span class="k">FROM</span>
    <span class="n">hospital_beds</span><span class="p">;</span>
</code></pre></div></div>

<p>Run a query to aggregate the total hospital capacity for each state. Keep in
mind that this dataset includes Puerto Rico and the District of Columbia.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
   <span class="n">state_name</span><span class="p">,</span>
   <span class="k">SUM</span><span class="p">(</span><span class="n">num_licensed_beds</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_licensed_beds</span><span class="p">,</span>
   <span class="k">SUM</span><span class="p">(</span><span class="n">num_staffed_beds</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_staffed_beds</span><span class="p">,</span>
   <span class="k">SUM</span><span class="p">(</span><span class="n">num_icu_beds</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_icu_beds</span>
<span class="k">FROM</span>
    <span class="n">hospital_beds</span>
<span class="k">WHERE</span>
    <span class="n">state_name</span> <span class="o">!=</span> <span class="s1">''</span>
<span class="k">GROUP</span> <span class="k">BY</span>
    <span class="n">state_name</span><span class="p">;</span>
</code></pre></div></div>
      <h2 id="query-the-tables-together">
        
        
          Query the tables together <a href="#query-the-tables-together" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>Evaluate each state’s case count versus the number of licensed
beds during May 30, 2020. You can see for each state if the state is running
close to hospital capacity, or if they are managing with the current number of
infections.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
 <span class="n">cases</span><span class="p">.</span><span class="n">fips</span><span class="p">,</span>
 <span class="n">admin2</span> <span class="k">AS</span> <span class="n">county</span><span class="p">,</span>
 <span class="n">province_state</span><span class="p">,</span>
 <span class="n">confirmed</span><span class="p">,</span>
 <span class="n">growth_count</span><span class="p">,</span>
 <span class="k">SUM</span><span class="p">(</span><span class="n">num_licensed_beds</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num_licensed_beds</span><span class="p">,</span>
 <span class="k">SUM</span><span class="p">(</span><span class="n">num_staffed_beds</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num_staffed_beds</span><span class="p">,</span>
 <span class="k">SUM</span><span class="p">(</span><span class="n">num_icu_beds</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num_icu_beds</span>
<span class="k">FROM</span>
 <span class="n">hospital_beds</span> <span class="n">beds</span><span class="p">,</span>
 <span class="p">(</span> <span class="k">SELECT</span>
     <span class="n">fips</span><span class="p">,</span>
     <span class="n">admin2</span><span class="p">,</span>
     <span class="n">province_state</span><span class="p">,</span>
     <span class="n">confirmed</span><span class="p">,</span>
     <span class="n">last_value</span><span class="p">(</span><span class="n">confirmed</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">fips</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">last_update</span><span class="p">)</span> <span class="o">-</span> <span class="n">first_value</span><span class="p">(</span><span class="n">confirmed</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">fips</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">last_update</span><span class="p">)</span> <span class="k">AS</span> <span class="n">growth_count</span><span class="p">,</span>
     <span class="n">first_value</span><span class="p">(</span><span class="n">last_update</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">fips</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">last_update</span> <span class="k">DESC</span><span class="p">)</span> <span class="k">AS</span> <span class="n">most_recent</span><span class="p">,</span>
     <span class="n">last_update</span>
   <span class="k">FROM</span>
     <span class="n">enigma_jhu</span> <span class="n">cases</span>
   <span class="k">WHERE</span>
     <span class="n">from_iso8601_timestamp</span><span class="p">(</span><span class="n">last_update</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">TIMESTAMP</span> <span class="s1">'2020-05-01 01:00'</span> <span class="k">AND</span> <span class="n">country_region</span> <span class="o">=</span> <span class="s1">'US'</span><span class="p">)</span> <span class="n">cases</span>
<span class="k">WHERE</span>
 <span class="n">beds</span><span class="p">.</span><span class="n">fips</span> <span class="o">=</span> <span class="n">cases</span><span class="p">.</span><span class="n">fips</span> <span class="k">AND</span> <span class="n">last_update</span> <span class="o">=</span> <span class="n">most_recent</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">cases</span><span class="p">.</span><span class="n">fips</span><span class="p">,</span> <span class="n">confirmed</span><span class="p">,</span> <span class="n">growth_count</span><span class="p">,</span> <span class="n">admin2</span><span class="p">,</span> <span class="n">province_state</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">growth_count</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre></div></div>
      <h2 id="next-steps">
        
        
          Next Steps <a href="#next-steps" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>Now that you have explored the data lake analytics capabilities of
Starburst Galaxy, continue exploring with our <a href="./query-federation.html">Query multiple data sources
tutorial</a> or connect your own data.</p>

        <div class="d-lg-none">
          <div class="feedback-container">
  <div class="feedback-thumbs">
    <p>Is the information on this page helpful?</p>
    <div class="thumb-wrapper">
      <p class="feedback-option" title="yes"><i class="fa fa-thumbs-up"></i>Yes</p>
      <p class="feedback-option" title="no"><i class="fa fa-thumbs-down"></i>No</p>
    </div>
  </div>
  <div class="feedback-message">
    <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
    <button type="button" onclick="sendMessage()" class="btn btn-sm btn-primary">Submit</button>
    <a onclick="skip()" class="feedback-skip">Skip</a>
  </div>
</div>

<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

        </div>
      </div>
      <div class="col-lg-3 toc-styles d-none d-lg-block">
        <div class="spacer-60 toc-sticky">
          <ul><li><a href="#query-the-covid-19-data-lake">Query the COVID-19 data lake</a><ul><li><a href="#tutorial-architecture">Tutorial architecture</a></li><li><a href="#login-to-starburst-galaxy">Login to Starburst Galaxy</a></li><li><a href="#connect-starburst-galaxy-to-aws">Connect Starburst Galaxy to AWS</a><ul><li><a href="#create-a-catalog-in-starburst-galaxy">Create a catalog in Starburst Galaxy</a></li><li><a href="#create-a-cluster-in-starburst-galaxy">Create a cluster in Starburst Galaxy</a></li></ul></li><li><a href="#run-schema-discovery">Run schema discovery</a></li><li><a href="#configure-role-based-access-control">Configure role-based access control</a></li><li><a href="#create-each-table">Create each table</a><ul><li><a href="#create-the-enigma_jhu-table">Create the enigma_jhu table</a></li><li><a href="#create-the-hospital_beds-table">Create the hospital_beds table</a></li></ul></li><li><a href="#query-each-table">Query each table</a><ul><li><a href="#query-the-enigma_jhu-table">Query the enigma_jhu table</a></li><li><a href="#query-the-hospital_beds-table">Query the hospital_beds table</a></li></ul></li><li><a href="#query-the-tables-together">Query the tables together</a></li><li><a href="#next-steps">Next Steps</a></li></ul></li></ul>

          <div class="feedback-container">
  <div class="feedback-thumbs">
    <p>Is the information on this page helpful?</p>
    <div class="thumb-wrapper">
      <p class="feedback-option" title="yes"><i class="fa fa-thumbs-up"></i>Yes</p>
      <p class="feedback-option" title="no"><i class="fa fa-thumbs-down"></i>No</p>
    </div>
  </div>
  <div class="feedback-message">
    <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
    <button type="button" onclick="sendMessage()" class="btn btn-sm btn-primary">Submit</button>
    <a onclick="skip()" class="feedback-skip">Skip</a>
  </div>
</div>

<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

          <button type="button" class="btn btn-primary waves-effect waves-light print-button" onclick="window.print()">Print this page</button>
        </div>
      </div>
  </div>
  
</div>
<footer class="page-footer">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <p style="font-weight:900">Resources</b></p>
        <ul>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://trinoforum.org" target="_blank">Trino Forum</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#download" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">
        <a href="https://www.starburst.io/" target="_blank"><img src="/assets/img/logo/starburst-reverse.png" height="60" alt=" Starburst" style="margin-bottom:20px;"></a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2022<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 center spacer-30">
          <a href="https://twitter.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-twitter"></i></a>
          <a href="https://linkedin.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-linkedin"></i></a>
          <a href="https://www.youtube.com/channel/UCXjkuWSO9CV_cSI3Mvo4a4w" target="_blank" class="footer-icon"><i class="fab fa-youtube"></i></a>
          <a href="https://github.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-github"></i></a>
      </div>
    </div>
  </div>
</footer>

  <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/js/popper.min.js"></script>
  <script type="text/javascript" src="/assets/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/assets/js/mdb.min.js"></script>
  <script type="text/javascript" src="/assets/js/custom.js"></script>
  <script type="text/javascript" src="/assets/js/algolia.js"></script>
  <script type="text/javascript" src="/assets/js/search-box.js"></script>
  <script type="text/javascript" src="/assets/js/search-results.js"></script>
</body>
</html>

