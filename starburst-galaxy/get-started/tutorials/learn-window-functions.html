<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Starburst | Learn SQL window functions</title>
    <meta name="viewport" content="width=device-width">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Starburst - Learn SQL window functions">
    <meta property="og:description" content="Your hub to all knowledge about Starburst products.">
    <meta property="og:image" content="/assets/img/starburst-og-image.png">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded">
    <link rel="stylesheet" href="/assets/fontawesome/css/all.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/mdb.min.css">
    <link rel="stylesheet" href="/assets/css/highlight.css">
    <link rel="stylesheet" href="/assets/css/fonts.css">
    <link rel="stylesheet" href="/assets/css/style.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114610397-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-114610397-1');
</script>

<script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://cdn.heapanalytics.com/js/heap-"+e+".js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a);for(var n=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],o=0;o<p.length;o++)heap[p[o]]=n(p[o])};
    heap.load("588835629");
</script>
<script>
  var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights@2.2.1";

  !function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
  (e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
  i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
  }(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Learn SQL window functions | Starburst</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Learn SQL window functions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Your hub to all knowledge about Starburst products." />
<meta property="og:description" content="Your hub to all knowledge about Starburst products." />
<link rel="canonical" href="https://docs.starburst.io/starburst-galaxy/get-started/tutorials/learn-window-functions.html" />
<meta property="og:url" content="https://docs.starburst.io/starburst-galaxy/get-started/tutorials/learn-window-functions.html" />
<meta property="og:site_name" content="Starburst" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Learn SQL window functions" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Your hub to all knowledge about Starburst products.","headline":"Learn SQL window functions","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.starburst.io/assets/img/logo/starburst-reverse.png"}},"url":"https://docs.starburst.io/starburst-galaxy/get-started/tutorials/learn-window-functions.html"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>


<div class="wrap">
  

<header class="main-header navbar-expand-md">
  <div class="navbar fixed-top navbar-dark">
    <div class="container">
      <div class="navbar-left-container">
        <a class="navbar-brand" href="https://www.starburst.io/">
          <img src="/assets/img/logo/starburst_KO-T.png" height="32" alt="Starburst">
        </a>
        <span class="navbar-divider"></span>
        <a href="/" class="header-text">Documentation</a>
      </div>
      
      <div class="nav-item dropdown" id="site-search">
  <div id="dropdownSearchDisplay" aria-labelledby="dropdownSearch">
    <div id="algolia-search">
      <div id="searchbox"></div>
      <div
        class="refinement-list"
        id="versionsRefinementList"
        style="display: none"
      ></div>
      <div class="refinement-list" id="product-list">
        <h6>Product:</h6>
      </div>
      <div id="hits"></div>
      <div id="stats"></div>
    </div>
  </div>
</div>

      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
    <nav class="primary-nav">
      <div class="container collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-layout navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a id="introduction"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Introduction" data-is-click="false"
              href="/introduction/index.html">Introduction</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/introduction/concepts.html">Concepts</a>
              <a class="dropdown-item" href="/introduction/architecture.html">Architecture</a>
              <a class="dropdown-item" href="/introduction/choose-your-starburst-product.html">Choose your Starburst product</a>
              <a class="dropdown-item" href="/introduction/data-sources-catalogs.html">Data sources and catalogs</a>
              <a class="dropdown-item" href="/introduction/data-lake.html">Data lakes</a>
              <a class="dropdown-item" href="/introduction/object-storage.html">Using object storage systems</a>
              <a class="dropdown-item" href="/introduction/metastores.html">Metastore options</a>
              <a class="dropdown-item" href="/introduction/security.html">Security</a>
              <a class="dropdown-item" href="/introduction/querying-data.html">Querying data with Starburst products</a>
              <a class="dropdown-item" href="/introduction/starburst-sql.html">Using SQL</a>
              <a class="dropdown-item" href="/introduction/migration.html">Migrating queries to Starburst</a>
              <a class="dropdown-item" href="/introduction/query-performance.html">Query performance</a>
              <a class="dropdown-item" href="/introduction/performance-features.html">Performance features</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="clients"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Clients" data-is-click="false"
              href="/clients/index.html">Clients</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/clients/index.html">All clients</a>
              <a class="dropdown-item" href="/clients/gather-connection-information.html">Gather connection information</a>
              <a class="dropdown-item" href="/clients/cli.html">Trino CLI</a>
              <a class="dropdown-item" href="/clients/jdbc.html">JDBC driver</a>
              <a class="dropdown-item" href="/clients/odbc.html">ODBC driver</a>
              <a class="dropdown-item" href="/clients/machine-learning.html">Machine learning</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="starburst-galaxy"
               class="nav-link dropdown-toggle active"
              
              aria-haspopup="true" aria-label="Starburst Galaxy" data-is-click="false"
              href="/starburst-galaxy/index.html">Starburst Galaxy</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/starburst-galaxy/get-started/index.html">Get started</a>
              <a class="dropdown-item" href="/starburst-galaxy/global/get-support.html">Help center</a>
              <a class="dropdown-item" href="/starburst-galaxy/working-with-data/index.html">Working with data</a>
              <a class="dropdown-item" href="/starburst-galaxy/working-with-data/query-data/index.html"> Query data</a>
              <a class="dropdown-item" href="/starburst-galaxy/working-with-data/explore-data/index.html"> Explore data</a>
              <a class="dropdown-item" href="/starburst-galaxy/working-with-data/create-catalogs/index.html">Manage catalogs</a>
              <a class="dropdown-item" href="/starburst-galaxy/cluster-administration/index.html">Cluster administration</a>
              <a class="dropdown-item" href="/starburst-galaxy/working-with-data/explore-data/browse-data-products.html">Data products</a>
              <a class="dropdown-item" href="/starburst-galaxy/admin/index.html">Admin</a>
              <a class="dropdown-item" href="/starburst-galaxy/access-control/index.html">Access control</a>
              <a class="dropdown-item" href="/starburst-galaxy/cloud-settings/index.html">Cloud settings</a>
              <a class="dropdown-item" href="/starburst-galaxy/security/index.html">Security</a>
              <a class="dropdown-item" href="/starburst-galaxy/troubleshooting/index.html">Troubleshooting</a>
              <a class="dropdown-item" href="/starburst-galaxy/developer-tools/python/index.html">Python</a>
              <a class="dropdown-item" href="/starburst-galaxy/sql/index.html">SQL</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="starburst-enterprise"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Get started" data-is-click="false"
              href="/starburst-enterprise/index.html">Starburst Enterprise</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/latest/index.html">Latest documentation</a>
              <a class="dropdown-item" href="/latest/try-sep.html">Try Starburst Enterprise</a>
              <a class="dropdown-item" href="/latest/language.html">SQL reference</a>
              <a class="dropdown-item" href="/latest/connector.html">Connect to data sources</a>
              <a class="dropdown-item" href="/latest/admin-topics.html">Administration topics</a>
              <a class="dropdown-item" href="/latest/security.html">Security</a>
              <a class="dropdown-item" href="/latest/versions.html">Version information</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="resources"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="resources" data-is-click="false"
              href="/resources.html">Resources</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/support.html">Support</a>
              <a class="dropdown-item" href="https://www.starburst.io/community/forum/">Community forum</a>
              <a class="dropdown-item" href="https://www.starburst.io/blog/technical">Technical blog</a>
              <a class="dropdown-item" href="/security/index.html">Security</a>
              <a class="dropdown-item" href="https://academy.starburst.io/">Starburst Academy</a>
              <a class="dropdown-item" href="/videos/index.html">Video library</a>
              <a class="dropdown-item" href="/glossary.html">Glossary</a>
              <a class="dropdown-item" href="/conventions.html">Conventions</a>
              <a class="dropdown-item" href="/iconography.html">Iconography</a>
            </div>
          </li>
        </ul>
      </div>
    </nav>
</header>

  
  <div class="container content">
    <div class="row">
      <div class="col-md-3 side-navigation">
        <div class="spacer-60 toc-sticky left-nav">
          
          <div>
    <h6 class="overline product-nav-title">Starburst Galaxy</h6>
</div>
<hr />

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('get-started');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" style="transform: rotate(90deg);">
        </i>&nbsp;Get started</a>
      <ul id="get-started" class="doc-subnav ">
        
  
  
      <li >
        <a href="/starburst-galaxy/get-started/index.html" >Overview</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('learn-galaxy');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Learn Galaxy</a>
      <ul id="learn-galaxy" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/get-started/learn/sign-up.html" >Sign up for Starburst Galaxy</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/learn/galaxy-home-page.html" >Galaxy home page</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/learn/try-your-first-query.html" >Try your first query</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/learn/create-object-storage-catalog.html" >Create an object storage catalog</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/learn/create-rdbms-catalog.html" >Create a relational database catalog</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/learn/tableau-and-galaxy.html" >Use Galaxy with Tableau</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('tutorials');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" style="transform: rotate(90deg);">
        </i>&nbsp;Tutorials</a>
      <ul id="tutorials" class="doc-subnav ">
        
  
  
      <li >
        <a href="/starburst-galaxy/get-started/tutorials/index.html" >Tutorials overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/tutorials/query-data-lake.html" >Query the COVID-19 data lake</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/tutorials/query-federation.html" >Federate multiple data sources</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/tutorials/learn-basics.html" >Learn SQL basics</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/tutorials/learn-decision-logic.html" >Learn SQL decision logic</a>
      </li>
  

  
  
      <li class="active">
        <a href="/starburst-galaxy/get-started/tutorials/learn-window-functions.html" >Learn SQL window functions</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/tutorials/learn-complex-grouping.html" >Learn complex grouping with SQL</a>
      </li>
  


      </ul>
    </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/release-notes.html" >Release notes</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/feature-release-types.html" >Feature release types</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/get-support.html" >Help center</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/get-started/partner-connect.html" >Partner connect</a>
      </li>
  


      </ul>
    </li>
  


<hr />

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('working-with-data');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Working with data</a>
      <ul id="working-with-data" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/index.html" >Overview</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('query-data');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Query data</a>
      <ul id="query-data" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/federating-queries-from-different-sources.html" >Federating queries</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/run-queries.html" >Run queries</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/save-and-reuse-queries.html" >Save and reuse queries</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/query-results.html" >Use query results</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/query-history.html" >Review query history</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/connect-clients.html" >Connect clients</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-data/use-session-properties.html" >Use session properties</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('explore-data');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Explore data</a>
      <ul id="explore-data" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/global-search.html" >Universal search</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/schema-discovery.html" >Discover object storage</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/browse-data-products.html" >Browse data products</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/explore-clusters.html" >Explore clusters</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/catalog-level.html" >Explore catalogs</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/schema-level.html" >Explore schemas</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/explore-data/table-level.html" >Explore tables and views</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('share-data');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Share data</a>
      <ul id="share-data" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/share-data/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/share-data/share-queries.html" >Share queries</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/share-data/create-a-data-product.html" >Create a data product</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/share-data/edit-a-data-product.html" >Edit a data product</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('create-catalogs');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Manage catalogs</a>
      <ul id="create-catalogs" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/index.html" >Overview</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('object-storage');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Object storage</a>
      <ul id="object-storage" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/object-storage/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/object-storage/s3.html" >Amazon S3</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/object-storage/adls.html" >Azure Data Lake</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/object-storage/gcs.html" >Google Cloud Storage</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/object-storage/tabular.html" >Tabular</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('non-object-storage');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Non-object storage</a>
      <ul id="non-object-storage" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/dynamodb.html" >Amazon DynamoDB</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/redshift.html" >Amazon Redshift</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/cassandra.html" >Apache Cassandra</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/druid.html" >Apache Druid</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/pinot.html" >Apache Pinot</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/synapse.html" >Azure Synapse</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/clickhouse.html" >ClickHouse</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/elasticsearch.html" >Elasticsearch</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/galaxy_telemetry.html" >Galaxy Telemetry</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/bigquery.html" >Google BigQuery</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/google-sheets.html" >Google Sheets</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/mariadb.html" >MariaDB</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/sqlserver.html" >Microsoft SQL Server</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/mongodb.html" >MongoDB</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/mysql.html" >MySQL</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/oracle.html" >Oracle</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/postgresql.html" >PostgreSQL</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/salesforce.html" >Salesforce</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/snowflake.html" >Snowflake</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/non-object-storage/stargate.html" >Stargate</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('sample-data-sets');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Sample data sets</a>
      <ul id="sample-data-sets" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/sample-data-sets/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/sample-data-sets/covid-19.html" >COVID-19 data lake</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/sample-data-sets/sample.html" >Sample dataset</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/sample-data-sets/tpcds.html" >TPC-DS dataset</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/sample-data-sets/tpch.html" >TPC-H dataset</a>
      </li>
  


      </ul>
    </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/create-catalogs/manage-catalogs.html" >Manage catalogs</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('query-performance');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Query performance</a>
      <ul id="query-performance" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-performance-and-monitoring/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-performance-and-monitoring/view-query-details.html" >View query details</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-performance-and-monitoring/query-reports.html" >View query reports</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-performance-and-monitoring/understanding-query-planning.html" >Query planning</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-performance-and-monitoring/locate-failed-queries.html" >Locate failed queries</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-performance-and-monitoring/optimize-queries.html" >Optimize queries</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/query-performance-and-monitoring/session-properties-performance.html" >Session properties</a>
      </li>
  


      </ul>
    </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/migrating-queries.html" >Migrating queries</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/working-with-data/sql-reference.html" >SQL reference</a>
      </li>
  


      </ul>
    </li>
  


<hr />

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('developer-tools');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Developer tools</a>
      <ul id="developer-tools" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/developer-tools/python/index.html" >Python</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('api');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;API</a>
      <ul id="api" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/developer-tools/api/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/developer-tools/api/api-auth-token.html" >API authentication tokens</a>
      </li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  


<hr />

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('clusteradministration');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Cluster administration</a>
      <ul id="clusteradministration" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/galaxy-cluster-basics.html" >Galaxy cluster basics</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/create-edit-and-delete-galaxy-clusters.html" >Create and edit clusters</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('cluster-access');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Manage cluster access</a>
      <ul id="cluster-access" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/index.html" >Overview</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('sso-integration');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Manage SSO integration</a>
      <ul id="sso-integration" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/okta-saml-setup.html" >Okta SAML setup</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/okta-scim-setup.html" >Okta SCIM setup</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/azure-saml-setup.html" >Azure SAML setup</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/azure-scim-setup.html" >Azure SCIM setup</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/google-saml-setup.html" >Google Workspace SAML setup</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/generic-idp.html" >Generic IdP setup</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/sso-delete.html" >Delete an SSO provider</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/sso-client-access.html" >SSO client access</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-sso-integration/groups.html" >SSO groups</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('users-roles-tags');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Users, roles, and tags</a>
      <ul id="users-roles-tags" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-users-roles-and-tags/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-users-roles-and-tags/account-and-cluster-privileges-and-entities.html" >Privileges and entities</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-users-roles-and-tags/create-and-use-attribute-tags.html" >Attribute tags</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-users-roles-and-tags/roles.html" >Roles</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-users-roles-and-tags/manage-users-without-sso.html" >Manage users without SSO</a>
      </li>
  


      </ul>
    </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/manage-ui-access.html" >Manage UI access</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/monitor-access-changes.html" >Monitor access changes</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cluster-administration/manage-cluster-access/setup-oauth-clients.html" >Set up OAuth clients</a>
      </li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  


<hr />

  
  
      <li >
        <a href="/starburst-galaxy/sg-nav-section-ui.html" >Starburst Galaxy UI</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('clusters');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Clusters</a>
      <ul id="clusters" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/clusters/cluster-utilization.html" >Cluster utilization</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/clusters/cross-region-support.html" >Cross-region support</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/clusters/fault-tolerant-execution.html" >Fault-tolerant execution</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/clusters/warp-speed.html" >Starburst Warp Speed</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/clusters/query-result-caching.html" >Query result caching</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('admin');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Admin</a>
      <ul id="admin" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/admin/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/admin/cluster-scheduling.html" >Cluster configurations</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/admin/usage-billing.html" >Usage and billing</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/admin/notification-settings.html" >Notification settings</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('access-control');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Access control</a>
      <ul id="access-control" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/access-control/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/access-control/sso-intro.html" >Single sign-on</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/access-control/service-accounts.html" >Service accounts</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/access-control/auto-tag.html" >Automatic classification</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/access-control/row-filters.html" >Row filters</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/access-control/column-masks.html" >Column masks</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('cloud-settings');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Cloud settings</a>
      <ul id="cloud-settings" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/cloud-settings/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cloud-settings/aws.html" >AWS</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cloud-settings/azure.html" >Azure</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/cloud-settings/google-cloud.html" >Google Cloud</a>
      </li>
  


      </ul>
    </li>
  


<hr />

  
  
      <li >
        <a href="/starburst-galaxy/sg-nav-section-admin.html" >Administration</a>
      </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('security');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Security</a>
      <ul id="security" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/security/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/access-control.html" >Access control</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/policies.html" >Policies</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/external-aws.html" >External security in AWS</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/external-azure.html" >External security in Azure</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/ip-allowlist.html" >IP allowlist</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/ssh-tunnels.html" >SSH tunnels</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/ssh-bastion-aws.html" >Example bastion host on AWS</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/security/privatelink.html" >AWS PrivateLink</a>
      </li>
  


      </ul>
    </li>
  


<hr />

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('troubleshooting');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Troubleshooting</a>
      <ul id="troubleshooting" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/troubleshooting/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/troubleshooting/catalogs.html" >Catalogs</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/troubleshooting/clusters.html" >Clusters</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/troubleshooting/query-processing.html" >Query processing</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/troubleshooting/sql.html" >SQL</a>
      </li>
  


      </ul>
    </li>
  


<hr />

  
  
      <li >
        <a href="https://status.galaxy.starburst.io/" >Galaxy status <i class="fa-duotone fa-arrow-up-right-from-square"></i></a>
      </li>
  


<hr />

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('reference');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Reference</a>
      <ul id="reference" class="doc-subnav hidden">
        
  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('sql');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;SQL</a>
      <ul id="sql" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/sql/index.html" >Overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/sql/great-lakes.html" >Great Lakes connectivity</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/sql/gl-iceberg.html" >Iceberg table format</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/sql/gl-deltalake.html" >Delta Lake table format</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/sql/gl-hive.html" >Hive table format</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/sql/gl-hudi.html" >Hudi table format</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/sql/gl-shared-session-properties.html" >Shared session properties</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('expressions');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;Expressions</a>
      <ul id="expressions" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/reference/expressions/data-quality-expressions.html" >Data quality expressions</a>
      </li>
  


      </ul>
    </li>
  

  
  
    <li >
      <a 
        onclick="toggle_navigation_visibility('ui');"
        style="padding-left: 2px;">
        <i class="fa-solid fa-angle-right nav-icon" >
        </i>&nbsp;User interface</a>
      <ul id="ui" class="doc-subnav hidden">
        
  
  
      <li >
        <a href="/starburst-galaxy/reference/ui/index.html" >UI overview</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/reference/ui/notifications.html" >Notifications</a>
      </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/reference/ui/personalize.html" >Profile and settings</a>
      </li>
  


      </ul>
    </li>
  

  
  
      <li >
        <a href="/starburst-galaxy/reference/data-product-markdown.html" >Data product markdown</a>
      </li>
  


      </ul>
    </li>
  



          
        </div>
      </div>
      <div class="col-md-9 col-lg-6 spacer-30 docs-content">
        



<div class="breadcrumbs">
  <p>
  
  
    
      <a href="/starburst-galaxy/"
        style="text-transform: uppercase"
      > starburst galaxy</a> >
    
  
    
      <a href="/starburst-galaxy/get-started/"
        style="text-transform: uppercase"
      > get started</a> >
    
  
    
      <a href="/starburst-galaxy/get-started/tutorials/"
        style="text-transform: uppercase"
      > tutorials</a> >
    
  
    
      Learn SQL window functions
    
  </p>
</div>

        <h1 id="learn-sql-window-functions">
        
        
          Learn SQL window functions <a href="#learn-sql-window-functions" class="titleAnchor">#</a>
        
        
      </h1>
    

<p>Welcome to the <em>Learn SQL window functions</em> tutorial, where you explore useful ways to craft
your SQL statements using the <a href="../../catalogs/sample.html">Sample dataset</a>.
Using <a href="../../sql/ref/functions/window.html">Window functions</a>, you perform
calculations within each SQL statement.</p>
      <h2 id="requirements">
        
        
          Requirements <a href="#requirements" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>To complete the tutorial using Starburst Galaxy, you must <a href="../learn/sign-up.html">create a free trial
or activate your user account</a>.</p>

<p>Once you login to Starburst Galaxy, a cluster named <code class="language-plaintext highlighter-rouge">sample</code> or <code class="language-plaintext highlighter-rouge">free-cluster</code>,
containing a catalog named <code class="language-plaintext highlighter-rouge">sample</code>, is usually pre-configured and ready
for querying.</p>

<ul>
  <li>If you do not see the <code class="language-plaintext highlighter-rouge">sample</code> catalog automatically available, create a
<a href="../../catalogs/sample.html">Sample dataset</a> catalog with the name <code class="language-plaintext highlighter-rouge">sample</code>.</li>
  <li>If you do not see the <code class="language-plaintext highlighter-rouge">free-cluster</code> or <code class="language-plaintext highlighter-rouge">sample</code> cluster automatically
available, create a <a href="../../clusters/index.html">cluster</a> named <code class="language-plaintext highlighter-rouge">sample</code> and
add the <code class="language-plaintext highlighter-rouge">sample</code> catalog.</li>
</ul>
      <h2 id="navigate-the-query-editor">
        
        
          Navigate the query editor <a href="#navigate-the-query-editor" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>In the query editor, navigate to the Cluster explorer.</p>

<ol>
  <li>In the navigation menu, expand the <code class="language-plaintext highlighter-rouge">free-cluster</code> or <code class="language-plaintext highlighter-rouge">sample</code> cluster to view
its catalogs.</li>
  <li>
    <p>Select the <code class="language-plaintext highlighter-rouge">sample</code> catalog.</p>

    <p>  
  <img src="/assets/img/galaxy/queryedit-cluster-explorer-sample.png" alt="Query editor sample cluster explorer" class="img-fluid img-screenshot" description="" width="px" style="" /></p>
  </li>
</ol>

<p>In the <a href="../../query/query-editor.html#location-drop-down-menus">location drop-down
menus</a>, select the
cluster and the catalog <code class="language-plaintext highlighter-rouge">sample</code> in order to run the queries without having to
specify the full table path location in each query.</p>

<p>  
  <img src="/assets/img/galaxy/queryedit-use-sample-catalog-button.png" alt="Query editor use sample catalog button" class="img-fluid img-screenshot" description="" width="px" style="" /></p>

<p>The namespace for a table is typically specified as
<code class="language-plaintext highlighter-rouge">catalog_name.schema_name.table_name</code>. For the predefined sample dataset,
this configuration is as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sample.demo.&lt;table_name&gt;
</code></pre></div></div>

<p>If you choose to name your catalog differently, either adjust the queries in the
tutorials accordingly or select the appropriate catalog in the location
drop-down menus.</p>

<p>If you choose to name your cluster differently, select the appropriate cluster
in the location drop-down menus.</p>
      <h2 id="window-functions">
        
        
          Window functions <a href="#window-functions" class="titleAnchor">#</a>
        
        
      </h2>
    

<p><a href="../../sql/ref/functions/window.html">Window functions</a> perform calculations
across rows of the query result. Invoking a window function requires special
syntax using the <code class="language-plaintext highlighter-rouge">OVER</code> clause to specify the window. Each window function in
this tutorial has two subclauses:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">PARTITION BY</code>: the criteria records must satisfy to belong in the
<a href="../../sql/ref/sql/select.html#window-clause">window frame</a></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ORDER BY</code>: the order of records in the <a href="../../sql/ref/sql/select.html#window-clause">window
frame</a></p>
  </li>
</ul>

<p>First, look at a subset of the missions competed by select astronauts. Compare
their mission hours to the average mission hours for all astronauts.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">,</span>
    <span class="n">hours_mission</span><span class="p">,</span>
    <span class="k">avg</span><span class="p">(</span><span class="n">hours_mission</span><span class="p">)</span> <span class="n">OVER</span><span class="p">()</span>
    <span class="k">AS</span> <span class="n">avg_all_hours_mission</span>
<span class="k">FROM</span>
    <span class="n">sample</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">astronauts</span>
<span class="k">WHERE</span>
    <span class="n">name</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Nicollier, Claude'</span><span class="p">,</span> <span class="s1">'Ross, Jerry L.'</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">;</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">OVER()</code> clause is creating a window of all rows to get the average across
all missions. It is usually unlikely in common SQL practice to create a window
that equates to all rows.</p>

<p>Add the partition to calculate the total mission hours of each astronaut.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">,</span>
    <span class="n">hours_mission</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="n">hours_mission</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">name</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_mission_hours</span>
<span class="k">FROM</span>
    <span class="n">sample</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">astronauts</span>
<span class="k">WHERE</span>
    <span class="n">name</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Nicollier, Claude'</span><span class="p">,</span> <span class="s1">'Ross, Jerry L.'</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">;</span>
</code></pre></div></div>

<p>Add a second window function to evaluate each astronaut’s mission hours against
the average of only their missions.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">,</span>
    <span class="n">hours_mission</span><span class="p">,</span>
    <span class="k">avg</span><span class="p">(</span><span class="n">hours_mission</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">name</span><span class="p">)</span> <span class="k">AS</span> <span class="n">avg_hours_mission</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="n">hours_mission</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">name</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_mission_hours</span>
<span class="k">FROM</span>
    <span class="n">sample</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">astronauts</span>
<span class="k">WHERE</span>
    <span class="n">name</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Nicollier, Claude'</span><span class="p">,</span> <span class="s1">'Ross, Jerry L.'</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">;</span>
</code></pre></div></div>

<p>Determine the percentage of each mission’s hours against each astronaut’s total
mission hours.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">,</span>
    <span class="n">hours_mission</span><span class="p">,</span>
    <span class="n">round</span><span class="p">(</span>
        <span class="n">hours_mission</span> <span class="o">/</span> <span class="k">sum</span><span class="p">(</span><span class="n">hours_mission</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">name</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
    <span class="p">)</span>
    <span class="k">AS</span> <span class="n">percent_of_total</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="n">hours_mission</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">name</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_mission_hours</span>
<span class="k">FROM</span>
    <span class="n">sample</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">astronauts</span>
<span class="k">WHERE</span>
    <span class="n">name</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Nicollier, Claude'</span><span class="p">,</span> <span class="s1">'Ross, Jerry L.'</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">;</span>
</code></pre></div></div>

<p>While the astronauts table already lists the mission number for each astronaut,
calculate this value with a window function ranking the mission years.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">,</span>
    <span class="n">hours_mission</span><span class="p">,</span>
    <span class="n">rank</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span>
        <span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">name</span>
        <span class="k">ORDER</span> <span class="k">BY</span>
            <span class="n">year_of_mission</span>
    <span class="p">)</span> <span class="k">AS</span> <span class="n">mission_number</span>
<span class="k">FROM</span>
    <span class="n">sample</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">astronauts</span>
<span class="k">WHERE</span>
    <span class="n">name</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Nicollier, Claude'</span><span class="p">,</span> <span class="s1">'Ross, Jerry L.'</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">;</span>
</code></pre></div></div>

<p>Calculate the running total number of hours for each astronaut as they complete
each mission. The <a href="../../sql/ref/sql/select.html#window-clause">default window
frame</a> for Starburst Galaxy is
<code class="language-plaintext highlighter-rouge">RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>, which calculates the window
frame as all rows before the current row and up to the current row. This is the
correct window frame for your use case, so no window frame needs to be
explicitly specified in the query.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">,</span>
    <span class="n">hours_mission</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="n">hours_mission</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span>
        <span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">name</span>
        <span class="k">ORDER</span> <span class="k">BY</span>
            <span class="n">year_of_mission</span>
    <span class="p">)</span> <span class="k">AS</span> <span class="n">running_total_mission_hours</span>
<span class="k">FROM</span>
    <span class="n">sample</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">astronauts</span>
<span class="k">WHERE</span>
    <span class="n">name</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'Nicollier, Claude'</span><span class="p">,</span> <span class="s1">'Ross, Jerry L.'</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">year_of_mission</span><span class="p">;</span>
</code></pre></div></div>
      <h2 id="next-steps">
        
        
          Next steps <a href="#next-steps" class="titleAnchor">#</a>
        
        
      </h2>
    

<p>Check out our <a href="./index.html">other tutorials</a>, or dive right into the <a href="../../sql/ref/language.html">SQL
documentation</a> and experiment with your own data.</p>

        <div class="d-lg-none">
          <div class="feedback-container">
  <div class="feedback-thumbs">
    <p>Is the information on this page helpful?</p>
    <div class="thumb-wrapper">
      <p class="feedback-option" title="yes"><i class="fa fa-thumbs-up"></i>Yes</p>
      <p class="feedback-option" title="no"><i class="fa fa-thumbs-down"></i>No</p>
    </div>
  </div>
  <div class="feedback-message">
    <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
    <button type="button" onclick="sendMessage()" class="btn btn-sm btn-primary">Submit</button>
    <a onclick="skip()" class="feedback-skip">Skip</a>
  </div>
</div>

<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

        </div>
      </div>
      <div class="col-lg-3 toc-styles d-none d-lg-block">
        <div class="spacer-60 toc-sticky">
          <ul><li><a href="#learn-sql-window-functions">Learn SQL window functions</a><ul><li><a href="#requirements">Requirements</a></li><li><a href="#navigate-the-query-editor">Navigate the query editor</a></li><li><a href="#window-functions">Window functions</a></li><li><a href="#next-steps">Next steps</a></li></ul></li></ul>

          <div class="feedback-container">
  <div class="feedback-thumbs">
    <p>Is the information on this page helpful?</p>
    <div class="thumb-wrapper">
      <p class="feedback-option" title="yes"><i class="fa fa-thumbs-up"></i>Yes</p>
      <p class="feedback-option" title="no"><i class="fa fa-thumbs-down"></i>No</p>
    </div>
  </div>
  <div class="feedback-message">
    <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
    <button type="button" onclick="sendMessage()" class="btn btn-sm btn-primary">Submit</button>
    <a onclick="skip()" class="feedback-skip">Skip</a>
  </div>
</div>

<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

          <button type="button" class="btn btn-primary waves-effect waves-light print-button" onclick="window.print()">Print this page</button>
        </div>
      </div>
  </div>
  
</div>
<footer class="page-footer">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <p style="font-weight:900">Resources</b></p>
        <ul>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/community/forum/" target="_blank">Starburst forum</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#download" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">
        <a href="https://www.starburst.io/" target="_blank"><img src="/assets/img/logo/starburst-reverse.png" height="60" alt=" Starburst" style="margin-bottom:20px;"></a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2023<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 center spacer-30">
          <a href="https://twitter.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-twitter"></i></a>
          <a href="https://linkedin.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-linkedin"></i></a>
          <a href="https://www.youtube.com/channel/UCXjkuWSO9CV_cSI3Mvo4a4w" target="_blank" class="footer-icon"><i class="fab fa-youtube"></i></a>
          <a href="https://github.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-github"></i></a>
      </div>
    </div>
  </div>
</footer>

  <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/js/popper.min.js"></script>
  <script type="text/javascript" src="/assets/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/assets/js/mdb.min.js"></script>
  <script type="text/javascript" src="/assets/js/custom.js"></script>
  <script type="text/javascript" src="/assets/js/algolia.js"></script>
  <script type="text/javascript" src="/assets/js/search-box.js"></script>
  <script type="text/javascript" src="/assets/js/search-results.js"></script>
</body>
</html>

