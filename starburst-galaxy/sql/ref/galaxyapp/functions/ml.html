

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Machine learning functions &#8212; Starburst Galaxy SQL reference</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/algolia.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <link rel="stylesheet" type="text/css" href="../_static/search.css" />
    <link rel="stylesheet" type="text/css" href="../_static/galaxyapp.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/galaxyapp.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Map functions and operators" href="map.html" />
    <link rel="prev" title="Logical operators" href="logical.html" />

  
   



<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">




<!-- Always link to the latest version, as canonical -->
<link rel="canonical" href="https://docs.starburst.io/latest/functions/ml.html">

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#functions/ml" tabindex="1" class="md-skip"> Skip to content </a>
  


<header class="md-header galaxyapp-header" data-md-component="header">
  <div class="md-content__inner">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--stretch md-typeset">
        <div class="homepage-title">
          <i class="md-icon">help</i>
          <h6>SQL documentation</h6>
        </div>
      </div>
      <div id="docs--closebutton" class="md-flex__cell closebutton" title="Close">
        <i class="md-icon">close</i>
      </div>
    </div>
    <div class="navbuttons__container md-typeset">
      <div class="navbuttons">
        <a href="../index.html" title="Home">
          <i class="md-icon">home</i>
        </a>
        <button data-nav="back" data-md-component="reset" onClick="goBack();" title="Go back">
          <i class="md-icon">arrow_back_ios_new</i>
        </button>
        <button data-nav="forward" data-md-component="reset" onClick="goForward();" title="Go forward">
          <i class="md-icon">arrow_forward_ios_new</i>
        </button>
      </div>
    </div>
  </div>
</header>



  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../functions.html" class="md-tabs__link">Functions and operators</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Galaxy SQL reference" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Galaxy SQL reference">Starburst Galaxy SQL reference</a>
  </label>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="functions-ml--page-root">Machine learning functions<a class="headerlink" href="#functions-ml--page-root" title="Permalink to this heading">#</a></h1>
<p>The machine learning plugin provides machine learning functionality
as an aggregation function. It enables you to train Support Vector Machine (SVM)
based classifiers and regressors for the supervised learning problems.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The machine learning functions are not optimized for distributed processing.
The capability to train large data sets is limited by this execution of the
final training on a single instance.</p>
</div>

<h2 id="feature-vector">Feature vector<a class="headerlink" href="#feature-vector" title="Permalink to this heading">#</a></h2>
<p>To solve a problem with the machine learning technique, especially as a
supervised learning problem, it is necessary to represent the data set
with the sequence of pairs of labels and feature vector. A label is a
target value you want to predict from the unseen feature and a feature is a
A N-dimensional vector whose elements are numerical values. In Trino, a
feature vector is represented as a map-type value, whose key is an index
of each feature, so that it can express a sparse vector.
Since classifiers and regressors can recognize the map-type feature
vector, there is a function to construct the feature from the existing
numerical values, <a class="reference internal" href="#features" title="features"><code class="xref py py-func docutils literal notranslate"><span class="pre">features()</span></code></a>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">features</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">AS</span> <span class="n">features</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>       features
-----------------------
 {0=1.0, 1=2.0, 2=3.0}
</pre></div>
</div>
<p>The output from <a class="reference internal" href="#features" title="features"><code class="xref py py-func docutils literal notranslate"><span class="pre">features()</span></code></a> can be directly passed to ML functions.</p>


<h2 id="classification">Classification<a class="headerlink" href="#classification" title="Permalink to this heading">#</a></h2>
<p>Classification is a type of supervised learning problem to predict the distinct
label from the given feature vector. The interface looks similar to the
construction of the SVM model from the sequence of pairs of labels and features
implemented in Teradata Aster or <a class="reference external" href="https://cloud.google.com/bigquery-ml/docs/bigqueryml-intro" rel="noopener noreferrer" target="_blank">BigQuery ML</a>.
The function to train a classification model looks like as follows:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">learn_classifier</span><span class="p">(</span>
    <span class="n">species</span><span class="p">,</span>
    <span class="n">features</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">)</span>
  <span class="p">)</span> <span class="k">AS</span> <span class="n">model</span>
<span class="k">FROM</span>
  <span class="n">iris</span>
</pre></div>
</div>
<p>It returns the trained model in a serialized format.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                      model
-------------------------------------------------
 3c 43 6c 61 73 73 69 66 69 65 72 28 76 61 72 63
 68 61 72 29 3e
</pre></div>
</div>
<p><a class="reference internal" href="#classify" title="classify"><code class="xref py py-func docutils literal notranslate"><span class="pre">classify()</span></code></a> returns the predicted label by using the trained model.
The trained model can not be saved natively, and needs to be passed in
the format of a nested query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">classify</span><span class="p">(</span><span class="n">features</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">),</span> <span class="n">model</span><span class="p">)</span> <span class="k">AS</span> <span class="n">predicted_label</span>
<span class="k">FROM</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="n">learn_classifier</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">features</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">))</span> <span class="k">AS</span> <span class="n">model</span>
  <span class="k">FROM</span>
    <span class="n">iris</span>
<span class="p">)</span> <span class="n">t</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> predicted_label
-----------------
 Iris-virginica
</pre></div>
</div>
<p>As a result you need to run the training process at the same time when predicting values.
Internally, the model is trained by <a class="reference external" href="https://www.csie.ntu.edu.tw/~cjlin/libsvm/" rel="noopener noreferrer" target="_blank">libsvm</a>.
You can use <a class="reference internal" href="#learn_libsvm_classifier" title="learn_libsvm_classifier"><code class="xref py py-func docutils literal notranslate"><span class="pre">learn_libsvm_classifier()</span></code></a> to control the internal parameters of the model.</p>


<h2 id="regression">Regression<a class="headerlink" href="#regression" title="Permalink to this heading">#</a></h2>
<p>Regression is another type of supervised learning problem, predicting continuous
value, unlike the classification problem. The target must be numerical values that can
be described as <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p>
<p>The following code shows the creation of the model predicting <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code>
from the other 3 features:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">learn_regressor</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">features</span><span class="p">(</span><span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">))</span> <span class="k">AS</span> <span class="n">model</span>
<span class="k">FROM</span>
  <span class="n">iris</span>
</pre></div>
</div>
<p>The way to use the model is similar to the classification case:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">regress</span><span class="p">(</span><span class="n">features</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">),</span> <span class="n">model</span><span class="p">)</span> <span class="k">AS</span> <span class="n">predicted_target</span>
<span class="k">FROM</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="n">learn_regressor</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">features</span><span class="p">(</span><span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">))</span> <span class="k">AS</span> <span class="n">model</span>
  <span class="k">FROM</span> <span class="n">iris</span>
<span class="p">)</span> <span class="n">t</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> predicted_target
-------------------
 6.407376822560477
</pre></div>
</div>
<p>Internally, the model is trained by <a class="reference external" href="https://www.csie.ntu.edu.tw/~cjlin/libsvm/" rel="noopener noreferrer" target="_blank">libsvm</a>.
<a class="reference internal" href="#learn_libsvm_regressor" title="learn_libsvm_regressor"><code class="xref py py-func docutils literal notranslate"><span class="pre">learn_libsvm_regressor()</span></code></a> provides you a way to control the training process.</p>


<h2 id="id1">Machine learning functions<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="features">
<code class="sig-name descname"><span class="pre">features</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">double</span></span></em>, <em><span class="n"><span class="pre">...)</span> <span class="pre">-&gt;</span> <span class="pre">map(bigint</span></span></em>, <em><span class="n"><span class="pre">double</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#features" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the map representing the feature vector.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="learn_classifier">
<code class="sig-name descname"><span class="pre">learn_classifier</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">label</span></span></em>, <em><span class="n"><span class="pre">features</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Classifier</span></span></span><a class="headerlink" href="#learn_classifier" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based classifier model, trained with the given label and feature data sets.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="learn_libsvm_classifier">
<code class="sig-name descname"><span class="pre">learn_libsvm_classifier</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">label</span></span></em>, <em><span class="n"><span class="pre">features</span></span></em>, <em><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Classifier</span></span></span><a class="headerlink" href="#learn_libsvm_classifier" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based classifier model, trained with the given label and feature data sets.
You can control the training process by libsvm parameters.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="classify">
<code class="sig-name descname"><span class="pre">classify</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">features</span></span></em>, <em><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">label</span></span></span><a class="headerlink" href="#classify" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a label predicted by the given classifier SVM model.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="learn_regressor">
<code class="sig-name descname"><span class="pre">learn_regressor</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">target</span></span></em>, <em><span class="n"><span class="pre">features</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Regressor</span></span></span><a class="headerlink" href="#learn_regressor" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based regressor model, trained with the given target and feature data sets.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="learn_libsvm_regressor">
<code class="sig-name descname"><span class="pre">learn_libsvm_regressor</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">target</span></span></em>, <em><span class="n"><span class="pre">features</span></span></em>, <em><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Regressor</span></span></span><a class="headerlink" href="#learn_libsvm_regressor" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based regressor model, trained with the given target and feature data sets.
You can control the training process by libsvm parameters.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="regress">
<code class="sig-name descname"><span class="pre">regress</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">features</span></span></em>, <em><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">target</span></span></span><a class="headerlink" href="#regress" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a predicted target value by the given regressor SVM model.</p>
</dd></dl>




          </article>
        </div>
      </div>
    </main>
  </div>


  </body>
</html>