

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11.27. Machine Learning Functions &mdash; Starburst Enterprise Presto</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Enterprise Presto" href="../index.html"/>
        <link rel="up" title="11. Functions and Operators" href="../functions.html"/>
        <link rel="next" title="11.28. List of Functions and Operators" href="list.html"/>
        <link rel="prev" title="11.26. Oracle Functions" href="oracle.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Enterprise Presto
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">3. Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">4. Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../k8s.html">5. Kubernetes with Helm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">6. Kubernetes operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">7. Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">8. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">9. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">10. Connectors</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../functions.html">11. Functions and Operators</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="logical.html">11.1. Logical Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="comparison.html">11.2. Comparison Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="conditional.html">11.3. Conditional Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="lambda.html">11.4. Lambda Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="conversion.html">11.5. Conversion Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="math.html">11.6. Mathematical Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="bitwise.html">11.7. Bitwise Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="decimal.html">11.8. Decimal Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="string.html">11.9. String Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="regexp.html">11.10. Regular Expression Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="binary.html">11.11. Binary Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html">11.12. JSON Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="datetime.html">11.13. Date and Time Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="aggregate.html">11.14. Aggregate Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="window.html">11.15. Window Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="array.html">11.16. Array Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="map.html">11.17. Map Functions and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="url.html">11.18. URL Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="geospatial.html">11.19. Geospatial Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyperloglog.html">11.20. HyperLogLog Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="qdigest.html">11.21. Quantile Digest Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="uuid.html">11.22. UUID Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="color.html">11.23. Color Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="session.html">11.24. Session Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="teradata.html">11.25. Teradata Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="oracle.html">11.26. Oracle Functions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11.27. Machine Learning Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#feature-vector">Feature Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#classification">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#regression">Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Machine Learning Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="list.html">11.28. List of Functions and Operators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">12. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">13. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">14. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">15. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">16. Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">17. Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../404.html">404 - Nothing to See Here</a></li>
</ul>

            
          

        </div>
        <div style="margin-top: 1em; margin-left: 2em;">
          Version <a href="../versions.html">338-e LTS and others</a>
          <br><br>
        <span>
  <select name="versions" id="versions" onChange="window.location.href=this.value">
    <option value="./">Choose another version</option>
    <option value="/356-e/">Latest LTS (356-e)</option>
    <option value="/350-e/">350-e LTS</option>
    <option value="/345-e/">345-e LTS</option>
    <option value="/338-e/">338-e LTS</option>
    <option value="/358-e/">Latest STS (358-e)</option>
    <option value="/357-e/">357-e STS</option>
  </select>
</span>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://www.starburstdata.com/">
          <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px;"
          src="../_static/img/starburst-darkbg.png"/></a>
        <span class="optional">
          <a href="../index.html">Starburst Enterprise Presto</a>
          <a href="../versions.html" style="font-size: small;margin-left: 0.5em;">338-e LTS and others</a>
          <a href="https://www.starburstdata.com/oreilly-presto-guide-download/?utm_campaign=O%27Reilly%20Presto%20Book&utm_source=starburst&utm_medium=docs">
            <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px; margin-left: 0.5em;"
          src="../_static/img/ptdg-banner.png"/></a>
          </span>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../functions.html"><span class="section-number">11. </span>Functions and Operators</a> &raquo;</li>
      
    <li><span class="section-number">11.27. </span>Machine Learning Functions</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="machine-learning-functions">
<h1><span class="section-number">11.27. </span>Machine Learning Functions<a class="headerlink" href="#machine-learning-functions" title="Permalink to this headline">#</a></h1>
<p>The machine learning plugin provides machine learning functionality
as an aggregation function. It enables you to train Support Vector Machine (SVM)
based classifiers and regressors for the supervised learning problems.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#feature-vector" id="id3">Feature Vector</a></p></li>
<li><p><a class="reference internal" href="#classification" id="id4">Classification</a></p></li>
<li><p><a class="reference internal" href="#regression" id="id5">Regression</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id6">Machine Learning Functions</a></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The machine learning functions are not optimized for distributed processing.
The capability to train large data sets is limited by this execution of the
final training on a single instance.</p>
</div>
<div class="section" id="feature-vector">
<h2>Feature Vector<a class="headerlink" href="#feature-vector" title="Permalink to this headline">#</a></h2>
<p>To solve a problem with the machine learning technique, especially as a
supervised learning problem, it is necessary to represent the data set
with the sequence of pairs of labels and feature vector. A label is a
target value you want to predict from the unseen feature and a feature is a
A N-dimensional vector whose elements are numerical values. In Presto, a
feature vector is represented as a map-type value, whose key is an index
of each feature, so that it can express a sparse vector.
Since classifiers and regressors can recognize the map-type feature
vector, there is a function to construct the feature from the existing
numerical values, <a class="reference internal" href="#features" title="features"><code class="xref py py-func docutils literal notranslate"><span class="pre">features()</span></code></a>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">features</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">AS</span> <span class="n">features</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>       features
-----------------------
 {0=1.0, 1=2.0, 2=3.0}
</pre></div>
</div>
<p>The output from <a class="reference internal" href="#features" title="features"><code class="xref py py-func docutils literal notranslate"><span class="pre">features()</span></code></a> can be directly passed to ML functions.</p>
</div>
<div class="section" id="classification">
<h2>Classification<a class="headerlink" href="#classification" title="Permalink to this headline">#</a></h2>
<p>Classification is a type of supervised learning problem to predict the distinct
label from the given feature vector. The interface looks similar to the
construction of the SVM model from the sequence of pairs of labels and features
implemented in Teradata Aster or <a class="reference external" href="https://cloud.google.com/bigquery-ml/docs/bigqueryml-intro">BigQuery ML</a>.
The function to train a classification model looks like as follows:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">learn_classifier</span><span class="p">(</span>
    <span class="n">species</span><span class="p">,</span>
    <span class="n">features</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">)</span>
  <span class="p">)</span> <span class="k">AS</span> <span class="n">model</span>
<span class="k">FROM</span>
  <span class="n">iris</span>
</pre></div>
</div>
<p>It returns the trained model in a serialized format.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                      model
-------------------------------------------------
 3c 43 6c 61 73 73 69 66 69 65 72 28 76 61 72 63
 68 61 72 29 3e
</pre></div>
</div>
<p><a class="reference internal" href="#classify" title="classify"><code class="xref py py-func docutils literal notranslate"><span class="pre">classify()</span></code></a> returns the predicted label by using the trained model.
The trained model can not be saved natively, and needs to be passed in
the format of a nested query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">classify</span><span class="p">(</span><span class="n">features</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">),</span> <span class="n">model</span><span class="p">)</span> <span class="k">AS</span> <span class="n">predicted_label</span>
<span class="k">FROM</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="n">learn_classifier</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">features</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">))</span> <span class="k">AS</span> <span class="n">model</span>
  <span class="k">FROM</span>
    <span class="n">iris</span>
<span class="p">)</span> <span class="n">t</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> predicted_label
-----------------
 Iris-virginica
</pre></div>
</div>
<p>As a result you need to run the training process at the same time when predicting values.
Internally, the model is trained by <a class="reference external" href="https://www.csie.ntu.edu.tw/~cjlin/libsvm/">libsvm</a>.
You can use <a class="reference internal" href="#learn_libsvm_classifier" title="learn_libsvm_classifier"><code class="xref py py-func docutils literal notranslate"><span class="pre">learn_libsvm_classifier()</span></code></a> to control the internal parameters of the model.</p>
</div>
<div class="section" id="regression">
<h2>Regression<a class="headerlink" href="#regression" title="Permalink to this headline">#</a></h2>
<p>Regression is another type of supervised learning problem, predicting continuous
value, unlike the classification problem. The target must be numerical values that can
be described as <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p>
<p>The following code shows the creation of the model predicting <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code>
from the other 3 features:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">learn_regressor</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">features</span><span class="p">(</span><span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">))</span> <span class="k">AS</span> <span class="n">model</span>
<span class="k">FROM</span>
  <span class="n">iris</span>
</pre></div>
</div>
<p>The way to use the model is similar to the classification case:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
  <span class="n">regress</span><span class="p">(</span><span class="n">features</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="p">),</span> <span class="n">model</span><span class="p">)</span> <span class="k">AS</span> <span class="n">predicted_target</span>
<span class="k">FROM</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="n">learn_regressor</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">,</span> <span class="n">features</span><span class="p">(</span><span class="n">sepal_width</span><span class="p">,</span> <span class="n">petal_length</span><span class="p">,</span> <span class="n">petal_width</span><span class="p">))</span> <span class="k">AS</span> <span class="n">model</span>
  <span class="k">FROM</span> <span class="n">iris</span>
<span class="p">)</span> <span class="n">t</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> predicted_target
-------------------
 6.407376822560477
</pre></div>
</div>
<p>Internally, the model is trained by <a class="reference external" href="https://www.csie.ntu.edu.tw/~cjlin/libsvm/">libsvm</a>.
<a class="reference internal" href="#learn_libsvm_regressor" title="learn_libsvm_regressor"><code class="xref py py-func docutils literal notranslate"><span class="pre">learn_libsvm_regressor()</span></code></a> provides you a way to control the training process.</p>
</div>
<div class="section" id="id2">
<h2>Machine Learning Functions<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<dl class="function">
<dt id="features">
<code class="sig-name descname">features</code><span class="sig-paren">(</span><em class="sig-param">double</em>, <em class="sig-param">...) -&gt; map(bigint</em>, <em class="sig-param">double</em><span class="sig-paren">)</span><a class="headerlink" href="#features" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the map representing the feature vector.</p>
</dd></dl>

<dl class="function">
<dt id="learn_classifier">
<code class="sig-name descname">learn_classifier</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">features</em><span class="sig-paren">)</span> &#x2192; Classifier<a class="headerlink" href="#learn_classifier" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based classifier model, trained with the given label and feature data sets.</p>
</dd></dl>

<dl class="function">
<dt id="learn_libsvm_classifier">
<code class="sig-name descname">learn_libsvm_classifier</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">features</em>, <em class="sig-param">params</em><span class="sig-paren">)</span> &#x2192; Classifier<a class="headerlink" href="#learn_libsvm_classifier" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based classifier model, trained with the given label and feature data sets.
You can control the training process by libsvm parameters.</p>
</dd></dl>

<dl class="function">
<dt id="classify">
<code class="sig-name descname">classify</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">model</em><span class="sig-paren">)</span> &#x2192; label<a class="headerlink" href="#classify" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a label predicted by the given classifier SVM model.</p>
</dd></dl>

<dl class="function">
<dt id="learn_regressor">
<code class="sig-name descname">learn_regressor</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">features</em><span class="sig-paren">)</span> &#x2192; Regressor<a class="headerlink" href="#learn_regressor" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based regressor model, trained with the given target and feature data sets.</p>
</dd></dl>

<dl class="function">
<dt id="learn_libsvm_regressor">
<code class="sig-name descname">learn_libsvm_regressor</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">features</em>, <em class="sig-param">params</em><span class="sig-paren">)</span> &#x2192; Regressor<a class="headerlink" href="#learn_libsvm_regressor" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an SVM-based regressor model, trained with the given target and feature data sets.
You can control the training process by libsvm parameters.</p>
</dd></dl>

<dl class="function">
<dt id="regress">
<code class="sig-name descname">regress</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">model</em><span class="sig-paren">)</span> &#x2192; target<a class="headerlink" href="#regress" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a predicted target value by the given regressor SVM model.</p>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="list.html" style="box-shadow: none; border: none;" class="btn btn-neutral float-right" title="11.28. List of Functions and Operators" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="oracle.html" style="box-shadow: none; border: none;" class="btn btn-neutral" title="11.26. Oracle Functions" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'338',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>