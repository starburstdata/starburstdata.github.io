

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.1. Overview &mdash; Starburst Enterprise Presto</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Enterprise Presto" href="../index.html"/>
        <link rel="up" title="6. Kubernetes operator" href="../kubernetes.html"/>
        <link rel="next" title="6.2. Prerequisites" href="prerequisites.html"/>
        <link rel="prev" title="6. Kubernetes operator" href="../kubernetes.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Enterprise Presto
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">3. Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">4. Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../k8s.html">5. Kubernetes with Helm</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../kubernetes.html">6. Kubernetes operator</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.1. Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#docker-container-images">Docker container images</a></li>
<li class="toctree-l3"><a class="reference internal" href="#helm-charts">Helm charts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-on-k8s">Deploying on K8s</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customize">Customize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#presto-cloud-architecture">Presto Cloud Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#labels">Labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="prerequisites.html">6.2. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html">6.3. Deployment of Presto on Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="presto_resource.html">6.4. Presto Kubernetes Resource</a></li>
<li class="toctree-l2"><a class="reference internal" href="query.html">6.5. Querying Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="customizing_presto_image.html">6.6. Customizing Presto Docker Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpa.html">6.7. Horizontal Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="secrets.html">6.8. Secrets</a></li>
<li class="toctree-l2"><a class="reference internal" href="ranger.html">6.9. Ranger</a></li>
<li class="toctree-l2"><a class="reference internal" href="eks.html">6.10. Using Amazon Elastic Kubernetes Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="gcp-marketplace.html">6.11. GCP Marketplace</a></li>
<li class="toctree-l2"><a class="reference internal" href="gke.html">6.12. Using Google Kubernetes Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="azure-marketplace.html">6.13. Azure Marketplace</a></li>
<li class="toctree-l2"><a class="reference internal" href="aks.html">6.14. Using Microsoft Azure Kubernetes Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="openshift.html">6.15. Using Red Hat OpenShift</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html">6.16. Kubernetes Resources Release Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">7. Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">8. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">9. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">10. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">11. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">12. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">13. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">14. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">15. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">16. Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">17. Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../404.html">404 - Nothing to See Here</a></li>
</ul>

            
          

        </div>
        <div style="margin-top: 1em; margin-left: 2em;">
          Version <a href="../versions.html">338-e LTS and others</a>
          <br><br>
        <span>
  <select name="versions" id="versions" onChange="window.location.href=this.value">
    <option value="./">Choose another version</option>
    <option value="/356-e/">Latest LTS (356-e)</option>
    <option value="/350-e/">350-e LTS</option>
    <option value="/345-e/">345-e LTS</option>
    <option value="/338-e/">338-e LTS</option>
    <option value="/355-e/">Latest STS (355-e)</option>
    <option value="/354-e/">354-e STS</option>
  </select>
</span>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://www.starburstdata.com/">
          <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px;"
          src="../_static/img/starburst-darkbg.png"/></a>
        <span class="optional">
          <a href="../index.html">Starburst Enterprise Presto</a>
          <a href="../versions.html" style="font-size: small;margin-left: 0.5em;">338-e LTS and others</a>
          <a href="https://www.starburstdata.com/oreilly-presto-guide-download/?utm_campaign=O%27Reilly%20Presto%20Book&utm_source=starburst&utm_medium=docs">
            <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px; margin-left: 0.5em;"
          src="../_static/img/ptdg-banner.png"/></a>
          </span>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../kubernetes.html"><span class="section-number">6. </span>Kubernetes operator</a> &raquo;</li>
      
    <li><span class="section-number">6.1. </span>Overview</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="overview">
<h1><span class="section-number">6.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://kubernetes.io/">Kubernetes (k8s)</a> provides a very powerful and
flexible deployment and runtime system for Starburst Enterprise Presto.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Kubernetes and the ecosystem of tools, patterns and conventions around k8s is
complex. This documentation assumes some familiarity. Use the many available
resources, <a class="reference external" href="https://kubernetes.io/docs/tutorials/">such as the tutorial</a> to
learn more.</p>
</div>
<p>Ensure that you can fulfill the <a class="reference internal" href="prerequisites.html"><span class="doc">prerequisites</span></a> before
proceeding to deploy Presto on k8s.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#docker-container-images" id="id3">Docker container images</a></p></li>
<li><p><a class="reference internal" href="#helm-charts" id="id4">Helm charts</a></p></li>
<li><p><a class="reference internal" href="#deploying-on-k8s" id="id5">Deploying on K8s</a></p></li>
<li><p><a class="reference internal" href="#customize" id="id6">Customize</a></p></li>
<li><p><a class="reference internal" href="#presto-cloud-architecture" id="id7">Presto Cloud Architecture</a></p></li>
<li><p><a class="reference internal" href="#labels" id="id8">Labels</a></p></li>
<li><p><a class="reference internal" href="#license" id="id9">License</a></p></li>
</ul>
</div>
<div class="section" id="docker-container-images">
<span id="container-images"></span><h2><a class="toc-backref" href="#id3">Docker container images</a><a class="headerlink" href="#docker-container-images" title="Permalink to this headline">#</a></h2>
<p>The Kubernetes offering uses a number of Docker containers, all available on
DockerHub.</p>
<p><a class="reference external" href="https://hub.docker.com/r/starburstdata/presto">Presto</a>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker pull starburstdata/presto:338-e.5-k8s-0.50
</pre></div>
</div>
<p><a class="reference external" href="https://hub.docker.com/r/starburstdata/presto-operator">Presto operator</a>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker pull starburstdata/presto-operator:338-e.5-k8s-0.50
</pre></div>
</div>
<p><a class="reference external" href="https://hub.docker.com/r/starburstdata/hive-metastore">Apache Hive Metastore</a>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker pull starburstdata/hive-metastore:k8s-0.7
</pre></div>
</div>
</div>
<div class="section" id="helm-charts">
<span id="id1"></span><h2><a class="toc-backref" href="#id4">Helm charts</a><a class="headerlink" href="#helm-charts" title="Permalink to this headline">#</a></h2>
<p>Helm charts are used for the Apache Ranger installation, which includes the SEP
Ranger plugin, and are only available from the <a class="reference internal" href="../installation/download.html"><span class="doc">Starburst Helm chart
repository</span></a>.</p>
</div>
<div class="section" id="deploying-on-k8s">
<span id="k8s-deploy"></span><h2><a class="toc-backref" href="#id5">Deploying on K8s</a><a class="headerlink" href="#deploying-on-k8s" title="Permalink to this headline">#</a></h2>
<p>With access to your cluster and the public internet, you can <a class="reference internal" href="deployment.html"><span class="doc">proceed to
deploy</span></a> using kubectl and the resources provided by Starburst.
The relevant files are located in DockerHub and on Starburst storage systems.</p>
<p>Further platform specific tips are available:</p>
<ul class="simple">
<li><p><a class="reference internal" href="eks.html"><span class="doc">Amazon Elastic Kubernetes Service</span></a></p></li>
<li><p><a class="reference internal" href="gke.html"><span class="doc">Google Kubernetes Engine</span></a></p></li>
<li><p><a class="reference internal" href="aks.html"><span class="doc">Microsoft Azure Kubernetes Service</span></a></p></li>
<li><p><a class="reference internal" href="openshift.html"><span class="doc">Red Hat OpenShift</span></a></p></li>
</ul>
</div>
<div class="section" id="customize">
<h2><a class="toc-backref" href="#id6">Customize</a><a class="headerlink" href="#customize" title="Permalink to this headline">#</a></h2>
<p>The Kubernetes integration allows adding a user-defined bootstrap script
to the pods. This <a class="reference internal" href="customizing_presto_image.html#k8s-custom-bootstrap"><span class="std std-ref">additional bootstrap script</span></a> is
executed on the coordinator and worker nodes upon node startup.</p>
<p>If the additional bootstrap script mechanism is insufficient, you can further
<a class="reference internal" href="customizing_presto_image.html#k8s-custom-image"><span class="std std-ref">customize the Docker images</span></a>. This allows you to to
extend Presto with additional features, which are not supported by default.</p>
</div>
<div class="section" id="presto-cloud-architecture">
<h2><a class="toc-backref" href="#id7">Presto Cloud Architecture</a><a class="headerlink" href="#presto-cloud-architecture" title="Permalink to this headline">#</a></h2>
<p>SEP on Kubernetes consists of various components and Kubernetes resources that
form a Presto Kubernetes cluster. The following terms describe each component of
the Presto Kubernetes architecture in more detail:</p>
<p><strong>Presto Kubernetes Custom Resource Definition</strong></p>
<p>Presto Kubernetes Custom Resource Definition (CRD) defines resources of Presto
type within a Kubernetes namespace. More information on Kubernetes custom
resources is <a class="reference external" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/#custom-resources">available in the documentation</a>.</p>
<p><strong>Presto Kubernetes Resources</strong></p>
<p>Presto Kubernetes resources are instances of Presto Kubernetes custom resource.
Each instance of a <a class="reference internal" href="presto_resource.html"><span class="doc">Presto Kubernetes resource</span></a>
represents a cluster and contains various configurable parameters that specify
Presto, connector and Kubernetes properties.</p>
<p><strong>Presto Operator</strong></p>
<p>The Presto operator is a <a class="reference external" href="https://coreos.com/operators/">Kubernetes operator</a>
pod that orchestrates Presto clusters. The operator continuously monitors the
Kubernetes resources. It creates or removes clusters when Presto Kubernetes
resources are created or removed. Any changes to existing the resource are
picked up by the operator to update the corresponding cluster accordingly.</p>
<p><strong>Presto Service Account</strong></p>
<p>The account used by the Presto operator to make Kubernetes API calls.</p>
<p><strong>Presto Service Role</strong></p>
<p>The role that is bound to Presto service account. The role must have enough
privileges to manage clusters.</p>
<p><strong>Presto Coordinator</strong></p>
<p>A Kubernetes pod that runs the coordinator of the cluster. Each cluster uses at
most a single coordinator. The pod is automatically recreated on coordinator
failure or unresponsiveness, thus providing high availability.</p>
<p><strong>Presto Worker</strong></p>
<p>Presto pods that run workers. The number of workers can be adjusted statically
by <a class="reference internal" href="presto_resource.html"><span class="doc">specifying the worker.count property</span></a> or
automatically with the Kubernetes <a class="reference external" href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">Horizontal Pod Autoscaler</a>.</p>
<p><strong>Presto Coordinator Service</strong></p>
<p>A Kubernetes <a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/service/">Service</a> that
delegates requests to the coordinator. Presto Coordinator Service is the
frontend of the cluster which accepts queries and exposes the web UI.</p>
<p><strong>Presto Network Policy</strong></p>
<p>The Presto <a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">Network Policy</a>
only allows inbound traffic to the workers from the coordinator. Support for
Kubernetes Network Policies needs to be enabled in your Kubernetes cluster.</p>
<p><strong>Metastore</strong></p>
<p>A Hive Metastore pod that is running when the cluster is configured to use an
internal Metastore.</p>
<p><strong>PostgreSQL</strong></p>
<p>A PostgreSQL pod that is running when Presto cluster is configured to use an
internal Metastore with an internal ephemeral Metastore database.</p>
</div>
<div class="section" id="labels">
<span id="id2"></span><h2><a class="toc-backref" href="#id8">Labels</a><a class="headerlink" href="#labels" title="Permalink to this headline">#</a></h2>
<p>All Presto Kubernetes components are labelled so that it’s easy to write
selectors in order to match them:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">instance:</span> <span class="pre">CLUSTER_NAME_UUID</span></code> – <code class="code docutils literal notranslate"><span class="pre">CLUSTER_NAME_UUID</span></code> is the
cluster name with a unique suffix. <code class="code docutils literal notranslate"><span class="pre">CLUSTER_NAME_UUID</span></code> can be overridden
via the <code class="code docutils literal notranslate"><span class="pre">nameOverride</span></code> <a class="reference internal" href="presto_resource.html"><span class="doc">Presto Kubernetes Resource</span></a> property.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">role:</span> <span class="pre">ROLE_NAME</span></code> – <code class="code docutils literal notranslate"><span class="pre">ROLE_NAME</span></code> can be one of:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">catalogs</span></code> – specifies catalogs <em>ConfigMap</em></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">configuration</span></code> – specifies configuration <em>ConfigMap</em></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">coordinator</span></code> – specifies Presto Coordinator related components</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">worker</span></code> – specifies Presto Worker related components</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive-metastore</span></code> – specifies Hive Metastore related components</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hive-postgresql</span></code> – specifies PostgreSQL (for Hive Metastore)
related components</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">prometheus-coordinator</span></code> – specifies Prometheus metrics endpoint for
the coordinator</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">prometheus-worker</span></code> – specifies Prometheus metrics endpoint for the
workers</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="license">
<h2><a class="toc-backref" href="#id9">License</a><a class="headerlink" href="#license" title="Permalink to this headline">#</a></h2>
<p>The following features require a <a class="reference internal" href="../installation/license-requirements.html"><span class="doc">valid license</span></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Graceful worker scale-down</p></li>
<li><p>Autoscaling</p></li>
<li><p>Presto pods with more than 8 cores</p></li>
<li><p>Presto pods with more than 64GB of RAM</p></li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="prerequisites.html" style="box-shadow: none; border: none;" class="btn btn-neutral float-right" title="6.2. Prerequisites" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../kubernetes.html" style="box-shadow: none; border: none;" class="btn btn-neutral" title="6. Kubernetes operator" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'338',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>