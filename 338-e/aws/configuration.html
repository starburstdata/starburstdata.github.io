

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.5. Configuring Presto &mdash; Starburst Enterprise Presto</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Enterprise Presto" href="../index.html"/>
        <link rel="up" title="5. Amazon Web Services" href="../aws.html"/>
        <link rel="next" title="5.6. Configuring Hive Metastore" href="metastore.html"/>
        <link rel="prev" title="5.4. Deploying Presto" href="deploy.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Enterprise Presto
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">3. Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mission-control.html">4. Mission Control</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../aws.html">5. Amazon Web Services</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">5.1. Getting Started on AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html">5.2. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="prerequisites.html">5.3. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html">5.4. Deploying Presto</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.5. Configuring Presto</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#default-configuration">Default Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-configuration">Custom Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-configuration-package">Creating a Configuration Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uploading-a-configuration-package-to-s3">Uploading a Configuration Package to S3</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-a-configuration-package">Using a Configuration Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-configuration-package">Example Configuration Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-a-configuration-package">Updating a Configuration Package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#interactions-between-default-and-advanced-configurations">Interactions Between Default and Advanced Configurations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="metastore.html">5.6. Configuring Hive Metastore</a></li>
<li class="toctree-l2"><a class="reference internal" href="access.html">5.7. Accessing the Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="query.html">5.8. Querying Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3.html">5.9. Querying AWS S3</a></li>
<li class="toctree-l2"><a class="reference internal" href="glue.html">5.10. AWS Glue Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="superset.html">5.11. Using Apache Superset</a></li>
<li class="toctree-l2"><a class="reference internal" href="manualscale.html">5.12. Manual Scaling a Running Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoscale.html">5.13. Auto Scaling a Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="high-availability.html">5.14. Coordinator High Availability</a></li>
<li class="toctree-l2"><a class="reference internal" href="secrets.html">5.15. Secrets</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">5.16. Integration with CloudWatch Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">5.17. Integration with CloudWatch Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">5.18. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="uninstall.html">5.19. Uninstalling Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="release-notes.html">5.20. AWS AMI/CFT Release Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">6. Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">7. Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">8. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">9. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">10. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">11. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">12. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">13. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">14. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">15. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">16. Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">17. Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../404.html">404 - Nothing to See Here</a></li>
</ul>

            
          

        </div>
        <div style="margin-top: 1em; margin-left: 2em;">
          Version <a href="../versions.html">338-e.0 LTS and others</a>
          <br><br>
        <span>
  <select name="versions" id="versions" onChange="window.location.href=this.value">
    <option value="./">Choose another version</option>
    <option value="/338-e/">Latest LTS (338-e)</option>
    <option value="/337-e/">Latest STS (337-e)</option>
    <option value="/336-e/">336-e STS</option>
    <option value="/334-e/">334-e STS</option>
    <option value="/332-e/">332-e LTS</option>
    <option value="/323-e/">323-e LTS</option>
  </select>
</span>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://www.starburstdata.com/">
          <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px;"
          src="../_static/img/starburst-darkbg.png"/></a>
        <span class="optional">
          <a href="../index.html">Starburst Enterprise Presto</a>
          <a href="../versions.html" style="font-size: small;margin-left: 0.5em;">338-e.0 LTS and others</a>
          <a href="https://www.starburstdata.com/oreilly-presto-guide-download/?utm_campaign=O%27Reilly%20Presto%20Book&utm_source=starburst&utm_medium=docs">
            <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px; margin-left: 0.5em;"
          src="../_static/img/ptdg-banner.png"/></a>
          </span>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../aws.html">5. Amazon Web Services</a> &raquo;</li>
      
    <li>5.5. Configuring Presto</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuring-presto">
<h1>5.5. Configuring Presto<a class="headerlink" href="#configuring-presto" title="Permalink to this headline">#</a></h1>
<p>Presto has an extensive set of configuration switches that allow it to be tuned
for certain specific requirements. Default values are chosen for the best “out
of the box” experience. However, if you need to fine-tune Presto behavior, you
can do so when using Starburst’s CloudFormation template.</p>
<div class="section" id="default-configuration">
<span id="aws-default-configuration"></span><h2>Default Configuration<a class="headerlink" href="#default-configuration" title="Permalink to this headline">#</a></h2>
<p>The following configuration changes are applied automatically for you:</p>
<ul class="simple">
<li>Java heap maximum memory (-Xmx) is set appropriately for the selected EC2
instance type</li>
<li>JVM’s JIT caches are set to 512 MiB</li>
<li>Java is configured to use G1 garbage collector, this is the recommended
garbage collector to use when running Presto</li>
<li>If Hive Metastore is configured (refer to <a class="reference internal" href="metastore.html"><span class="doc">Configuring Hive Metastore</span></a>), the
<code class="docutils literal"><span class="pre">hive</span></code> catalog is configured with connector configuration left at
<a class="reference internal" href="../connector/starburst-hive.html"><span class="doc">default values</span></a>.</li>
<li>A <a class="reference internal" href="../security/audit.html"><span class="doc">query audit</span></a> event listener is configured in
<code class="docutils literal"><span class="pre">etc/event-listener-audit-log.properties</span></code>. If you have configured
<a class="reference internal" href="../develop/event-listener.html"><span class="doc">another event listener</span></a>, add the property
<code class="docutils literal"><span class="pre">event-listener.config-files</span></code> in <a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">the config properties file</span></a>, and ensure both files are in the list comma-separated
list.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All configuration is stored in the <code class="docutils literal"><span class="pre">etc</span></code> directory in the Presto
installation directory. The directory is mounted using a RAM disk - so files
are stored in memory only. The files are generated by the CFT configuration
scripts.  No secrets in any files, such as usernames or passwords in catalog
files, are actually stored on disk at any time and they files can not be
access from outside the running EC2 instances.</p>
</div>
</div>
<div class="section" id="custom-configuration">
<span id="id1"></span><h2>Custom Configuration<a class="headerlink" href="#custom-configuration" title="Permalink to this headline">#</a></h2>
<p>When using Starburst’s CloudFormation template, you can expand on the default
configuration by providing your own configuration packages for the coordinator,
workers or both. These configuration packages are used to append or override the
default Presto configuration. In addition they can be used to provide the
configuration for additional catalogs.</p>
<p>The CloudFormation template provides the
<code class="docutils literal"><span class="pre">AdditionalCoordinatorConfigurationURI</span></code> and
<code class="docutils literal"><span class="pre">AdditionalWorkersConfigurationURI</span></code> parameters used to specify the locations
of the configuration packages for the coordinator and workers respectively. See
the following sections for how to create, upload, and use configuration
packages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All configuration changes made to your Presto cluster should be performed via
the CloudFormation Template. If you manually change the configurations on the
instances running Presto, the changes are not guaranteed to be persisted. If
you manually edit the configuration the first time while you set up and
configure Presto, you should create a configuration package from it so you can
reuse and persist the configuration.</p>
</div>
<div class="section" id="creating-a-configuration-package">
<h3>Creating a Configuration Package<a class="headerlink" href="#creating-a-configuration-package" title="Permalink to this headline">#</a></h3>
<p>A configuration package is a ZIP file with the structure shown below. All files
are optional except for top-level <code class="docutils literal"><span class="pre">etc/</span></code> directory entry.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>etc/
  config.properties
  jvm.config
  catalog/
    hive.properties
    &lt;catalog-name&gt;.properties
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is important to use this exact directory structure. It is not adequate to
simply zip up a directory structure from another Presto installation to use
unless that directory structure follows this same template.</p>
</div>
<p><strong>etc/config.properties</strong></p>
<p>This file is optional. Refer to <a class="reference internal" href="../admin/properties.html"><span class="doc">the properties reference
documentation</span></a> for details.</p>
<p><strong>etc/jvm.config</strong></p>
<p>This file is optional. Refer to <a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html">Oracle’s</a>
documentation of options that can be set here. Refer to <a class="reference internal" href="../admin/tuning.html"><span class="doc">Tuning
Presto</span></a> for information about JVM options that are often
useful when troubleshooting performance issues.</p>
<p>Certain options, including <code class="docutils literal"><span class="pre">-Xmx</span></code> and garbage collection algorithm selection
are set by default.</p>
<p><strong>etc/catalog/hive.properties</strong></p>
<p>This file is optional. If the configuration package contains this file and the
Hive Metastore is not configured (refer to <a class="reference internal" href="metastore.html"><span class="doc">Configuring Hive Metastore</span></a>) when launching
Starburst’s CloudFormation template, then the file must contain the following:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">connector.name</span><span class="o">=</span><span class="s">hive-hadoop2</span>
<span class="na">hive.metastore.uri</span><span class="o">=</span><span class="s">thrift://example.net:9083</span>
</pre></div>
</div>
<p>If the <code class="docutils literal"><span class="pre">MetastoreType</span></code> parameter is set to something other than <code class="docutils literal"><span class="pre">None</span></code>, then
the <code class="docutils literal"><span class="pre">hive.properties</span></code> file was already created and it is not needed to provide
the above. However, you can still provide a <code class="docutils literal"><span class="pre">hive.properties</span></code> file that
include properties you wish to append to the configuration. Refer to the
<a class="reference internal" href="../connector/starburst-hive.html"><span class="doc">Hive connector</span></a> and <a class="reference internal" href="../connector/hive-security.html"><span class="doc">Hive security</span></a> documentation of options that can be set here.
Also refer to <a class="reference internal" href="#aux-files-aws"><span class="std std-ref">Auxiliary Files</span></a> for instructions on how to
configure properties that refer to additional files.</p>
<p><strong>etc/catalog/&lt;catalog-name&gt;.properties</strong></p>
<p>This file is optional. When such a file is placed in the configuration package,
a catalog <code class="docutils literal"><span class="pre">&lt;catalog-name&gt;</span></code> is created. The file must contain the
following:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">connector.name</span><span class="o">=</span><span class="s">&lt;connector-name&gt;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal"><span class="pre">&lt;connector-name&gt;</span></code> is the name of the connector, refer to the
<a class="reference internal" href="../connector.html"><span class="doc">connector documentation</span></a> documentation for a list of
supported connectors and their documentation. If the chosen connector has some
mandatory configuration parameters, they must be set in the
<code class="docutils literal"><span class="pre">&lt;catalog-name&gt;.properties</span></code> file. There can be more than one such file in the
<code class="docutils literal"><span class="pre">etc/catalog/</span></code> folder of the configuration package. This allows you to define
multiple catalogs.</p>
<p>Refer to <a class="reference internal" href="#aux-files-aws"><span class="std std-ref">Auxiliary Files</span></a> for instructions on how to
configure properties that refer to additional files.</p>
<p id="aux-files-aws"><strong>Auxiliary Files</strong></p>
<p>If a configuration property in any of the configuration files accepts a path to
an additional file (e.g., Hive’s <code class="docutils literal"><span class="pre">security.config-file</span></code>), add the file in the
configuration package and refer to it using a path that is <em>relative</em>, starting
with the configuration package top-level directory.</p>
<p>For example, if you are configuring Hive connector to use
<code class="docutils literal"><span class="pre">hive.security=file</span></code>, you also need to set <code class="docutils literal"><span class="pre">security.config-file</span></code> (see
<a class="reference internal" href="../connector/hive-security.html"><span class="doc">Hive Security</span></a> documentation for the meaning
and structure of the file). To do so, add <code class="docutils literal"><span class="pre">etc/catalog/hive-security.json</span></code> in
the configuration package and refer to <code class="docutils literal"><span class="pre">etc/catalog/hive-security.json</span></code> using
a relative path:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>...
hive.security=file
security.config-file=etc/catalog/hive-security.json
</pre></div>
</div>
</div>
<div class="section" id="uploading-a-configuration-package-to-s3">
<h3>Uploading a Configuration Package to S3<a class="headerlink" href="#uploading-a-configuration-package-to-s3" title="Permalink to this headline">#</a></h3>
<p>For a configuration package ZIP to be used when launching  Starburst’s
CloudFormation template, it must be uploaded to S3 first to a location of your
choice. If the configuration package contains sensitive information (passwords,
AWS access keys or Kerberos keytab files, etc.), make sure to use an S3 location
that is not publicly accessible.</p>
</div>
<div class="section" id="using-a-configuration-package">
<h3>Using a Configuration Package<a class="headerlink" href="#using-a-configuration-package" title="Permalink to this headline">#</a></h3>
<p>When launching Starburst’s CloudFormation template, you can use the
<code class="docutils literal"><span class="pre">AdditionalCoordinatorConfigurationURI</span></code> and
<code class="docutils literal"><span class="pre">AdditionalWorkersConfigurationURI</span></code> parameters to refer to the configuration
package that should be applied on top of default configuration done by the
template. The URI should be of the form
<code class="docutils literal"><span class="pre">s3://my_bucket/path/to/configuration/package.zip</span></code>. You may decide to use a
single configuration package for use by both the Presto Coordinator and Workers
or use different packages for each. Additionally, you may provide a
configuration package only for the coordinator or worker.</p>
<p>If you upload to a location that is not publicly accessible, you need to use <code class="docutils literal"><span class="pre">IamInstanceProfile</span></code> parameter when launching the cluster, and the selected Instance Profile must allow read access to the selected S3 location.</p>
</div>
<div class="section" id="example-configuration-package">
<h3>Example Configuration Package<a class="headerlink" href="#example-configuration-package" title="Permalink to this headline">#</a></h3>
<p>You can download an example configuration package from Starburst <a class="reference external" href="https://s3.us-east-2.amazonaws.com/starburstdata/aws-marketplace/examples/cft/cloudformation-template-configuration/0.1/hive-allow-drop-table.zip">here</a>.
To use it when launching Starburst’s CloudFormation template, use its S3-native
address:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>s3://starburstdata/aws-marketplace/examples/cft/cloudformation-template-configuration/0.1/hive-allow-drop-table.zip
</pre></div>
</div>
</div>
<div class="section" id="updating-a-configuration-package">
<h3>Updating a Configuration Package<a class="headerlink" href="#updating-a-configuration-package" title="Permalink to this headline">#</a></h3>
<p>Instead of deleting a CloudFormation stack and creating a new one, you can use
the AWS <a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html">stack update</a>
feature to update the Presto configuration package. You first need to create a
new configuration package with the changes you need, and then upload it to S3 as
described in the previous sections. Then when updating the CloudFormation stack,
you enter the new S3 location as values to the
<code class="docutils literal"><span class="pre">AdditionalCoordinatorConfigurationURI</span></code> and
<code class="docutils literal"><span class="pre">AdditionalWorkersConfigurationURI</span></code> parameters. When CloudFormation is
applying the updates, it updates the stack by using the new configuration
package to configure Presto.</p>
<p>AWS CloudFormation does not update the CloudFormation stack if the values to the
parameters have not changed. Therefore you should create a new configuration
package zip file with a different name. We recommend including a version name
within the file name to avoid any complications when updating your
configurations.</p>
<p>For example, if the original configuration package was located at:
<code class="docutils literal"><span class="pre">s3://my_bucket/path/to/configuration/package-1.0.zip</span></code>, then you want to
create a new configuration package with location such as:
<code class="docutils literal"><span class="pre">s3://my_bucket/path/to/configuration/package-2.0.zip</span></code>. Even if you changed
the contents of <code class="docutils literal"><span class="pre">s3://my_bucket/path/to/configuration/package-1.0.zip</span></code> and
keep the name, CloudFormation is not able to update the configuration.</p>
<p>The advanced configuration zip file name must be changed in order to update it
successfully. We recommend including a version name within the file name to
avoid any complications when updating your configurations.</p>
</div>
</div>
<div class="section" id="interactions-between-default-and-advanced-configurations">
<h2>Interactions Between Default and Advanced Configurations<a class="headerlink" href="#interactions-between-default-and-advanced-configurations" title="Permalink to this headline">#</a></h2>
<p>It is important to note that the “out of the box” default values are overridden
only for the keys where an advanced configuration entry exits. If no advanced
configuration is entered, the default value remains. However, in the case of
<code class="docutils literal"><span class="pre">jvm.config</span></code> , additional configuration entries are appended to the default
configuration.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="metastore.html" style="box-shadow: none; border: none;" class="btn btn-neutral float-right" title="5.6. Configuring Hive Metastore" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="deploy.html" style="box-shadow: none; border: none;" class="btn btn-neutral" title="5.4. Deploying Presto" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'338-SNAPSHOT',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>