

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.10. AWS Glue Support &mdash; Starburst Enterprise Presto</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Enterprise Presto" href="../index.html"/>
        <link rel="up" title="4. Amazon Web Services" href="../aws.html"/>
        <link rel="next" title="4.11. Using Apache Superset" href="superset.html"/>
        <link rel="prev" title="4.9. Querying AWS S3" href="s3.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Enterprise Presto
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">3. Clients</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../aws.html">4. Amazon Web Services</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">4.1. Getting Started on AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html">4.2. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="prerequisites.html">4.3. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html">4.4. Deploying Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">4.5. Configuring Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="metastore.html">4.6. Configuring Hive Metastore</a></li>
<li class="toctree-l2"><a class="reference internal" href="access.html">4.7. Accessing the Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="query.html">4.8. Querying Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3.html">4.9. Querying AWS S3</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.10. AWS Glue Support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aws-glue-with-sep-ami">AWS Glue with SEP AMI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aws-glue-with-cloudformation-template">AWS Glue with CloudFormation Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sep-with-aws-glue-usage">SEP with AWS Glue Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#table-and-column-statistics-support">Table and Column Statistics Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="#known-limitations-of-aws-glue-support">Known Limitations of AWS Glue Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="superset.html">4.11. Using Apache Superset</a></li>
<li class="toctree-l2"><a class="reference internal" href="manualscale.html">4.12. Manual Scaling a Running Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoscale.html">4.13. Auto Scaling a Presto Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="high-availability.html">4.14. Coordinator High Availability</a></li>
<li class="toctree-l2"><a class="reference internal" href="secrets.html">4.15. Secrets</a></li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">4.16. Integration with CloudWatch Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">4.17. Integration with CloudWatch Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">4.18. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="uninstall.html">4.19. Uninstalling Presto</a></li>
<li class="toctree-l2"><a class="reference internal" href="release-notes.html">4.20. AWS AMI/CFT Release Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../k8s.html">5. Kubernetes with Helm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">6. Kubernetes operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">7. Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">8. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">9. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">10. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">11. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">12. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">13. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">14. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">15. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">16. Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">17. Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../404.html">404 - Nothing to See Here</a></li>
</ul>

            
          

        </div>
        <div style="margin-top: 1em; margin-left: 2em;">
          Version <a href="../versions.html">338-e LTS and others</a>
          <br><br>
        <span>
  <select name="versions" id="versions" onChange="window.location.href=this.value">
    <option value="./">Choose another version</option>
    <option value="/350-e/">Latest LTS (350-e)</option>
    <option value="/345-e/">345-e LTS</option>
    <option value="/338-e/">338-e LTS</option>
    <option value="/354-e/">Latest STS (354-e)</option>
    <option value="/348-e/">348-e STS</option>
  </select>
</span>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://www.starburstdata.com/">
          <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px;"
          src="../_static/img/starburst-darkbg.png"/></a>
        <span class="optional">
          <a href="../index.html">Starburst Enterprise Presto</a>
          <a href="../versions.html" style="font-size: small;margin-left: 0.5em;">338-e LTS and others</a>
          <a href="https://www.starburstdata.com/oreilly-presto-guide-download/?utm_campaign=O%27Reilly%20Presto%20Book&utm_source=starburst&utm_medium=docs">
            <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px; margin-left: 0.5em;"
          src="../_static/img/ptdg-banner.png"/></a>
          </span>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../aws.html"><span class="section-number">4. </span>Amazon Web Services</a> &raquo;</li>
      
    <li><span class="section-number">4.10. </span>AWS Glue Support</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aws-glue-support">
<h1><span class="section-number">4.10. </span>AWS Glue Support<a class="headerlink" href="#aws-glue-support" title="Permalink to this headline">#</a></h1>
<p>AWS Glue is a supported metadata catalog for Presto. It is intended to be used
as a alternative to the Hive Metastore with the Presto Hive plugin to work with
your S3 data.</p>
<div class="section" id="aws-glue-with-sep-ami">
<h2>AWS Glue with SEP AMI<a class="headerlink" href="#aws-glue-with-sep-ami" title="Permalink to this headline">#</a></h2>
<p>When you deploy a SEP AMI from the AWS Marketplace, you need to configure the
Hive connector to use Glue. The minimal setup is to do the following on all
Presto nodes:</p>
<p>1. create a <code class="docutils literal notranslate"><span class="pre">/etc/presto/catalogs/glue.properties</span></code> file with at least the
contents below:</p>
<blockquote>
<div><div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">connector.name</span><span class="o">=</span><span class="s">hive-hadoop2</span>
<span class="na">hive.metastore</span><span class="o">=</span><span class="s">glue</span>
</pre></div>
</div>
</div></blockquote>
<p>You should add all other Hive connector specific properties for your use case.
See <a class="reference internal" href="../connector/starburst-hive.html"><span class="doc">Starburst Hive Connector</span></a> and
<a class="reference internal" href="../connector/starburst-hive-security.html"><span class="doc">Starburst Hive Connector Security</span></a> for more details.</p>
<ol class="arabic simple" start="2">
<li><p>restart Presto with:</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo service presto restart
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="aws-glue-with-cloudformation-template">
<h2>AWS Glue with CloudFormation Template<a class="headerlink" href="#aws-glue-with-cloudformation-template" title="Permalink to this headline">#</a></h2>
<p>When using the CloudFormation template in AWS, you can leverage Glue
by simply choosing <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">Glue</span> <span class="pre">Data</span> <span class="pre">Catalog</span></code> in <code class="docutils literal notranslate"><span class="pre">MetastoreType</span></code> field of the
stack creation form (<code class="docutils literal notranslate"><span class="pre">Presto</span> <span class="pre">Configuration</span></code> section)</p>
</div>
<div class="section" id="sep-with-aws-glue-usage">
<h2>SEP with AWS Glue Usage<a class="headerlink" href="#sep-with-aws-glue-usage" title="Permalink to this headline">#</a></h2>
<p>When configured as above, the Glue catalog is available via the <code class="docutils literal notranslate"><span class="pre">hive</span></code> catalog
from within Presto CLI or any other Presto connection. As usual remember to
specify the location of the data on S3. Either for the entire schema or on the
table level. For example to create a schema <code class="docutils literal notranslate"><span class="pre">foo</span></code> in Glue, with the S3 base
directory (root folder for per table subdirectories) pointing to the root of
<code class="docutils literal notranslate"><span class="pre">my-bucket</span></code> S3 bucket, you would write:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">hive</span><span class="p">.</span><span class="n">foo</span>
<span class="k">WITH</span> <span class="p">(</span><span class="k">location</span> <span class="o">=</span> <span class="s1">&#39;s3://my-bucket/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also create and edit the schema and tables directly from AWS Glue. In
AWS Glue terminology the schema is called “database”.</p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">#</a></h2>
<p>Both the AMI and CloudFormation approach mentioned above require the Presto
instances to have permissions to access both S3 and Glue AWS services.</p>
<p><strong>When using SEP via our CloudFormation template by default you do not need to
provide anything, the template creates all necessary resources automatically.</strong></p>
<p>If you need to provide your own IAM Instance Profile for the Presto instances
(<code class="docutils literal notranslate"><span class="pre">IamInstanceProfile</span></code> field in the Stack creation form) consult the
<a class="reference internal" href="prerequisites.html#aws-security-prereq-nodes"><span class="std std-ref">IAM Role Permissions for Presto Cluster Nodes</span></a> section. Same applies when launching the AMI
manually, make sure you choose an IAM Role that satisfies the requirements.</p>
</div>
<div class="section" id="table-and-column-statistics-support">
<h2>Table and Column Statistics Support<a class="headerlink" href="#table-and-column-statistics-support" title="Permalink to this headline">#</a></h2>
<p>With <code class="docutils literal notranslate"><span class="pre">hive.metastore.glue.column-statistics-enabled</span></code> set to <code class="docutils literal notranslate"><span class="pre">true</span></code> (default)
table and column statistics are collected for Glue tables and partitions.
Such statistics are stored in JSON format as Glue table and partition
parameters. See also <a class="reference internal" href="../sql/analyze.html"><span class="doc">ANALYZE</span></a>.</p>
</div>
<div class="section" id="known-limitations-of-aws-glue-support">
<h2>Known Limitations of AWS Glue Support<a class="headerlink" href="#known-limitations-of-aws-glue-support" title="Permalink to this headline">#</a></h2>
<p>There are a couple Presto features that are not yet supported with the Glue
catalog:</p>
<ul class="simple">
<li><p>When a column is renamed, its statistics are not preserved. Therefore the
table needs to be re-analyzed.</p></li>
<li><p>Renaming tables from within AWS Glue is not supported.</p></li>
<li><p>Partition values containing quotes and apostrophes are not supported (for
example, <code class="docutils literal notranslate"><span class="pre">PARTITION</span> <span class="pre">(owner=&quot;Doe's&quot;</span></code>).</p></li>
<li><p>Using <a class="reference internal" href="../connector/hive-security.html"><span class="doc">Hive authorization</span></a> is not supported.</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="superset.html" style="box-shadow: none; border: none;" class="btn btn-neutral float-right" title="4.11. Using Apache Superset" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="s3.html" style="box-shadow: none; border: none;" class="btn btn-neutral" title="4.9. Querying AWS S3" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'338',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>