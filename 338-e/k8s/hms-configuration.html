

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.5. Hive metastore configuration &mdash; Starburst Enterprise Presto</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/starburst.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Starburst Enterprise Presto" href="../index.html"/>
        <link rel="up" title="5. Kubernetes with Helm" href="../k8s.html"/>
        <link rel="next" title="5.6. Ranger configuration" href="ranger-configuration.html"/>
        <link rel="prev" title="5.4. SEP configuration" href="sep-configuration.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Starburst Enterprise Presto
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client.html">3. Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws.html">4. Amazon Web Services</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../k8s.html">5. Kubernetes with Helm</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">5.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements.html">5.2. Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html">5.3. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="sep-configuration.html">5.4. SEP configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.5. Hive metastore configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-the-hms">Using the HMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#docker-image-and-registry">Docker image and registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exposing-the-pod-to-outside-network">Exposing the pod to outside network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#database-backend-for-hms">Database backend for HMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-start-up-configuration">Server start up configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-volumes">Additional volumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storage">Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-configuration">Server configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#node-assignment">Node assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#annotations">Annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variables">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ranger-configuration.html">5.6. Ranger configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="operation.html">5.7. Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="release-notes.html">5.8. Helm chart release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="eks.html">5.9. Amazon Elastic Kubernetes Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="gke.html">5.10. Google Kubernetes Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="aks.html">5.11. Microsoft Azure Kubernetes Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="openshift.html">5.12. Red Hat OpenShift</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">6. Kubernetes operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">7. Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin.html">8. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizer.html">9. Query Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connector.html">10. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">11. Functions and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">12. SQL Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">13. SQL Statement Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">14. Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">15. Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">16. Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">17. Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../404.html">404 - Nothing to See Here</a></li>
</ul>

            
          

        </div>
        <div style="margin-top: 1em; margin-left: 2em;">
          Version <a href="../versions.html">338-e LTS and others</a>
          <br><br>
        <span>
  <select name="versions" id="versions" onChange="window.location.href=this.value">
    <option value="./">Choose another version</option>
    <option value="/356-e/">Latest LTS (356-e)</option>
    <option value="/350-e/">350-e LTS</option>
    <option value="/345-e/">345-e LTS</option>
    <option value="/338-e/">338-e LTS</option>
    <option value="/358-e/">Latest STS (358-e)</option>
    <option value="/357-e/">357-e STS</option>
  </select>
</span>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="https://www.starburstdata.com/">
          <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px;"
          src="../_static/img/starburst-darkbg.png"/></a>
        <span class="optional">
          <a href="../index.html">Starburst Enterprise Presto</a>
          <a href="../versions.html" style="font-size: small;margin-left: 0.5em;">338-e LTS and others</a>
          <a href="https://www.starburstdata.com/oreilly-presto-guide-download/?utm_campaign=O%27Reilly%20Presto%20Book&utm_source=starburst&utm_medium=docs">
            <img class="logo"style="background-color: transparent; border-radius: 0%; width: auto; height: auto ;padding: 0px; margin-left: 0.5em;"
          src="../_static/img/ptdg-banner.png"/></a>
          </span>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../k8s.html"><span class="section-number">5. </span>Kubernetes with Helm</a> &raquo;</li>
      
    <li><span class="section-number">5.5. </span>Hive metastore configuration</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hive-metastore-configuration">
<h1><span class="section-number">5.5. </span>Hive metastore configuration<a class="headerlink" href="#hive-metastore-configuration" title="Permalink to this headline">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">starburst-hive</span></code> Helm chart configures a Hive Metastore Service HMS and
optionally the backing database in the cluster with the <code class="docutils literal notranslate"><span class="pre">values.yaml</span></code> file
detailed in the following sections.</p>
<p>A minimal values file <a class="reference internal" href="requirements.html#k8s-docker-registry"><span class="std std-ref">adds the registry credentials</span></a> and overrides any defaults to suitable values.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#using-the-hms" id="id1">Using the HMS</a></p></li>
<li><p><a class="reference internal" href="#docker-image-and-registry" id="id2">Docker image and registry</a></p></li>
<li><p><a class="reference internal" href="#exposing-the-pod-to-outside-network" id="id3">Exposing the pod to outside network</a></p></li>
<li><p><a class="reference internal" href="#database-backend-for-hms" id="id4">Database backend for HMS</a></p></li>
<li><p><a class="reference internal" href="#server-start-up-configuration" id="id5">Server start up configuration</a></p></li>
<li><p><a class="reference internal" href="#additional-volumes" id="id6">Additional volumes</a></p></li>
<li><p><a class="reference internal" href="#storage" id="id7">Storage</a></p></li>
<li><p><a class="reference internal" href="#server-configuration" id="id8">Server configuration</a></p></li>
<li><p><a class="reference internal" href="#node-assignment" id="id9">Node assignment</a></p></li>
<li><p><a class="reference internal" href="#annotations" id="id10">Annotations</a></p></li>
<li><p><a class="reference internal" href="#environment-variables" id="id11">Environment variables</a></p></li>
</ul>
</div>
<div class="section" id="using-the-hms">
<span id="helm-hms-using"></span><h2>Using the HMS<a class="headerlink" href="#using-the-hms" title="Permalink to this headline">#</a></h2>
<p>The expose section configures the DNS availability of the HMS in the cluster. By
default the HMS is available at the hostname <code class="docutils literal notranslate"><span class="pre">hive</span></code> and port <code class="docutils literal notranslate"><span class="pre">9083</span></code>. As a
result the Thrift URL within the cluster is <code class="docutils literal notranslate"><span class="pre">thrift://hive:9083</span></code>.</p>
<p>You can use the URL for <a class="reference internal" href="sep-configuration.html#helm-sep-catalogs"><span class="std std-ref">any catalog</span></a>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">catalog</span><span class="p">:</span>
  <span class="nt">datalake</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">connector.name=hive-hadoop2</span>
    <span class="no">hive.metastore.uri=thrift://hive:9083</span>
</pre></div>
</div>
</div>
<div class="section" id="docker-image-and-registry">
<span id="helm-hms-image"></span><h2>Docker image and registry<a class="headerlink" href="#docker-image-and-registry" title="Permalink to this headline">#</a></h2>
<p>Same as <a class="reference internal" href="sep-configuration.html#helm-sep-image"><span class="std std-ref">Docker image and registry section for the Helm chart</span></a> for SEP.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">image</span><span class="p">:</span>
  <span class="nt">repository</span><span class="p">:</span> <span class="s">&quot;harbor.starburstdata.net/starburstdata/hive&quot;</span>
  <span class="nt">tag</span><span class="p">:</span> <span class="s">&quot;338.8.0&quot;</span>
  <span class="nt">pullPolicy</span><span class="p">:</span> <span class="s">&quot;IfNotPresent&quot;</span>

<span class="nt">registryCredentials</span><span class="p">:</span>
  <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">registry</span><span class="p">:</span>
  <span class="nt">username</span><span class="p">:</span>
  <span class="nt">password</span><span class="p">:</span>

<span class="nt">imagePullSecrets</span><span class="p">:</span>
 <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span>
</pre></div>
</div>
</div>
<div class="section" id="exposing-the-pod-to-outside-network">
<span id="helm-hms-expose"></span><h2>Exposing the pod to outside network<a class="headerlink" href="#exposing-the-pod-to-outside-network" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">expose</span></code> section for the HMS works identical to the SEP server
<a class="reference internal" href="sep-configuration.html#helm-sep-expose"><span class="std std-ref">expose section</span></a>. Differences are isolated to the
configured default values. The default type is <code class="docutils literal notranslate"><span class="pre">clusterIp</span></code>. Ensure to adapt
your configured catalogs to use the correct Thrift URL for HMS, when changing
this configuration.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">expose</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;clusterIp&quot;</span>
  <span class="nt">clusterIp</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;hive&quot;</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="nt">http</span><span class="p">:</span>
        <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9083</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">expose</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;nodePort&quot;</span>
  <span class="nt">nodePort</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;hive&quot;</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="nt">http</span><span class="p">:</span>
        <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">9083</span>
        <span class="nt">nodePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30083</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">expose</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;ingress&quot;</span>
  <span class="nt">ingress</span><span class="p">:</span>
    <span class="nt">tls</span><span class="p">:</span>
      <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">secretName</span><span class="p">:</span>
    <span class="nt">host</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class="nt">annotations</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="database-backend-for-hms">
<span id="helm-hms-database"></span><h2>Database backend for HMS<a class="headerlink" href="#database-backend-for-hms" title="Permalink to this headline">#</a></h2>
<p>The database backend for HMS is a PostgreSQL database internal to the
cluster by default:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">database</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">internal</span>
  <span class="nt">internal</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span>
      <span class="nt">repository</span><span class="p">:</span> <span class="s">&quot;library/postgres&quot;</span>
      <span class="nt">tag</span><span class="p">:</span> <span class="s">&quot;10.6&quot;</span>
      <span class="nt">pullPolicy</span><span class="p">:</span> <span class="s">&quot;IfNotPresent&quot;</span>
    <span class="nt">volume</span><span class="p">:</span>
      <span class="c1"># use one of:</span>
      <span class="c1"># - existingVolumeClaim to specify existing PVC</span>
      <span class="c1"># - persistentVolumeClaim to specify spec for new PVC</span>
      <span class="c1"># - other volume type inline configuration, e.g. emptyDir</span>
      <span class="c1"># Examples:</span>
      <span class="c1"># existingVolumeClaim: &quot;my_claim&quot;</span>
      <span class="c1"># persistentVolumeClaim:</span>
      <span class="c1">#  storageClassName:</span>
      <span class="c1">#  accessModes:</span>
      <span class="c1">#    - ReadWriteOnce</span>
      <span class="c1">#  resources:</span>
      <span class="c1">#    requests:</span>
      <span class="c1">#      storage: &quot;2Gi&quot;</span>
      <span class="nt">emptyDir</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">resources</span><span class="p">:</span>
      <span class="nt">requests</span><span class="p">:</span>
        <span class="nt">memory</span><span class="p">:</span> <span class="s">&quot;1Gi&quot;</span>
        <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
      <span class="nt">limits</span><span class="p">:</span>
        <span class="nt">memory</span><span class="p">:</span> <span class="s">&quot;1Gi&quot;</span>
        <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="s">&quot;org.postgresql.Driver&quot;</span>
    <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5432</span>
    <span class="nt">databaseName</span><span class="p">:</span> <span class="s">&quot;hive&quot;</span>
    <span class="nt">databaseUser</span><span class="p">:</span> <span class="s">&quot;hive&quot;</span>
    <span class="nt">databasePassword</span><span class="p">:</span> <span class="s">&quot;HivePass1234&quot;</span>
    <span class="nt">envFrom</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
    <span class="nt">env</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">database.internal.envFrom</span></code>: YAML sequence of mappings <a class="reference external" href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.19/#envfromsource-v1-core">to define Secret or
Configmap</a>
as a source of <a class="reference internal" href="#helms-hms-environment-variables"><span class="std std-ref">environment variables</span></a>
for the internal PostgreSQL container.</p>
<p><code class="docutils literal notranslate"><span class="pre">database.internal.env</span></code>: YAML sequence of mappings <a class="reference external" href="https://kubernetes.io/docs/tasks/inject-data-application/define-environment-variable-container/">to define two keys</a>
environment variables for the internal PostgreSQL container.</p>
<p>For example, Openshift deployments often do not have access to pull from the
default Docker registry <code class="docutils literal notranslate"><span class="pre">library/postgres</span></code>. You can replace it with an image
from the Redhat registry, which requires additional <a class="reference internal" href="#helms-hms-environment-variables"><span class="std std-ref">environment variables</span></a> set with the parameter
<code class="docutils literal notranslate"><span class="pre">database.internal.env</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">database</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">internal</span>
  <span class="nt">internal</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span>
       <span class="nt">repository</span><span class="p">:</span> <span class="s">&quot;registry.redhat.io/rhscl/postgresql-96-rhel7&quot;</span>
       <span class="nt">tag</span><span class="p">:</span> <span class="s">&quot;latest&quot;</span>
    <span class="nt">env</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">POSTGRESQL_DATABASE</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;hive&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">POSTGRESQL_USER</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;hive&quot;</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">POSTGRESQL_PASSWORD</span>
        <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;HivePass1234&quot;</span>
</pre></div>
</div>
<p>Another option is to create a Secret (ex. <code class="docutils literal notranslate"><span class="pre">postgresql-secret</span></code>) containing
variables needed by <code class="docutils literal notranslate"><span class="pre">postgresql</span></code> which are mentioned in previous code block,
and pass it to the container with <code class="docutils literal notranslate"><span class="pre">envFrom</span></code> parameter:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">database</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">internal</span>
  <span class="nt">internal</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span>
       <span class="nt">repository</span><span class="p">:</span> <span class="s">&quot;registry.redhat.io/rhscl/postgresql-96-rhel7&quot;</span>
       <span class="nt">tag</span><span class="p">:</span> <span class="s">&quot;latest&quot;</span>
    <span class="nt">envFrom</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">secretRef</span><span class="p">:</span>
          <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">postgresql-secret</span>
</pre></div>
</div>
<p>Alternatively you can use an external PostgreSQL or MySQL database, by setting
<code class="docutils literal notranslate"><span class="pre">database.type</span></code> to <code class="docutils literal notranslate"><span class="pre">external</span></code> and configuring the nested properties.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">database</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">external</span>
  <span class="nt">external</span><span class="p">:</span>
    <span class="nt">jdbcUrl</span><span class="p">:</span>
    <span class="nt">driver</span><span class="p">:</span>
    <span class="nt">user</span><span class="p">:</span>
    <span class="nt">password</span><span class="p">:</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">database.external.jdbcUrl</span></code>: JDBC URL to connect to the external database as
required by the database and used driver, including hostname and port. Ensure
you use a valid JDBC URL as required by the PostgreSQL or MySQL driver.
Typically the syntax requires the host, port and database name
<code class="docutils literal notranslate"><span class="pre">jdbc:postgresql://host:port/database</span></code> or <code class="docutils literal notranslate"><span class="pre">jdbc:mysql://host:port/database</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">database.external.driver</span></code>:  Valid values are <code class="docutils literal notranslate"><span class="pre">com.mysql.jdbc.Driver</span></code> for an
external MySQL or compatible database or <code class="docutils literal notranslate"><span class="pre">org.postgresql.Driver</span></code> for a
PostgreSQL database.</p>
<p><code class="docutils literal notranslate"><span class="pre">database.external.user</span></code>: Database user name to access the external database
using JDBC.</p>
<p><code class="docutils literal notranslate"><span class="pre">database.external.password</span></code>: Password for the user configured to access the
external database using JDBC.</p>
</div>
<div class="section" id="server-start-up-configuration">
<span id="helm-hms-startup"></span><h2>Server start up configuration<a class="headerlink" href="#server-start-up-configuration" title="Permalink to this headline">#</a></h2>
<p>You can create a startup shell script to customize how HMS is started,
and pass additional arguments to it.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">initFile</span><span class="p">:</span>
<span class="nt">extraArguments</span><span class="p">:</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">initFile</span></code></p>
<p>A shell script to run before HMS is launched. The content of the file has to
be an inline string in the YAML file. The original startup command is passed
as the first argument. The script needs to invoke it at the end
as <code class="docutils literal notranslate"><span class="pre">exec</span> <span class="pre">&quot;$&#64;&quot;</span></code>. Use <code class="docutils literal notranslate"><span class="pre">exec</span> <span class="pre">&quot;$1&quot;</span></code> if passing any extra arguments.</p>
<p><code class="docutils literal notranslate"><span class="pre">extraArguments</span></code></p>
<p>List of extra arguments to pass to the <code class="docutils literal notranslate"><span class="pre">initFile</span></code> script.</p>
<p>The following example shows how you can use <code class="docutils literal notranslate"><span class="pre">initFile</span></code> to run a custom start
up script:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">initFile</span><span class="p">:</span> <span class="p p-Indicator">|</span>
  <span class="no">#!/bin/bash</span>
  <span class="no">echo &quot;Custom init for $2&quot;</span>
  <span class="no">exec &quot;$1&quot;</span>
<span class="nt">extraArguments</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">TEST_ARG</span>
</pre></div>
</div>
</div>
<div class="section" id="additional-volumes">
<span id="helm-hms-volumes"></span><h2>Additional volumes<a class="headerlink" href="#additional-volumes" title="Permalink to this headline">#</a></h2>
<p>Additional volumes can be necessary for persisting files. These can be defined
in the <code class="docutils literal notranslate"><span class="pre">additionalVolumes</span></code> section. None are defined by default:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalVolumes</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
</pre></div>
</div>
<p>You can add one or more <a class="reference external" href="https://kubernetes.io/docs/concepts/storage/volumes/#types-of-volumes">volumes supported by k8s</a>, to
all nodes in the cluster.</p>
<p>If you specify <code class="docutils literal notranslate"><span class="pre">path</span></code> only, a directory named in <code class="docutils literal notranslate"><span class="pre">path</span></code> is created. When
mounting ConfigMap or Secret, files are created in this directory for each key.</p>
<p>This also supports an optional <code class="docutils literal notranslate"><span class="pre">subPath</span></code> parameter which takes in an optional
key in the ConfigMap or Secret volume you create. If you specify <code class="docutils literal notranslate"><span class="pre">subPath</span></code>, a
specific key named <code class="docutils literal notranslate"><span class="pre">subPath</span></code> from ConfigMap or Secret is mounted as a file
with the  name provided by <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalVolumes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/mnt/InContainer</span>
    <span class="nt">volume</span><span class="p">:</span>
      <span class="nt">emptyDir</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/hive/conf/test_config.txt</span>
    <span class="nt">subPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test_config.txt</span>
    <span class="nt">volume</span><span class="p">:</span>
      <span class="nt">configMap</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;configmap-in-volume&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="storage">
<span id="helm-hms-storage"></span><h2>Storage<a class="headerlink" href="#storage" title="Permalink to this headline">#</a></h2>
<p>The chart allows you to configure the credentials to access the HDFS or object
storage. The credentials enable the HMS to access to storage for metadata
information including statistics gathering.</p>
<p>In addition you have to <a class="reference internal" href="sep-configuration.html#helm-sep-catalogs"><span class="std std-ref">configure the catalog</span></a> with
sufficient, corresponding credentials.</p>
<p>The default configuration includes no credentials:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">hdfs</span><span class="p">:</span>
  <span class="nt">hadoopUserName</span><span class="p">:</span>
<span class="nt">objectStorage</span><span class="p">:</span>
  <span class="nt">awsS3</span><span class="p">:</span>
    <span class="nt">region</span><span class="p">:</span>
    <span class="nt">endpoint</span><span class="p">:</span>
    <span class="nt">accessKey</span><span class="p">:</span>
    <span class="nt">secretKey</span><span class="p">:</span>
    <span class="nt">pathStyleAccess</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">gs</span><span class="p">:</span>
    <span class="nt">cloudKeyFileSecret</span><span class="p">:</span>
  <span class="nt">azure</span><span class="p">:</span>
    <span class="nt">abfs</span><span class="p">:</span>
      <span class="nt">authType</span><span class="p">:</span> <span class="s">&quot;accessKey&quot;</span>
      <span class="nt">accessKey</span><span class="p">:</span>
        <span class="nt">storageAccount</span><span class="p">:</span>
        <span class="nt">accessKey</span><span class="p">:</span>
      <span class="nt">oauth</span><span class="p">:</span>
        <span class="nt">clientId</span><span class="p">:</span>
        <span class="nt">secret</span><span class="p">:</span>
        <span class="nt">endpoint</span><span class="p">:</span>
    <span class="nt">wasb</span><span class="p">:</span>
      <span class="nt">storageAccount</span><span class="p">:</span>
      <span class="nt">accessKey</span><span class="p">:</span>
  <span class="nt">adl</span><span class="p">:</span>
    <span class="nt">oauth2</span><span class="p">:</span>
      <span class="nt">clientId</span><span class="p">:</span>
      <span class="nt">credential</span><span class="p">:</span>
      <span class="nt">refreshUrl</span><span class="p">:</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hdfs.hadoopUserName</span></code>: User name for Hadoop HDFS access</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.awsS3.*</span></code>: Configuration for AWS S3 access</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.awsS3.region</span></code>: AWS region name</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.awsS3.endpoint</span></code>: AWS S3 endpoint</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.awsS3.accessKey</span></code>: Name of the access key for AWS S3</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.awsS3.secretKey</span></code>: Name of the secret key for AWS S3</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.awsS3.pathStyleAccess</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.gs.*</span></code>: Configuration for Google Storage access</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.gs.cloudKeyFileSecret</span></code>: Name of the secret with the file containing
the access key to the cloud storage. The key of the secret must be named <code class="docutils literal notranslate"><span class="pre">key.json</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.*</span></code>: Configuration for Microsoft Azure storage systems</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.*</span></code>: Configuration for Azure Blob Filesystem (ABFS)</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.authType</span></code>: Authentication to access ABFS, Valid
values are``accessKey`` or <code class="docutils literal notranslate"><span class="pre">oauth</span></code>, configuration in the following properties.</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.accessKey.*</span></code>: Configuration for access key
authentication to ABFS</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.accessKey.storageAccount</span></code>: Name of the ABFS account to access</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.accessKey.accessKey</span></code>: Actual access key to use for
ABFS  access</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.oauth.*</span></code>: Configuration for OAuth authentication to
ABFS</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.oauth.clientId</span></code>: Client identifier for OAuth
authentication.</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.oauth.secret</span></code>: Secret for OAuth.</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.abfs.oauth.endpoint</span></code>: Endpoint URL for OAuth.</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.wasb.*</span></code>: Configuration for Windows Azure Storage Blob
(WASB)</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.wasb.storageAccount</span></code>: Name of the storage account to use
for WASB.</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.wasb.accessKey</span></code>: Key to access WASB.</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.adl</span></code>: Configuration for Azure Data Lake (ADL)</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.adl.oauth2.*</span></code>: Configuration for OAuth authentication to
ADL</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.adl.oauth2.clientId</span></code>: Client identifier for OAuth access
to ADL</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.adl.oauth2.credential</span></code>: Credential for OAuth access to
ADL</p>
<p><code class="docutils literal notranslate"><span class="pre">objectStorage.azure.adl.oauth2.refreshUrl</span></code>: Refresh URL for the OAuth access
to ADL.</p>
</div>
<div class="section" id="server-configuration">
<span id="helm-hms-server"></span><h2>Server configuration<a class="headerlink" href="#server-configuration" title="Permalink to this headline">#</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">heapSizePercentage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">85</span>

<span class="nt">resources</span><span class="p">:</span>
  <span class="nt">requests</span><span class="p">:</span>
    <span class="nt">memory</span><span class="p">:</span> <span class="s">&quot;1Gi&quot;</span>
    <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">limits</span><span class="p">:</span>
    <span class="nt">memory</span><span class="p">:</span> <span class="s">&quot;1Gi&quot;</span>
    <span class="nt">cpu</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
</div>
<div class="section" id="node-assignment">
<h2>Node assignment<a class="headerlink" href="#node-assignment" title="Permalink to this headline">#</a></h2>
<p>You can add configuration to <a class="reference internal" href="installation.html#helm-node-assignment"><span class="std std-ref">determine the node and pod to use</span></a>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">nodeSelector</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
<span class="nt">tolerations</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">affinity</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="annotations">
<h2>Annotations<a class="headerlink" href="#annotations" title="Permalink to this headline">#</a></h2>
<p>You can add configuration to annotate the deployment and pod:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">deploymentAnnotations</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
<span class="nt">podAnnotations</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="environment-variables">
<span id="helms-hms-environment-variables"></span><h2>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">#</a></h2>
<p>You can pass environment variables to the HMS container using the same mechanism
used for the internal database:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">envFrom</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
<span class="nt">env</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
</pre></div>
</div>
<p>Both are specified as a mapping sequences for example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">envFrom</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">secretRef</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-secret-with-vars</span>
<span class="nt">env</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MY_VARIABLE</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">some-value</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ranger-configuration.html" style="box-shadow: none; border: none;" class="btn btn-neutral float-right" title="5.6. Ranger configuration" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sep-configuration.html" style="box-shadow: none; border: none;" class="btn btn-neutral" title="5.4. SEP configuration" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'338',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>