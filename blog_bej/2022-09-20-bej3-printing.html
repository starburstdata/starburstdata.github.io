<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Starburst | Printing</title>
    <meta name="viewport" content="width=device-width">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Starburst - Printing">
    <meta property="og:description" content="Your hub to all knowledge about Starburst products.">
    <meta property="og:image" content="/assets/img/starburst-og-image.png">

    <link rel="stylesheet" href="/assets/fontawesome/css/all.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/mdb.min.css">
    <link rel="stylesheet" href="/assets/css/highlight.css">
    <link rel="stylesheet" href="/assets/css/fonts.css">
    <link rel="stylesheet" href="/assets/css/style.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114610397-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-114610397-1');
</script>

<script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://cdn.heapanalytics.com/js/heap-"+e+".js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a);for(var n=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],o=0;o<p.length;o++)heap[p[o]]=n(p[o])};
    heap.load("588835629");
</script>
<script>
  var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights@2.2.1";

  !function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
  (e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
  i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
  }(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Printing | Starburst</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Printing" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is part 3 of the Bleeding edge Java series. Start at the introduction if you haven’t already. Printing is the process of converting a stream of JSON tokens into JSON text. For our library, our printer only needs to print a single JSON token at a time. Our serializer already produces a stream of JSON tokens and the JDK has a large set of existing methods for managing streams. What we need is a mapping function that can be passed to the JDK Stream’s map() method. We can define a Java interface for this: public interface JsonPrinter { CharSequence print(JsonToken jsonToken); } With an instance of this interface we can serialize from a Java object to a stream of JSON tokens to JSON text like this: String jsonText = serializer.serialize(object) .map(printer::print) .collect(Collectors.joining()); The implementation for our printer is very straightforward. Note the code uses a StringUtils utility from the link at the end of this article: CharSequence print(JsonToken jsonToken) { return switch (jsonToken) { case NumberToken(var number) -&gt; number.toString(); case StringToken(var string) -&gt; StringUtils.quoteAndEscape(string); case BooleanToken(var value) -&gt; value ? &quot;true&quot; : &quot;false&quot;; case NullToken __ -&gt; &quot;null&quot;; case BeginArrayToken __ -&gt; &quot;[&quot;; case EndArrayToken __ -&gt; &quot;]&quot;; case BeginObjectToken __ -&gt; &quot;{&quot;; case EndObjectToken __ -&gt; &quot;}&quot;; case ObjectNameToken(var name) -&gt; StringUtils.quoteAndEscape(name) + &quot;:&quot;; case ValueSeparatorToken __ -&gt; &quot;,&quot;; }; } Here again we take advantage of enhanced switch and pattern matching (see Serialization for more details). Additionally, we use the deconstruction feature of Record Patterns. With the first case statement, case NumberToken(var number), the compiler matches if the token is a number token and then extracts the number token’s value, binding it to the new variable number. It can be thought of as this Java code: if (jsonToken instanceOf NumberToken) { var number = ((NumberToken) jsonToken).value(); } Finally, notice that the switch statement does not need a default case. We have case statements for all possible implementations in the JsonToken sealed hierarchy. The Java compiler knows this and doesn’t require a default. If in the future we add a new JsonToken type this code would no longer compile. Test it out for yourself! In the prior article we developed a serializer that can serialize a Java record into a stream of JSON tokens. We now have a printer that can map a JSON token into JSON text. Let’s put this together in jshell. The example use these files: TypeToken.java JsonToken.java JsonSerializer.java StringUtils.java (utility class) JsonPrinter.java From a terminal with Java 19 installed, run the following (note you’ll need the wget utility): wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/TypeToken.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonToken.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonSerializer.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/StringUtils.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonPrinter.java jshell --enable-preview TypeToken.java JsonToken.java JsonSerializer.java StringUtils.java JsonPrinter.java Inside jshell let’s serialize a Java record into JSON text: var serializer = JsonSerializer.instance(); var printer = JsonPrinter.instance(); record Person(String name, int age) {} var person = new Person(&quot;someone&quot;, 28); String jsonText = serializer.serialize(person) // serialize record to stream of tokens .map(printer::print) // map each JsonToken to a String (as a CharSequence) .collect(Collectors.joining()); // collect into a String System.out.println(jsonText); Summary We can now serialize a Java record into JSON text. Let’s look at parsing into tokens next in parsing. We’re hiring Want to be able to use the latest features of Java? We’re hiring! Jordan Zimmerman is a Senior Software Engineer working on Starburst Galaxy." />
<meta property="og:description" content="This is part 3 of the Bleeding edge Java series. Start at the introduction if you haven’t already. Printing is the process of converting a stream of JSON tokens into JSON text. For our library, our printer only needs to print a single JSON token at a time. Our serializer already produces a stream of JSON tokens and the JDK has a large set of existing methods for managing streams. What we need is a mapping function that can be passed to the JDK Stream’s map() method. We can define a Java interface for this: public interface JsonPrinter { CharSequence print(JsonToken jsonToken); } With an instance of this interface we can serialize from a Java object to a stream of JSON tokens to JSON text like this: String jsonText = serializer.serialize(object) .map(printer::print) .collect(Collectors.joining()); The implementation for our printer is very straightforward. Note the code uses a StringUtils utility from the link at the end of this article: CharSequence print(JsonToken jsonToken) { return switch (jsonToken) { case NumberToken(var number) -&gt; number.toString(); case StringToken(var string) -&gt; StringUtils.quoteAndEscape(string); case BooleanToken(var value) -&gt; value ? &quot;true&quot; : &quot;false&quot;; case NullToken __ -&gt; &quot;null&quot;; case BeginArrayToken __ -&gt; &quot;[&quot;; case EndArrayToken __ -&gt; &quot;]&quot;; case BeginObjectToken __ -&gt; &quot;{&quot;; case EndObjectToken __ -&gt; &quot;}&quot;; case ObjectNameToken(var name) -&gt; StringUtils.quoteAndEscape(name) + &quot;:&quot;; case ValueSeparatorToken __ -&gt; &quot;,&quot;; }; } Here again we take advantage of enhanced switch and pattern matching (see Serialization for more details). Additionally, we use the deconstruction feature of Record Patterns. With the first case statement, case NumberToken(var number), the compiler matches if the token is a number token and then extracts the number token’s value, binding it to the new variable number. It can be thought of as this Java code: if (jsonToken instanceOf NumberToken) { var number = ((NumberToken) jsonToken).value(); } Finally, notice that the switch statement does not need a default case. We have case statements for all possible implementations in the JsonToken sealed hierarchy. The Java compiler knows this and doesn’t require a default. If in the future we add a new JsonToken type this code would no longer compile. Test it out for yourself! In the prior article we developed a serializer that can serialize a Java record into a stream of JSON tokens. We now have a printer that can map a JSON token into JSON text. Let’s put this together in jshell. The example use these files: TypeToken.java JsonToken.java JsonSerializer.java StringUtils.java (utility class) JsonPrinter.java From a terminal with Java 19 installed, run the following (note you’ll need the wget utility): wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/TypeToken.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonToken.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonSerializer.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/StringUtils.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonPrinter.java jshell --enable-preview TypeToken.java JsonToken.java JsonSerializer.java StringUtils.java JsonPrinter.java Inside jshell let’s serialize a Java record into JSON text: var serializer = JsonSerializer.instance(); var printer = JsonPrinter.instance(); record Person(String name, int age) {} var person = new Person(&quot;someone&quot;, 28); String jsonText = serializer.serialize(person) // serialize record to stream of tokens .map(printer::print) // map each JsonToken to a String (as a CharSequence) .collect(Collectors.joining()); // collect into a String System.out.println(jsonText); Summary We can now serialize a Java record into JSON text. Let’s look at parsing into tokens next in parsing. We’re hiring Want to be able to use the latest features of Java? We’re hiring! Jordan Zimmerman is a Senior Software Engineer working on Starburst Galaxy." />
<link rel="canonical" href="https://www.starburst.io/blog/2022-09-20-bej3-printing-html/" />
<meta property="og:url" content="https://www.starburst.io/blog/2022-09-20-bej3-printing-html/" />
<meta property="og:site_name" content="Starburst" />
<meta property="og:image" content="https://docs.starburst.io/assets/img/logo/java.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-20T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://docs.starburst.io/assets/img/logo/java.png" />
<meta property="twitter:title" content="Printing" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-20T00:00:00-05:00","datePublished":"2022-09-20T00:00:00-05:00","description":"This is part 3 of the Bleeding edge Java series. Start at the introduction if you haven’t already. Printing is the process of converting a stream of JSON tokens into JSON text. For our library, our printer only needs to print a single JSON token at a time. Our serializer already produces a stream of JSON tokens and the JDK has a large set of existing methods for managing streams. What we need is a mapping function that can be passed to the JDK Stream’s map() method. We can define a Java interface for this: public interface JsonPrinter { CharSequence print(JsonToken jsonToken); } With an instance of this interface we can serialize from a Java object to a stream of JSON tokens to JSON text like this: String jsonText = serializer.serialize(object) .map(printer::print) .collect(Collectors.joining()); The implementation for our printer is very straightforward. Note the code uses a StringUtils utility from the link at the end of this article: CharSequence print(JsonToken jsonToken) { return switch (jsonToken) { case NumberToken(var number) -&gt; number.toString(); case StringToken(var string) -&gt; StringUtils.quoteAndEscape(string); case BooleanToken(var value) -&gt; value ? &quot;true&quot; : &quot;false&quot;; case NullToken __ -&gt; &quot;null&quot;; case BeginArrayToken __ -&gt; &quot;[&quot;; case EndArrayToken __ -&gt; &quot;]&quot;; case BeginObjectToken __ -&gt; &quot;{&quot;; case EndObjectToken __ -&gt; &quot;}&quot;; case ObjectNameToken(var name) -&gt; StringUtils.quoteAndEscape(name) + &quot;:&quot;; case ValueSeparatorToken __ -&gt; &quot;,&quot;; }; } Here again we take advantage of enhanced switch and pattern matching (see Serialization for more details). Additionally, we use the deconstruction feature of Record Patterns. With the first case statement, case NumberToken(var number), the compiler matches if the token is a number token and then extracts the number token’s value, binding it to the new variable number. It can be thought of as this Java code: if (jsonToken instanceOf NumberToken) { var number = ((NumberToken) jsonToken).value(); } Finally, notice that the switch statement does not need a default case. We have case statements for all possible implementations in the JsonToken sealed hierarchy. The Java compiler knows this and doesn’t require a default. If in the future we add a new JsonToken type this code would no longer compile. Test it out for yourself! In the prior article we developed a serializer that can serialize a Java record into a stream of JSON tokens. We now have a printer that can map a JSON token into JSON text. Let’s put this together in jshell. The example use these files: TypeToken.java JsonToken.java JsonSerializer.java StringUtils.java (utility class) JsonPrinter.java From a terminal with Java 19 installed, run the following (note you’ll need the wget utility): wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/TypeToken.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonToken.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonSerializer.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/StringUtils.java wget -nc https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonPrinter.java jshell --enable-preview TypeToken.java JsonToken.java JsonSerializer.java StringUtils.java JsonPrinter.java Inside jshell let’s serialize a Java record into JSON text: var serializer = JsonSerializer.instance(); var printer = JsonPrinter.instance(); record Person(String name, int age) {} var person = new Person(&quot;someone&quot;, 28); String jsonText = serializer.serialize(person) // serialize record to stream of tokens .map(printer::print) // map each JsonToken to a String (as a CharSequence) .collect(Collectors.joining()); // collect into a String System.out.println(jsonText); Summary We can now serialize a Java record into JSON text. Let’s look at parsing into tokens next in parsing. We’re hiring Want to be able to use the latest features of Java? We’re hiring! Jordan Zimmerman is a Senior Software Engineer working on Starburst Galaxy.","headline":"Printing","image":"https://docs.starburst.io/assets/img/logo/java.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.starburst.io/blog/2022-09-20-bej3-printing-html/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.starburst.io/assets/img/logo/starburst-reverse.png"}},"url":"https://www.starburst.io/blog/2022-09-20-bej3-printing-html/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>


<header class="main-header navbar-expand-sm">
  <div class="navbar fixed-top navbar-dark">
    <div class="navbar-left-container">
      <a class="navbar-brand" href="https://www.starburst.io/">
        <img src="/assets/img/logo/starburst_KO-T.png" height="32" alt="Starburst">
      </a>
      <span class="navbar-divider"></span>
      <a href="/" class="header-text">Documentation</a>
    </div>
    
    <div class="nav-item dropdown" id="site-search">
  <div id="dropdownSearchDisplay" aria-labelledby="dropdownSearch">
    <div id="algolia-search">
      <div id="searchbox"></div>
      <div
        class="refinement-list"
        id="versionsRefinementList"
        style="display: none"
      ></div>
      <div class="refinement-list" id="product-list">
        <h6>Product:</h6>
      </div>
      <div id="hits"></div>
      <div id="stats"></div>
    </div>
  </div>
</div>

    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>
    <nav class="primary-nav">
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-layout navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a id="get-started"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Get started" data-is-click="false"
              href="/get-started/index.html">Introduction</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/get-started/concepts.html">Concepts</a>
              <a class="dropdown-item" href="/get-started/architecture.html">Architecture</a>
              <a class="dropdown-item" href="/get-started/data-sources-catalogs.html">Data sources and catalogs</a>
              <a class="dropdown-item" href="/get-started/data-lake.html">Data lake</a>
              <a class="dropdown-item" href="/get-started/security.html">Security</a>
              <a class="dropdown-item" href="/get-started/choose-your-starburst-product.html">Choose your Starburst product</a>
              <a class="dropdown-item" href="/data-consumer/index.html">Data consumer</a>
              <a class="dropdown-item" href="/data-engineer/index.html">Data engineer</a>
              <a class="dropdown-item" href="/platform-administrator/index.html">Platform administrator</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="clients"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Clients" data-is-click="false"
              href="/clients/index.html">Clients</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/clients/index.html">Overview</a>
              <a class="dropdown-item" href="/clients/cli.html">CLI</a>
              <a class="dropdown-item" href="/clients/jdbc.html">JDBC driver</a>
              <a class="dropdown-item" href="/clients/odbc.html">ODBC driver</a>
              <a class="dropdown-item" href="/clients/airbyte.html">Airbyte</a>
              <a class="dropdown-item" href="/clients/alation.html">Alation</a>
              <a class="dropdown-item" href="/clients/datagrip.html">Datagrip</a>
              <a class="dropdown-item" href="/clients/dbeaver.html">dBeaver</a>
              <a class="dropdown-item" href="/clients/dbt.html">dbt</a>
              <a class="dropdown-item" href="/clients/looker.html">Looker</a>
              <a class="dropdown-item" href="/clients/metabase.html">Metabase</a>
              <a class="dropdown-item" href="/clients/microstrategy.html">Microstrategy</a>
              <a class="dropdown-item" href="/clients/powerbi.html">Power BI</a>
              <a class="dropdown-item" href="/clients/python.html">Python</a>
              <a class="dropdown-item" href="/clients/querybook.html">Querybook</a>
              <a class="dropdown-item" href="/clients/squirrel-sql.html">SQuirreL SQL</a>
              <a class="dropdown-item" href="/clients/superset.html">Superset</a>
              <a class="dropdown-item" href="/clients/tableau/index.html">Tableau</a>
              <a class="dropdown-item" href="/clients/thoughtspot.html">Thoughtspot</a>
              <a class="dropdown-item" href="/clients/zingdata.html">Zing Data</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="starburst-galaxy"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Starburst Galaxy" data-is-click="false"
              href="/starburst-galaxy/index.html">Starburst Galaxy</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/starburst-galaxy/get-started/index.html">Get started</a>
              <a class="dropdown-item" href="/starburst-galaxy/global/get-support.html">Help center</a>
              <a class="dropdown-item" href="/starburst-galaxy/query/index.html">Query</a>
              <a class="dropdown-item" href="/starburst-galaxy/catalogs/index.html">Catalogs</a>
              <a class="dropdown-item" href="/starburst-galaxy/catalog-explorer/index.html">Catalog explorer</a>
              <a class="dropdown-item" href="/starburst-galaxy/clusters/index.html">Clusters</a>
              <a class="dropdown-item" href="/starburst-galaxy/data-products/index.html">Data products</a>
              <a class="dropdown-item" href="/starburst-galaxy/partner-connect.html">Partner connect</a>
              <a class="dropdown-item" href="/starburst-galaxy/admin/index.html">Admin</a>
              <a class="dropdown-item" href="/starburst-galaxy/access-control/index.html">Access control</a>
              <a class="dropdown-item" href="/starburst-galaxy/cloud-settings/index.html">Cloud settings</a>
              <a class="dropdown-item" href="/starburst-galaxy/security/index.html">Security</a>
              <a class="dropdown-item" href="/starburst-galaxy/sso/index.html">Single sign-on</a>
              <a class="dropdown-item" href="/starburst-galaxy/troubleshooting/index.html">Troubleshooting</a>
              <a class="dropdown-item" href="/starburst-galaxy/python/index.html">Python</a>
              <a class="dropdown-item" href="/starburst-galaxy/api.html">API</a>
              <a class="dropdown-item" href="/starburst-galaxy/sql/index.html">SQL</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="starburst-enterprise"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Get started" data-is-click="false"
              href="/starburst-enterprise/index.html">Starburst Enterprise</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/starburst-enterprise/try/index.html">Try Starburst Enterprise</a>
              <a class="dropdown-item" href="/starburst-enterprise/web-ui/index.html">Web UI</a>
              <a class="dropdown-item" href="/starburst-enterprise/sql.html">SQL</a>
              <a class="dropdown-item" href="/starburst-enterprise/admin-topics/index.html">Administration</a>
              <a class="dropdown-item" href="/starburst-enterprise/k8s/index.html">Kubernetes deployments</a>
              <a class="dropdown-item" href="/starburst-enterprise/starburst-admin/index.html">Starburst Admin</a>
              <a class="dropdown-item" href="/latest/index.html">Reference documentation</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="ecosystems"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="Get started" data-is-click="false"
              href="/ecosystems/index.html">Ecosystems</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/ecosystems/amazon/index.html">Amazon AWS</a>
              <a class="dropdown-item" href="/ecosystems/google/index.html">Google Cloud</a>
              <a class="dropdown-item" href="/ecosystems/microsoft/index.html">Microsoft Azure</a>
              <a class="dropdown-item" href="/ecosystems/redhat/index.html">Red Hat OpenShift</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a id="resources"
               class="nav-link dropdown-toggle" 
              aria-haspopup="true" aria-label="resources" data-is-click="false"
              href="/resources.html">Resources</a>
            <div class="dropdown-menu dropdown-docs">
              <a class="dropdown-item" href="/support.html">Support</a>
              <a class="dropdown-item" href="/security/index.html">Security</a>
              <a class="dropdown-item" href="https://www.starburst.io/blog/technical">Technical blog</a>
              <a class="dropdown-item" href="/videos/index.html">Video library</a>
              <a class="dropdown-item" href="https://academy.starburst.io/">Starburst Academy</a>
              <a class="dropdown-item" href="/glossary.html">Glossary</a>
              <a class="dropdown-item" href="/conventions.html">Conventions</a>
              <a class="dropdown-item" href="/iconography.html">Iconography</a>
              <a class="dropdown-item" href="https://www.starburst.io/community/forum/">Starburst forum</a>
            </div>
          </li>
        </ul>
      </div>
    </nav>
</header>

    <div class="landing-page">
        <div class="sep-hero">
  <div class="container sep-parent">
    <div class="row">
      <div class="col-md-12">
        <h1><a href="/blog/">Starburst developer blog</a></h1>
        <p class="lead">The latest news from our users, engineers, writers, and
        product folks for all our peers and friends out there.</p>
        <p>Want even more updates and information? Go to the
          <a href="https://blog.starburst.io/">Starburst company blog</a>.</p>
      </div>
    </div>
  </div>
</div>

  


<div class="content container-fluid post-container clearfix spacer-30">

  <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="container">
      <div class="row">

        <div class="col-xl-3">
          <h3>Contents</h3>
          <ul class="list-group">
            
              
                <a class="list-group-item" href="/blog/2022-09-20-bej0-introduction.html">Bleeding edge Java</a>
              
            
            
              
                <a class="list-group-item" href="/blog_bej/2022-09-20-bej1-design.html">Designing a JSON model</a>
              
            
              
                <a class="list-group-item" href="/blog_bej/2022-09-20-bej2-serialization.html">Serialization</a>
              
            
              
                <li class="list-group-item active">Printing</li>
              
            
              
                <a class="list-group-item" href="/blog_bej/2022-09-20-bej4-parsing.html">Parsing</a>
              
            
              
                <a class="list-group-item" href="/blog_bej/2022-09-20-bej5-deserialization.html">Deserialization part 1</a>
              
            
              
                <a class="list-group-item" href="/blog_bej/2022-09-20-bej6-deserialization.html">Deserialization part 2</a>
              
            
              
                <a class="list-group-item" href="/blog_bej/2022-09-20-bej7-conclusion.html">Conclusion</a>
              
            
          </ul>
        </div>

        <div class="col-xl-9">
          <header class="post-header">
            <h1 class="post-title p-name" itemprop="name headline">
              Printing</h1>
            <p class="post-meta">
              <time class="dt-published" abbrtime="2022-09-20T00:00:00-05:00" itemprop="datePublished">
                Sep 20, 2022
              </time> |

     Jordan Zimmerman
     
     
     <a href="https://github.com/randgalt" target="_blank"><i class="fab fa-github"></i></a>
     
     

</p>
          </header>

          <div class="content width clearfix" itemprop="articleBody"><img src="../assets/img/logo/java.png" style="float: right;"><p><em>This is part 3 of the Bleeding edge Java series. <a href="/blog/2022-09-20-bej0-introduction.html">Start at the
introduction</a> if you haven’t
already.</em></p>

<p>Printing is the process of converting a stream of JSON tokens into JSON text.
For our library, our printer only needs to print a single JSON token at a time.
Our serializer already produces a stream of JSON tokens and the JDK has a large
set of existing methods for managing streams.</p>

<p>What we need is a mapping function that can be passed to the JDK Stream’s
<code class="language-plaintext highlighter-rouge">map()</code> method. We can define a Java interface for this:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">JsonPrinter</span>
<span class="o">{</span>
    <span class="nc">CharSequence</span> <span class="nf">print</span><span class="o">(</span><span class="nc">JsonToken</span> <span class="n">jsonToken</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>With an instance of this interface we can serialize from a Java object to a
stream of JSON tokens to JSON text like this:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">jsonText</span> <span class="o">=</span> <span class="n">serializer</span><span class="o">.</span><span class="na">serialize</span><span class="o">(</span><span class="n">object</span><span class="o">)</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">printer:</span><span class="o">:</span><span class="n">print</span><span class="o">)</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">());</span>
</code></pre></div></div>

<p>The implementation for our printer is very straightforward. Note the code uses a
StringUtils utility from the link at the end of this article:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">CharSequence</span> <span class="nf">print</span><span class="o">(</span><span class="nc">JsonToken</span> <span class="n">jsonToken</span><span class="o">)</span>
<span class="o">{</span>
    <span class="k">return</span> <span class="nf">switch</span> <span class="o">(</span><span class="n">jsonToken</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nf">NumberToken</span><span class="o">(</span><span class="kt">var</span> <span class="n">number</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">number</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
        <span class="k">case</span> <span class="nf">StringToken</span><span class="o">(</span><span class="kt">var</span> <span class="n">string</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">StringUtils</span><span class="o">.</span><span class="na">quoteAndEscape</span><span class="o">(</span><span class="n">string</span><span class="o">);</span>
        <span class="k">case</span> <span class="nf">BooleanToken</span><span class="o">(</span><span class="kt">var</span> <span class="n">value</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">value</span> <span class="o">?</span> <span class="s">"true"</span> <span class="o">:</span> <span class="s">"false"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">NullToken</span> <span class="n">__</span> <span class="o">-&gt;</span> <span class="s">"null"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">BeginArrayToken</span> <span class="n">__</span> <span class="o">-&gt;</span> <span class="s">"["</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">EndArrayToken</span> <span class="n">__</span> <span class="o">-&gt;</span> <span class="s">"]"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">BeginObjectToken</span> <span class="n">__</span> <span class="o">-&gt;</span> <span class="s">"{"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">EndObjectToken</span> <span class="n">__</span> <span class="o">-&gt;</span> <span class="s">"}"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nf">ObjectNameToken</span><span class="o">(</span><span class="kt">var</span> <span class="n">name</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">StringUtils</span><span class="o">.</span><span class="na">quoteAndEscape</span><span class="o">(</span><span class="n">name</span><span class="o">)</span> <span class="o">+</span> <span class="s">":"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">ValueSeparatorToken</span> <span class="n">__</span> <span class="o">-&gt;</span> <span class="s">","</span><span class="o">;</span>
    <span class="o">};</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Here again we take advantage of enhanced switch and pattern matching (see
<a href="/blog_bej/2022-09-20-bej2-serialization.html">Serialization</a> for more details).
Additionally, we use the deconstruction feature of <a href="https://openjdk.org/jeps/405" target="_blank">Record Patterns</a>.
With the first case statement, <code class="language-plaintext highlighter-rouge">case NumberToken(var number)</code>, the compiler matches
if the token is a number token and then extracts the number token’s value, binding it to the new
variable <code class="language-plaintext highlighter-rouge">number</code>. It  can be thought of as this Java code:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(</span><span class="n">jsonToken</span> <span class="n">instanceOf</span> <span class="nc">NumberToken</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">number</span> <span class="o">=</span> <span class="o">((</span><span class="nc">NumberToken</span><span class="o">)</span> <span class="n">jsonToken</span><span class="o">).</span><span class="na">value</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Finally, notice that the <code class="language-plaintext highlighter-rouge">switch</code> statement does not need a <code class="language-plaintext highlighter-rouge">default</code> case. We
have <code class="language-plaintext highlighter-rouge">case</code> statements for all possible implementations in the JsonToken sealed
hierarchy. The Java compiler knows this and doesn’t require a <code class="language-plaintext highlighter-rouge">default</code>. If in
the future we add a new JsonToken type this code would no longer compile.</p>

<h2 id="test-it-out-for-yourself">Test it out for yourself!</h2>

<p>In the prior article we developed a serializer that can serialize a Java record
into a stream of JSON tokens. We now have a printer that can map a JSON token
into JSON text. Let’s put this together in jshell. The example use these files:</p>

<ul>
  <li><a href="https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/TypeToken.java" target="_blank">TypeToken.java</a></li>
  <li><a href="https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonToken.java" target="_blank">JsonToken.java</a></li>
  <li><a href="https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonSerializer.java" target="_blank">JsonSerializer.java</a></li>
  <li><a href="https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/StringUtils.java" target="_blank">StringUtils.java</a> (utility class)</li>
  <li><a href="https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonPrinter.java" target="_blank">JsonPrinter.java</a></li>
</ul>

<p>From a terminal with <a href="https://jdk.java.net/19/" target="_blank">Java 19</a> installed, run the following (note you’ll need the <a href="https://wiki.archiveteam.org/index.php/Wget_installation" target="_blank">wget utility</a>):</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget <span class="nt">-nc</span> https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/TypeToken.java
wget <span class="nt">-nc</span> https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonToken.java
wget <span class="nt">-nc</span> https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonSerializer.java
wget <span class="nt">-nc</span> https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/StringUtils.java
wget <span class="nt">-nc</span> https://raw.githubusercontent.com/starburstdata/developer-blog-assets/main/bleeding-edge-java/code/JsonPrinter.java
jshell <span class="nt">--enable-preview</span> TypeToken.java JsonToken.java JsonSerializer.java StringUtils.java JsonPrinter.java
</code></pre></div></div>

<p>Inside jshell let’s serialize a Java record into JSON text:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">serializer</span> <span class="o">=</span> <span class="nc">JsonSerializer</span><span class="o">.</span><span class="na">instance</span><span class="o">();</span>
<span class="kt">var</span> <span class="n">printer</span> <span class="o">=</span> <span class="nc">JsonPrinter</span><span class="o">.</span><span class="na">instance</span><span class="o">();</span>

<span class="n">record</span> <span class="nf">Person</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{}</span>
<span class="kt">var</span> <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"someone"</span><span class="o">,</span> <span class="mi">28</span><span class="o">);</span>

<span class="nc">String</span> <span class="n">jsonText</span> <span class="o">=</span> <span class="n">serializer</span><span class="o">.</span><span class="na">serialize</span><span class="o">(</span><span class="n">person</span><span class="o">)</span>  <span class="c1">// serialize record to stream of tokens</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">printer:</span><span class="o">:</span><span class="n">print</span><span class="o">)</span>                        <span class="c1">// map each JsonToken to a String (as a CharSequence)</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">());</span>             <span class="c1">// collect into a String</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jsonText</span><span class="o">);</span>
</code></pre></div></div>

<h2 id="summary">Summary</h2>

<p>We can now serialize a Java record into JSON text. Let’s look at parsing into
tokens next in <a href="/blog_bej/2022-09-20-bej4-parsing.html">parsing</a>.</p>

<h2 id="were-hiring">We’re hiring</h2>

<p>Want to be able to use the latest features of Java? <a href="https://www.starburst.io/careers/" target="_blank">We’re
hiring!</a></p>

<hr />

<p>Jordan Zimmerman is a Senior Software Engineer working on <a href="https://www.starburst.io/platform/starburst-galaxy/" target="_blank">Starburst
Galaxy</a>.</p>

          </div>
        </div>
      </div>
    </div>

    <a class="u-url" href="/blog_bej/2022-09-20-bej3-printing.html" hidden></a>
  </article>

</div>



    </div>


<div style="margin-bottom: 50px"></div><footer class="page-footer">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <p style="font-weight:900">Resources</b></p>
        <ul>
          <li class="footer-item"><a href="/videos/index.html">Video library</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-trino-guide/" target="_blank">Free O'Reilly book - Trino: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/community/forum/" target="_blank">Starburst forum</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#download" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">
        <a href="https://www.starburst.io/" target="_blank"><img src="/assets/img/logo/starburst-reverse.png" height="60" alt=" Starburst" style="margin-bottom:20px;"></a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2023<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 center spacer-30">
          <a href="https://twitter.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-twitter"></i></a>
          <a href="https://linkedin.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-linkedin"></i></a>
          <a href="https://www.youtube.com/channel/UCXjkuWSO9CV_cSI3Mvo4a4w" target="_blank" class="footer-icon"><i class="fab fa-youtube"></i></a>
          <a href="https://github.com/starburstdata" target="_blank" class="footer-icon"><i class="fab fa-github"></i></a>
      </div>
    </div>
  </div>
</footer>
  <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/js/popper.min.js"></script>
  <script type="text/javascript" src="/assets/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/assets/js/mdb.min.js"></script>
  <script type="text/javascript" src="/assets/js/custom.js"></script>
  <script type="text/javascript" src="/assets/js/algolia.js"></script>
  <script type="text/javascript" src="/assets/js/search-box.js"></script>
  <script type="text/javascript" src="/assets/js/search-results.js"></script>
</body>
</html>
