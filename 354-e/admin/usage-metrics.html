

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="000A2C">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Usage metrics &#8212; Starburst Enterprise</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/trino.css" />
    <link rel="stylesheet" type="text/css" href="../_static/starburst.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Insights" href="../insights.html" />
    <link rel="prev" title="Cache service CLI" href="cache-service-cli.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#admin/usage-metrics" tabindex="1" class="md-skip"> Skip to content </a>
  
<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://www.starburst.io" title="Starburst Enterprise"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                   alt="Starburst Enterprise logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Starburst Enterprise</span>
          <span class="md-header-nav__topic"> Usage metrics </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Choose another version</button>
    <div class="dropdown-content md-hero">
          <a title="Latest LTS (350-e)" href="/350-e/">Latest LTS (350-e)</a>
      
          <a title="345-e LTS" href="/345-e/">345-e LTS</a>
      
          <a title="338-e LTS" href="/338-e/">338-e LTS</a>
      
          <a title="Latest STS (354-e)" href="/354-e/">Latest STS (354-e)</a>
      
          <a title="348-e STS" href="/348-e/">348-e STS</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Reference documentation</a></li>
            
            <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">User guides</a></li>
            
            <li class="md-tabs__item"><a href="https://starburst.io" class="md-tabs__link">Starburst</a></li>
          <li class="md-tabs__item"><a href="../admin.html" class="md-tabs__link">Administration</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Starburst Enterprise" class="md-nav__button md-logo">
      
        <img src="../_static/Starburst_Logo_NoTag_White.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Starburst Enterprise">Starburst Enterprise</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../aws.html" class="md-nav__link">Amazon Web Services</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../k8s.html" class="md-nav__link">Kubernetes with Helm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="web-interface.html" class="md-nav__link">Web UI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tuning.html" class="md-nav__link">Tuning Starburst Enterprise</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="jmx.html" class="md-nav__link">Monitoring with JMX</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="properties.html" class="md-nav__link">Properties reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spill.html" class="md-nav__link">Spill to disk</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="resource-groups.html" class="md-nav__link">Resource groups</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="session-property-managers.html" class="md-nav__link">Session property managers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dist-sort.html" class="md-nav__link">Distributed sort</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dynamic-filtering.html" class="md-nav__link">Dynamic filtering</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="graceful-shutdown.html" class="md-nav__link">Graceful shutdown</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cache-service.html" class="md-nav__link">Cache service</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cache-service-cli.html" class="md-nav__link">Cache service CLI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Usage metrics </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Usage metrics</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#admin-usage-metrics--page-root" class="md-nav__link">Usage metrics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#logged-metrics" class="md-nav__link">Logged metrics</a>
        </li>
        <li class="md-nav__item"><a href="#accessing-logged-metrics" class="md-nav__link">Accessing logged metrics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#insights-full" class="md-nav__link">Starburst Insights</a>
        </li>
        <li class="md-nav__item"><a href="#usage-metrics-parser" class="md-nav__link">Usage metrics parser</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#persisting-metrics" class="md-nav__link">Persisting metrics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#persisting-metrics-with-insights-full" class="md-nav__link">Persisting metrics with Starburst Insights</a>
        </li>
        <li class="md-nav__item"><a href="#persisting-using-kubernetes-with-helm" class="md-nav__link">Persisting using Kubernetes with Helm</a>
        </li>
        <li class="md-nav__item"><a href="#persisting-with-amazon-cloudwatch" class="md-nav__link">Persisting with Amazon CloudWatch</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../insights.html" class="md-nav__link">Insights</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../appendix.html" class="md-nav__link">Appendix</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Version information</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../versions.html" class="md-nav__link">354-e STS and others</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../404.html" class="md-nav__link">&nbsp;</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#admin-usage-metrics--page-root" class="md-nav__link">Usage metrics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#logged-metrics" class="md-nav__link">Logged metrics</a>
        </li>
        <li class="md-nav__item"><a href="#accessing-logged-metrics" class="md-nav__link">Accessing logged metrics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#insights-full" class="md-nav__link">Starburst Insights</a>
        </li>
        <li class="md-nav__item"><a href="#usage-metrics-parser" class="md-nav__link">Usage metrics parser</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#persisting-metrics" class="md-nav__link">Persisting metrics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#persisting-metrics-with-insights-full" class="md-nav__link">Persisting metrics with Starburst Insights</a>
        </li>
        <li class="md-nav__item"><a href="#persisting-using-kubernetes-with-helm" class="md-nav__link">Persisting using Kubernetes with Helm</a>
        </li>
        <li class="md-nav__item"><a href="#persisting-with-amazon-cloudwatch" class="md-nav__link">Persisting with Amazon CloudWatch</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="admin-usage-metrics--page-root">Usage metrics<a class="headerlink" href="#admin-usage-metrics--page-root" title="Permalink to this headline">#</a></h1>
<p>Starburst Enterprise platform (SEP) collects and logs information about all nodes in your cluster. This
feature is mostly used for Mission Control and other management
solutions. Users can also use the resulting log information for their own
monitoring and operational purposes.</p>

<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">#</a></h2>
<p>Usage metrics collection is configured by a number of properties, that you can
add in <code class="docutils literal notranslate"><span class="pre">etc/config.properties</span></code> to configure details.</p>
<table id="id1">
<caption><span class="caption-text">Usage metrics configuration properties</span><a class="headerlink" href="#id1" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 30%"/>
<col style="width: 55%"/>
<col style="width: 15%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.log.path</span></code></p></td>
<td><p>Relative path of the usage log files in the data directory. For
<code class="docutils literal notranslate"><span class="pre">.tar.</span> <span class="pre">gz</span></code> installations this is inside the installation folder.
For rpm installations the absolute path is
<code class="docutils literal notranslate"><span class="pre">/var/lib/starburst/data/var/log/starburst/usage-metrics.log</span></code>.</p></td>
<td><p>var/log/starburst/usage-metrics.log</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.log.max-size</span></code></p></td>
<td><p>Maximum size of a single usage log file</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span> <span class="pre">MB</span></code>, minimum <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">MB</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.log.max-history</span></code></p></td>
<td><p>Maximum number of usage log files</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.cloud-watch-logs-directory</span></code></p></td>
<td><p>Path to the directory on the node in which log files are stored, for
example, <code class="docutils literal notranslate"><span class="pre">/var/log/starburst/cloudwatch</span></code>. Amazon CloudWatch is
automatically enabled by the SEP CFT and the usage metrics data is
available in <code class="docutils literal notranslate"><span class="pre">usage-metrics-*</span></code> log streams.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.gathering.initial-delay</span></code></p></td>
<td><p>The initial delay to before tracking usage, allowing the cluster to start
up before metrics gathering starts.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">min</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.gathering.interval</span></code></p></td>
<td><p>Length of the interval between usage metric log entry creation. Ideally,
this should be set to a small value, such as the default of 1 min.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">min</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.gatherer-threads</span></code></p></td>
<td><p>Number of threads used to gather and write all usage information.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code>, minimum <code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">usage-metrics.cluster-usage-resource.enabled</span></code></p></td>
<td><p>Expose the REST API end point for usage metrics, aggregated for all nodes
since cluster start, using the end point is a convenient alternative to
the usage metrics parser command line tool, the coordinator exposes the
result at <code class="docutils literal notranslate"><span class="pre">http[s]://&lt;coordinator_address&gt;[:&lt;port&gt;]/v1/cluster/usage</span></code>
with a <code class="docutils literal notranslate"><span class="pre">GET</span></code> request.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
</tbody>
</table>


<h2 id="logged-metrics">Logged metrics<a class="headerlink" href="#logged-metrics" title="Permalink to this headline">#</a></h2>
<p>For each collection interval, a JSON record is created for the entire cluster.It
includes the following information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">startTime</span></code> - the epoch time of the cluster start time for the cumulative
period</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time</span></code> - the timestamp of the record</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cumulativeCpuTime</span></code> - total cumulative CPU time used by the JVM processes
since the last cluster restart</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cumulativeAvailableCpuTime</span></code> - total available CPU time available since the
last cluster restart</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cores</span></code> - total cores within the cluster, as the sum of all cores in the
coordinator and in all registered workers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">activeNodes</span></code> - total number of the registered worker nodes and the
coordinator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signature</span></code> - the signature for the data record</p></li>
</ul>
<p>The following is an excerpt of a JSON log file for a cluster as stored in a log
file at <code class="docutils literal notranslate"><span class="pre">usage-metrics.log.path</span></code>, showing the collected data for six
collection intervals:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{"startTime":1612411299895,"time":"2021-02-05T16:28:37.640Z","cumulativeCpuTime":"1141.53s","cumulativeAvailableCpuTime":"1105507.84s","cores":16,"activeNodes":1,"signature":"13794b5225a5f79a59ad5bd6ecb92b5a93ffc06521a0ac8fc21b50dffb56cfd8"}
{"startTime":1612411299895,"time":"2021-02-05T16:29:37.658Z","cumulativeCpuTime":"1142.41s","cumulativeAvailableCpuTime":"1106468.06s","cores":16,"activeNodes":1,"signature":"d2d1ecce8ac95701bd4b67caf5c69273d17107dbe93f70a2662967060587d63d"}
{"startTime":1612411299895,"time":"2021-02-05T16:30:37.668Z","cumulativeCpuTime":"1143.19s","cumulativeAvailableCpuTime":"1107428.22s","cores":16,"activeNodes":1,"signature":"c5d1f73648e575036cc6ac50cd630c1e2ee355b4d76bdc756b06c26bfdd022f3"}
{"startTime":1612543186896,"time":"2021-02-05T16:40:52.519Z","cumulativeCpuTime":"0.00s","cumulativeAvailableCpuTime":"0.00s","cores":16,"activeNodes":1,"signature":"431c9b3ef438e78ae2d5ac772461701c14470b24e4bf05638c845dce5ed6d376"}
{"startTime":1612543186896,"time":"2021-02-05T16:41:52.532Z","cumulativeCpuTime":"1.97s","cumulativeAvailableCpuTime":"960.23s","cores":16,"activeNodes":1,"signature":"700540d92bc76a2b4eb900650e1129815ce9811e7f15dfed4041119c15c84d91"}
{"startTime":1612543186896,"time":"2021-02-05T16:42:52.544Z","cumulativeCpuTime":"4.10s","cumulativeAvailableCpuTime":"1920.41s","cores":16,"activeNodes":1,"signature":"37762b6799f8afeb4eae285391e76e57110c7ad1220108dda5112b43f13ad353"}
</pre></div>
</div>


<h2 id="accessing-logged-metrics">Accessing logged metrics<a class="headerlink" href="#accessing-logged-metrics" title="Permalink to this headline">#</a></h2>
<p>There are several ways to access usage metrics data, using Starburst visualization
tools, or through more manual methods.</p>

<h3 id="insights-full">Starburst Insights<a class="headerlink" href="#insights-full" title="Permalink to this headline">#</a></h3>
<p>We highly recommend enabling and using the <a class="reference internal" href="../insights/index.html"><span class="doc">Starburst Insights</span></a> interface for the best and most comprehensive user
experience. Insights is accessed in the same way as the Starburst Web UI, and has
built-in aggregations and visualizations. Insights accesses a much richer,
more comprehensive data set that includes event logger data as well as
usage metrics data.</p>


<h3 id="usage-metrics-parser">Usage metrics parser<a class="headerlink" href="#usage-metrics-parser" title="Permalink to this headline">#</a></h3>
<p>The usage metrics parser is a command line application available separately
from Starburst Support that aggregates and returns usage metrics from log files. To
install the tool, place the JAR file in a convenient directory, and add it to
your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>. Then, change the filename and permissions as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ mv starburst-usage-metrics-parser-*-executable.jar usage-metrics-parser
$ chmod a+x usage-metrics-parser
</pre></div>
</div>
<p>Because the usage-metrics-parser is installed separately, it is not available on
the nodes where the logs are saved. After the tool is installed locally, copy
and the log files from <code class="docutils literal notranslate"><span class="pre">usage-metrics.log.path</span></code> to a local empty folder, and
use the parser with appropriate arguments:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ usage-metrics-parser <span class="o">[</span>--from &lt;from&gt;<span class="o">]</span> <span class="o">[(</span>-h <span class="p">|</span> --help<span class="o">)]</span> <span class="o">[</span>--to &lt;to&gt;<span class="o">]</span> <span class="o">[</span>--<span class="o">]</span> <span class="o">[</span>&lt;path&gt;<span class="o">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;from&gt;</span></code> - <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> value for the beginning of the range, inclusive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;to&gt;</span></code> - <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> value for the end of the range, exclusive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;path&gt;</span></code> - the fully-qualified path to the folder containing the log files</p></li>
</ul>
<p>The usage metrics parser can be run directly, or with the <code class="docutils literal notranslate"><span class="pre">java</span></code> command.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># run directly:</span>

$ ./usage-metrics-parser

<span class="c1"># run using the java command:</span>

$ java -jar usage-metrics-parser
</pre></div>
</div>
<p>The begin and end <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> options accept the following formats:</p>
<table id="id2">
<caption><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">DateTime</span></code> formats for date range</span><a class="headerlink" href="#id2" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 30%"/>
<col style="width: 70%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Description</p></th>
<th class="head"><p>Syntax</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>datetime</p></td>
<td><p>time | date-opt-time</p></td>
</tr>
<tr class="row-odd"><td><p>time</p></td>
<td><p>‘T’ time-element [offset]</p></td>
</tr>
<tr class="row-even"><td><p>date-opt-time</p></td>
<td><p>date-element [‘T’ [time-element] [offset]]</p></td>
</tr>
<tr class="row-odd"><td><p>date-element</p></td>
<td><p>std-date-element | ord-date-element | week-date-element</p></td>
</tr>
<tr class="row-even"><td><p>std-date-element</p></td>
<td><p>yyyy [‘-‘ MM [‘-‘ dd]]</p></td>
</tr>
<tr class="row-odd"><td><p>ord-date-element</p></td>
<td><p>yyyy [‘-‘ DDD]</p></td>
</tr>
<tr class="row-even"><td><p>week-date-element</p></td>
<td><p>xxxx ‘-W’ ww [‘-‘ e]</p></td>
</tr>
<tr class="row-odd"><td><p>time-element</p></td>
<td><p>HH [minute-element] | [fraction]</p></td>
</tr>
<tr class="row-even"><td><p>minute-element</p></td>
<td><p>‘:’ mm [second-element] | [fraction]</p></td>
</tr>
<tr class="row-odd"><td><p>second-element</p></td>
<td><p>‘:’ ss [fraction]</p></td>
</tr>
<tr class="row-even"><td><p>fraction</p></td>
<td><p>(‘.’ | ‘,’) digit+</p></td>
</tr>
<tr class="row-odd"><td><p>offset</p></td>
<td><p>‘Z’ | ((‘+’ | ‘-‘) HH [‘:’ mm [‘:’ ss [(‘.’ | ‘,’) SSS]]])</p></td>
</tr>
</tbody>
</table>
<p>If you do not specify either of the <code class="docutils literal notranslate"><span class="pre">--from</span></code> or <code class="docutils literal notranslate"><span class="pre">--to</span></code> options, the metrics are
computed using all available log file entries, as in the following example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ usage-metrics-parser /Users/jsmith/tmp
</pre></div>
</div>
<p>Specifying both <code class="docutils literal notranslate"><span class="pre">--from</span></code> and <code class="docutils literal notranslate"><span class="pre">--to</span></code> <code class="docutils literal notranslate"><span class="pre">DateTimes</span></code> computes metrics inclusive
of the start, and exclusive of the specified end. In the following example, data
for 2021-02-10T16:59:59Z will be included, and 2021-02-10T17:00:00Z is
excluded:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ usage-metrics-parser --from <span class="m">2021</span>-02-05T05:00:00Z --to <span class="m">2021</span>-02-10T17:00:00Z /Users/jsmith/tmp
</pre></div>
</div>
<p>Specifying <code class="docutils literal notranslate"><span class="pre">--from</span></code> with no end time computes metrics from that time up
to the last log entry, inclusive:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ usage-metrics-parser --from <span class="m">2021</span>-02-05T05:00:00Z /Users/jsmith/tmp
</pre></div>
</div>
<p>Specifying <code class="docutils literal notranslate"><span class="pre">--to</span></code> with no start time results in metrics computed from the
earliest available log entry until the specified end time, exclusive:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ usage-metrics-parser --to <span class="m">2021</span>-02-10T17:00:00Z /Users/jsmith/tmp
</pre></div>
</div>
<p>No matter what the specified date range is, <code class="docutils literal notranslate"><span class="pre">usage-metrics-parser</span></code> displays
the results in the following format:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cluster restarts: <span class="m">1</span>, cpu time: <span class="m">265</span>.55s, available cpu time: <span class="m">93130</span>.57s, cpu utilization: <span class="m">0</span>.29%, min cores: <span class="m">16</span>, max cores: <span class="m">16</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cluster</span> <span class="pre">restarts</span></code> - count of unique <code class="docutils literal notranslate"><span class="pre">startTime</span></code> in the date range</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cpu</span> <span class="pre">time</span></code> - aggregated <code class="docutils literal notranslate"><span class="pre">cumulativeCpuTime</span></code> in the specified date range</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">available</span> <span class="pre">cpu</span> <span class="pre">time</span></code> - aggregated <code class="docutils literal notranslate"><span class="pre">cumulativeAvailableCpuTime</span></code> in the specified date range</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cpu</span> <span class="pre">utilization</span></code> - (<code class="docutils literal notranslate"><span class="pre">cpu</span> <span class="pre">time</span></code> / <code class="docutils literal notranslate"><span class="pre">available</span> <span class="pre">cpu</span> <span class="pre">time</span></code>) * 100</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">cores</span></code> - the smallest value of <code class="docutils literal notranslate"><span class="pre">activeNodes</span></code> in the records in specified time period</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">cores</span></code> - the largest value of <code class="docutils literal notranslate"><span class="pre">activeNodes</span></code> in the records in specified time period</p></li>
</ul>



<span id="usage-metrics-persisting"></span><h2 id="persisting-metrics">Persisting metrics<a class="headerlink" href="#persisting-metrics" title="Permalink to this headline">#</a></h2>
<p>Understanding the usage of your cluster requires persisting the usage metrics.
By default the metrics are not persisted.</p>

<h3 id="persisting-metrics-with-insights-full">Persisting metrics with Starburst Insights<a class="headerlink" href="#persisting-metrics-with-insights-full" title="Permalink to this headline">#</a></h3>
<p>The easiest way to persist and view comprehensive metrics is by enabling the
Starburst Insights interface, and ensuring that the
<code class="docutils literal notranslate"><span class="pre">insights.persistence-enabled</span></code> configuration property is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> in
the <a class="reference internal" href="../installation/deployment.html#config-properties"><span class="std std-ref">the config properties file</span></a>. See the
<a class="reference internal" href="../insights/index.html"><span class="doc">Starburst Insights</span></a> section for complete configuration
requirements.</p>


<h3 id="persisting-using-kubernetes-with-helm">Persisting using Kubernetes with Helm<a class="headerlink" href="#persisting-using-kubernetes-with-helm" title="Permalink to this headline">#</a></h3>
<p>While usage metrics are enabled by default when deploying SEP using Kubernetes
with Helm, you must enable a <a class="reference internal" href="../k8s/sep-configuration.html#helm-sep-usage-metrics"><span class="std std-ref">persistent volume</span></a>
to persist your usage metrics.</p>


<h3 id="persisting-with-amazon-cloudwatch">Persisting with Amazon CloudWatch<a class="headerlink" href="#persisting-with-amazon-cloudwatch" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="../aws.html"><span class="doc">CFT setup</span></a> automatically configures persisting the metrics in
Amazon CloudWatch. Users of Amazon EKS can <a class="reference external" href="https://aws.amazon.com/blogs/containers/how-to-capture-application-logs-when-using-amazon-eks-on-aws-fargate/">also use CloudWatch as well</a>.</p>
<p>Logs exported from CloudWatch are decorated and have to be pre-processed to
limit information to the raw format displayed in the preceding section to
process it with the metrics parser.</p>
<p>Log management solutions integrated with other cloud platforms, or available
separately, allow persisting the metrics by capturing the log file or regularly
inspecting the REST endpoint.</p>
<p>You can read more about how Starburst integrates with <a class="reference internal" href="../aws/metrics.html"><span class="doc">CloudWatch metrics</span></a> in our AWS documentation.</p>





          </article>
        </div>
      </div>
    </main>
  </div>
<div class="md-grid md-main__inner" style="height: auto;">
  <div class="md-content">
    <div class="feedback-container md-content__inner md-typeset">
      <div class="feedback-thumbs">
        <p>Is the information on this page helpful?</p>
        <p class="feedback-option" title="yes">Yes</p>
        <p class="feedback-option" title="no">No</p>
      </div>
      <div class="feedback-message">
        <textarea class="feedback-body" placeholder="Additional feedback"></textarea>
        <button type="button" onclick="sendMessage()" class="feedback-button">Submit</button>
        <a onclick="skip()" class="feedback-skip">Skip</a>
      </div>
    </div>
  </div>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '');
</script>
<script>
function feedback() {
  var feedbackValue = "";
  var feedbackThumbs = document.querySelector(".feedback-thumbs");
  var feedbackMessage = document.querySelector(".feedback-message");
  var initialFeedbackMessageContents = feedbackMessage.innerHTML;
  var feedbackAnswer = localStorage.getItem('feedback-answer-' + window.location.pathname);
  var options = Array.from(document.querySelectorAll(".feedback-option"));

  if (feedbackAnswer) {
    Object.keys(options).map(i => options[i].getAttribute('title') == JSON.parse(feedbackAnswer)
      ? options[i].classList.add('active')
      : null
    );
  }

  var clickFunction = function(event){
    var page = window.location.pathname;
    var value = event.currentTarget.getAttribute('title');
    var eventValue = value == 'yes' ? 1 : 0;

    if(!event.currentTarget.classList.contains('active')) {
      localStorage.setItem('feedback-answer-' + page, JSON.stringify(value == 'yes' ? 'yes' : 'no'));
      feedbackValue = value;

      gtag('event', 'feedback', {
        'event_category': 'Docs Feedback',
        'event_label': page,
        'event_value': eventValue,
      });

      Object.keys(options).map(i => options[i].classList.remove('active'));
      event.currentTarget.classList.add('active');

      feedbackThumbs.style.display = "none";
      feedbackMessage.style.display = "flex";
    };
  };

  skip = function() {
    feedbackMessage.style.display = "none";
    feedbackThumbs.style.display = "flex";
    feedbackMessage.innerHTML = initialFeedbackMessageContents;
  }

  sendMessage = function(){
    var feedbackBody = document.querySelector(".feedback-body").value;

    if (feedbackBody) {
      var message = "Page url: " + window.location.pathname + "\n\n"
        + "Feedback positive?: " + feedbackValue + "\n\n" +  "Feedback Message: " + feedbackBody;
      var link = "mailto:docs-feedback@starburst.io?subject=" + encodeURIComponent("Feedback")+"&body="
        + encodeURIComponent(message);

      window.location.href = link;
      feedbackMessage.innerHTML = "<p>Thank you!</p>";

      setTimeout(function(){
          skip();
      }, 5000);
    } else {
      if(!document.querySelector("#feedback-skip")) {
        var alertMessage = document.createElement("p");
        alertMessage.id = "feedback-skip";
        alertMessage.style.color = "red";
        alertMessage.style.position = "absolute";
        alertMessage.style.bottom = "-0.5rem";
        alertMessage.innerHTML = "Please provide a message.";
        feedbackMessage.appendChild(alertMessage);

        setTimeout(function(){
          alertMessage.remove();
        }, 3000);
      }
    }
  }

  Object.keys(options).map(i => options[i].addEventListener('click', clickFunction , false));
}

feedback();
</script>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="cache-service-cli.html" title="Cache service CLI"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Cache service CLI </span>
              </div>
            </a>
          
          
            <a href="../insights.html" title="Insights"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Insights </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
<!-- custom footer should go here in time -->
<div class="page-footer">
  <div class="container md-grid">
    <div class="row">
      <div class="col-md-3">
        <p style="font-weight:900">Resources</p>
        <ul>
          <li class="footer-item"><a href="https://docs.starburst.io/latest/index.html">Starburst Enterprise reference documentation</a></li>
          <li class="footer-item"><a href="/knowledge-base/index.html">Knowledge base</a></li>
          <li class="footer-item"><a href="/glossary.html">Glossary</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/oreilly-presto-guide/" target="_blank">Free O'Reilly book - Presto: The Definitive Guide</a></li>
          <li class="footer-item"><a href="https://trino.io/broadcast/" target="_blank">Trino Community Broadcast</a></li>
          <li class="footer-item"><a href="https://blog.starburstdata.com/" target="_blank">Starburst blog</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <p style="font-weight:900">Contact and more</p>
        <ul>
          <li class="footer-item"><a href="https://www.starburst.io" target="_blank">Starburst</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/info/starburst-intro-and-demo/" target="_blank">Join our weekly demos</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/#!" target="_blank">Start a trial</a></li>
          <li class="footer-item"><a href="/support.html" target="_blank">Get support</a></li>
          <li class="footer-item"><a href="https://www.starburst.io/contact/" target="_blank">Contact us</a></li>
        </ul>
      </div>
      <div class="col-md-3" style="text-align:right;">

        <a href="https://www.starburst.io/" target="_blank">
          
            <img src="../_static/Starburst_Logo_NoTag_White.png" height="26"
                  alt="Starburst Enterprise logo">
        
        </a>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#copyright">Copyright © 2017-2021<br> Starburst Data</a>
        </li>
        <li class="footer-item" style="padding-right:10px;">
          <a href="/disclaimers.html#trademarks">Trademark information</a>
        </li>
      </div>
    </div>
  </div>
</div>
  </body>
</html>